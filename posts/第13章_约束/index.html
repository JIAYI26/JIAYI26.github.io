<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>JIAYI's Blog</title><meta name=keywords content><meta name=description content="第13章_约束 讲师：尚硅谷-宋红康（江湖人称：康师傅）
官网：http://www.atguigu.com
 1. 约束(constraint)概述 1.1 为什么需要约束 数据完整性（Data Integrity）是指数据的精确性（Accuracy）和可靠性（Reliability）。它是防止数据库中存在不符合语义规定的数据和防止因错误信息的输入输出造成无效操作或错误信息而提出的。
为了保证数据的完整性，SQL规范以约束的方式对表数据进行额外的条件限制。从以下四个方面考虑：
 实体完整性（Entity Integrity）：例如，同一个表中，不能存在两条完全相同无法区分的记录 域完整性（Domain Integrity）：例如：年龄范围0-120，性别范围“男/女” 引用完整性（Referential Integrity）：例如：员工所在部门，在部门表中要能找到这个部门 用户自定义完整性（User-defined Integrity）：例如：用户名唯一、密码不能为空等，本部门经理的工资不得高于本部门职工的平均工资的5倍。  1.2 什么是约束 约束是表级的强制规定。
可以在创建表时规定约束（通过 CREATE TABLE 语句），或者在表创建之后通过 ALTER TABLE 语句规定约束。
1.3 约束的分类  **根据约束数据列的限制，**约束可分为：  单列约束：每个约束只约束一列 多列约束：每个约束可约束多列数据   根据约束的作用范围，约束可分为：  列级约束：只能作用在一个列上，跟在列的定义后面 表级约束：可以作用在多个列上，不与列一起，而是单独定义    	位置	支持的约束类型	是否可以起约束名列级约束：	列的后面	语法都支持，但外键没有效果	不可以表级约束：	所有列的下面	默认和非空不支持，其他支持	可以（主键没有效果）  根据约束起的作用，约束可分为：  NOT NULL 非空约束，规定某个字段不能为空 UNIQUE 唯一约束，规定某个字段在整个表中是唯一的 PRIMARY KEY 主键(非空且唯一)约束 FOREIGN KEY 外键约束 CHECK 检查约束 DEFAULT 默认值约束     注意： MySQL不支持check约束，但可以使用check约束，而没有任何效果"><meta name=author content="Me"><link rel=canonical href=https://jiayi26.github.io/posts/%E7%AC%AC13%E7%AB%A0_%E7%BA%A6%E6%9D%9F/><link crossorigin=anonymous href=/assets/css/stylesheet.min.b4e19c453811e60acfec1f00c15ac2be1c53f6ab90187e684358ce7faaf48bab.css integrity="sha256-tOGcRTgR5grP7B8AwVrCvhxT9quQGH5oQ1jOf6r0i6s=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.2840b7fccd34145847db71a290569594bdbdb00047097f75d6495d162f5d7dff.js integrity="sha256-KEC3/M00FFhH23GikFaVlL29sABHCX911kldFi9dff8=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://xx.mzqcgc.cn/FrbOmxJvq96XDbDPXbiBWM0LU9e3><link rel=icon type=image/png sizes=16x16 href=https://xx.mzqcgc.cn/FrbOmxJvq96XDbDPXbiBWM0LU9e3><link rel=icon type=image/png sizes=32x32 href=https://xx.mzqcgc.cn/FrbOmxJvq96XDbDPXbiBWM0LU9e3><link rel=apple-touch-icon href=https://xx.mzqcgc.cn/FrbOmxJvq96XDbDPXbiBWM0LU9e3><link rel=mask-icon href=https://jiayi26.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,o,i,a,t,n,s){e.GoogleAnalyticsObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=o.createElement(i),s=o.getElementsByTagName(i)[0],n.async=1,n.src=a,s.parentNode.insertBefore(n,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content><meta property="og:description" content="第13章_约束 讲师：尚硅谷-宋红康（江湖人称：康师傅）
官网：http://www.atguigu.com
 1. 约束(constraint)概述 1.1 为什么需要约束 数据完整性（Data Integrity）是指数据的精确性（Accuracy）和可靠性（Reliability）。它是防止数据库中存在不符合语义规定的数据和防止因错误信息的输入输出造成无效操作或错误信息而提出的。
为了保证数据的完整性，SQL规范以约束的方式对表数据进行额外的条件限制。从以下四个方面考虑：
 实体完整性（Entity Integrity）：例如，同一个表中，不能存在两条完全相同无法区分的记录 域完整性（Domain Integrity）：例如：年龄范围0-120，性别范围“男/女” 引用完整性（Referential Integrity）：例如：员工所在部门，在部门表中要能找到这个部门 用户自定义完整性（User-defined Integrity）：例如：用户名唯一、密码不能为空等，本部门经理的工资不得高于本部门职工的平均工资的5倍。  1.2 什么是约束 约束是表级的强制规定。
可以在创建表时规定约束（通过 CREATE TABLE 语句），或者在表创建之后通过 ALTER TABLE 语句规定约束。
1.3 约束的分类  **根据约束数据列的限制，**约束可分为：  单列约束：每个约束只约束一列 多列约束：每个约束可约束多列数据   根据约束的作用范围，约束可分为：  列级约束：只能作用在一个列上，跟在列的定义后面 表级约束：可以作用在多个列上，不与列一起，而是单独定义    	位置	支持的约束类型	是否可以起约束名列级约束：	列的后面	语法都支持，但外键没有效果	不可以表级约束：	所有列的下面	默认和非空不支持，其他支持	可以（主键没有效果）  根据约束起的作用，约束可分为：  NOT NULL 非空约束，规定某个字段不能为空 UNIQUE 唯一约束，规定某个字段在整个表中是唯一的 PRIMARY KEY 主键(非空且唯一)约束 FOREIGN KEY 外键约束 CHECK 检查约束 DEFAULT 默认值约束     注意： MySQL不支持check约束，但可以使用check约束，而没有任何效果"><meta property="og:type" content="article"><meta property="og:url" content="https://jiayi26.github.io/posts/%E7%AC%AC13%E7%AB%A0_%E7%BA%A6%E6%9D%9F/"><meta property="article:section" content="posts"><meta property="og:site_name" content="JIAYI's Blog"><meta name=twitter:card content="summary"><meta name=twitter:title content><meta name=twitter:description content="第13章_约束 讲师：尚硅谷-宋红康（江湖人称：康师傅）
官网：http://www.atguigu.com
 1. 约束(constraint)概述 1.1 为什么需要约束 数据完整性（Data Integrity）是指数据的精确性（Accuracy）和可靠性（Reliability）。它是防止数据库中存在不符合语义规定的数据和防止因错误信息的输入输出造成无效操作或错误信息而提出的。
为了保证数据的完整性，SQL规范以约束的方式对表数据进行额外的条件限制。从以下四个方面考虑：
 实体完整性（Entity Integrity）：例如，同一个表中，不能存在两条完全相同无法区分的记录 域完整性（Domain Integrity）：例如：年龄范围0-120，性别范围“男/女” 引用完整性（Referential Integrity）：例如：员工所在部门，在部门表中要能找到这个部门 用户自定义完整性（User-defined Integrity）：例如：用户名唯一、密码不能为空等，本部门经理的工资不得高于本部门职工的平均工资的5倍。  1.2 什么是约束 约束是表级的强制规定。
可以在创建表时规定约束（通过 CREATE TABLE 语句），或者在表创建之后通过 ALTER TABLE 语句规定约束。
1.3 约束的分类  **根据约束数据列的限制，**约束可分为：  单列约束：每个约束只约束一列 多列约束：每个约束可约束多列数据   根据约束的作用范围，约束可分为：  列级约束：只能作用在一个列上，跟在列的定义后面 表级约束：可以作用在多个列上，不与列一起，而是单独定义    	位置	支持的约束类型	是否可以起约束名列级约束：	列的后面	语法都支持，但外键没有效果	不可以表级约束：	所有列的下面	默认和非空不支持，其他支持	可以（主键没有效果）  根据约束起的作用，约束可分为：  NOT NULL 非空约束，规定某个字段不能为空 UNIQUE 唯一约束，规定某个字段在整个表中是唯一的 PRIMARY KEY 主键(非空且唯一)约束 FOREIGN KEY 外键约束 CHECK 检查约束 DEFAULT 默认值约束     注意： MySQL不支持check约束，但可以使用check约束，而没有任何效果"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://jiayi26.github.io/posts/"},{"@type":"ListItem","position":2,"name":"","item":"https://jiayi26.github.io/posts/%E7%AC%AC13%E7%AB%A0_%E7%BA%A6%E6%9D%9F/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"","name":"","description":"第13章_约束 讲师：尚硅谷-宋红康（江湖人称：康师傅）\n官网：http://www.atguigu.com\n 1. 约束(constraint)概述 1.1 为什么需要约束 数据完整性（Data Integrity）是指数据的精确性（Accuracy）和可靠性（Reliability）。它是防止数据库中存在不符合语义规定的数据和防止因错误信息的输入输出造成无效操作或错误信息而提出的。\n为了保证数据的完整性，SQL规范以约束的方式对表数据进行额外的条件限制。从以下四个方面考虑：\n 实体完整性（Entity Integrity）：例如，同一个表中，不能存在两条完全相同无法区分的记录 域完整性（Domain Integrity）：例如：年龄范围0-120，性别范围“男/女” 引用完整性（Referential Integrity）：例如：员工所在部门，在部门表中要能找到这个部门 用户自定义完整性（User-defined Integrity）：例如：用户名唯一、密码不能为空等，本部门经理的工资不得高于本部门职工的平均工资的5倍。  1.2 什么是约束 约束是表级的强制规定。\n可以在创建表时规定约束（通过 CREATE TABLE 语句），或者在表创建之后通过 ALTER TABLE 语句规定约束。\n1.3 约束的分类  **根据约束数据列的限制，**约束可分为：  单列约束：每个约束只约束一列 多列约束：每个约束可约束多列数据   根据约束的作用范围，约束可分为：  列级约束：只能作用在一个列上，跟在列的定义后面 表级约束：可以作用在多个列上，不与列一起，而是单独定义    \t位置\t支持的约束类型\t是否可以起约束名\r列级约束：\t列的后面\t语法都支持，但外键没有效果\t不可以\r表级约束：\t所有列的下面\t默认和非空不支持，其他支持\t可以（主键没有效果）  根据约束起的作用，约束可分为：  NOT NULL 非空约束，规定某个字段不能为空 UNIQUE 唯一约束，规定某个字段在整个表中是唯一的 PRIMARY KEY 主键(非空且唯一)约束 FOREIGN KEY 外键约束 CHECK 检查约束 DEFAULT 默认值约束     注意： MySQL不支持check约束，但可以使用check约束，而没有任何效果","keywords":[],"articleBody":"第13章_约束 讲师：尚硅谷-宋红康（江湖人称：康师傅）\n官网：http://www.atguigu.com\n 1. 约束(constraint)概述 1.1 为什么需要约束 数据完整性（Data Integrity）是指数据的精确性（Accuracy）和可靠性（Reliability）。它是防止数据库中存在不符合语义规定的数据和防止因错误信息的输入输出造成无效操作或错误信息而提出的。\n为了保证数据的完整性，SQL规范以约束的方式对表数据进行额外的条件限制。从以下四个方面考虑：\n 实体完整性（Entity Integrity）：例如，同一个表中，不能存在两条完全相同无法区分的记录 域完整性（Domain Integrity）：例如：年龄范围0-120，性别范围“男/女” 引用完整性（Referential Integrity）：例如：员工所在部门，在部门表中要能找到这个部门 用户自定义完整性（User-defined Integrity）：例如：用户名唯一、密码不能为空等，本部门经理的工资不得高于本部门职工的平均工资的5倍。  1.2 什么是约束 约束是表级的强制规定。\n可以在创建表时规定约束（通过 CREATE TABLE 语句），或者在表创建之后通过 ALTER TABLE 语句规定约束。\n1.3 约束的分类  **根据约束数据列的限制，**约束可分为：  单列约束：每个约束只约束一列 多列约束：每个约束可约束多列数据   根据约束的作用范围，约束可分为：  列级约束：只能作用在一个列上，跟在列的定义后面 表级约束：可以作用在多个列上，不与列一起，而是单独定义    \t位置\t支持的约束类型\t是否可以起约束名\r列级约束：\t列的后面\t语法都支持，但外键没有效果\t不可以\r表级约束：\t所有列的下面\t默认和非空不支持，其他支持\t可以（主键没有效果）  根据约束起的作用，约束可分为：  NOT NULL 非空约束，规定某个字段不能为空 UNIQUE 唯一约束，规定某个字段在整个表中是唯一的 PRIMARY KEY 主键(非空且唯一)约束 FOREIGN KEY 外键约束 CHECK 检查约束 DEFAULT 默认值约束     注意： MySQL不支持check约束，但可以使用check约束，而没有任何效果\n  查看某个表已有的约束  #information_schema数据库名（系统库） #table_constraints表名称（专门存储各个表的约束） SELECT * FROM information_schema.table_constraints WHERE table_name = '表名称'; 2. 非空约束 2.1 作用 限定某个字段/某列的值不允许为空\n2.2 关键字 NOT NULL\n2.3 特点   默认，所有的类型的值都可以是NULL，包括INT、FLOAT等数据类型\n  非空约束只能出现在表对象的列上，只能某个列单独限定非空，不能组合非空\n  一个表可以有很多列都分别限定了非空\n  空字符串’‘不等于NULL，0也不等于NULL\n  2.4 添加非空约束 （1）建表时\nCREATE TABLE 表名称( \t字段名 数据类型,  字段名 数据类型 NOT NULL,  字段名 数据类型 NOT NULL ); 举例：\nCREATE TABLE emp( id INT(10) NOT NULL, NAME VARCHAR(20) NOT NULL, sex CHAR NULL ); CREATE TABLE student( \tsid int,  sname varchar(20) not null,  tel char(11) ,  cardid char(18) not null ); insert into student values(1,'张三','13710011002','110222198912032545'); #成功  insert into student values(2,'李四','13710011002',null);#身份证号为空 ERROR 1048 (23000): Column 'cardid' cannot be null  insert into student values(2,'李四',null,'110222198912032546');#成功，tel允许为空  insert into student values(3,null,null,'110222198912032547');#失败 ERROR 1048 (23000): Column 'sname' cannot be null （2）建表后\nalter table 表名称 modify 字段名 数据类型 not null; 举例：\nALTER TABLE emp MODIFY sex VARCHAR(30) NOT NULL; alter table student modify sname varchar(20) not null; 2.5 删除非空约束 alter table 表名称 modify 字段名 数据类型 NULL;#去掉not null，相当于修改某个非注解字段，该字段允许为空  或  alter table 表名称 modify 字段名 数据类型;#去掉not null，相当于修改某个非注解字段，该字段允许为空 举例：\nALTER TABLE emp MODIFY sex VARCHAR(30) NULL; ALTER TABLE emp MODIFY NAME VARCHAR(15) DEFAULT 'abc' NULL; 3. 唯一性约束 3.1 作用 用来限制某个字段/某列的值不能重复。\n3.2 关键字 UNIQUE\n3.3 特点  同一个表可以有多个唯一约束。 唯一约束可以是某一个列的值唯一，也可以多个列组合的值唯一。 唯一性约束允许列值为空。 在创建唯一约束的时候，如果不给唯一约束命名，就默认和列名相同。 MySQL会给唯一约束的列上默认创建一个唯一索引。  3.4 添加唯一约束 （1）建表时\ncreate table 表名称( \t字段名 数据类型,  字段名 数据类型 unique,  字段名 数据类型 unique key,  字段名 数据类型 ); create table 表名称( \t字段名 数据类型,  字段名 数据类型,  字段名 数据类型,  [constraint 约束名] unique key(字段名) ); 举例：\ncreate table student( \tsid int,  sname varchar(20),  tel char(11) unique,  cardid char(18) unique key ); CREATE TABLE t_course( \tcid INT UNIQUE, \tcname VARCHAR(100) UNIQUE, \tdescription VARCHAR(200) ); CREATE TABLE USER(  id INT NOT NULL,  NAME VARCHAR(25),  PASSWORD VARCHAR(16),  -- 使用表级约束语法  CONSTRAINT uk_name_pwd UNIQUE(NAME,PASSWORD) );  表示用户名和密码组合不能重复\n insert into student values(1,'张三','13710011002','101223199012015623'); insert into student values(2,'李四','13710011003','101223199012015624'); mysql select * from student; +-----+-------+-------------+--------------------+ | sid | sname | tel | cardid | +-----+-------+-------------+--------------------+ | 1 | 张三 | 13710011002 | 101223199012015623 | | 2 | 李四 | 13710011003 | 101223199012015624 | +-----+-------+-------------+--------------------+ 2 rows in set (0.00 sec) insert into student values(3,'王五','13710011004','101223199012015624'); #身份证号重复 ERROR 1062 (23000): Duplicate entry '101223199012015624' for key 'cardid'  insert into student values(3,'王五','13710011003','101223199012015625'); ERROR 1062 (23000): Duplicate entry '13710011003' for key 'tel' （2）建表后指定唯一键约束\n#字段列表中如果是一个字段，表示该列的值唯一。如果是两个或更多个字段，那么复合唯一，即多个字段的组合是唯一的 #方式1： alter table 表名称 add unique key(字段列表); #方式2： alter table 表名称 modify 字段名 字段类型 unique; 举例：\nALTER TABLE USER ADD UNIQUE(NAME,PASSWORD); ALTER TABLE USER ADD CONSTRAINT uk_name_pwd UNIQUE(NAME,PASSWORD); ALTER TABLE USER MODIFY NAME VARCHAR(20) UNIQUE; 举例：\ncreate table student( \tsid int primary key,  sname varchar(20),  tel char(11) ,  cardid char(18) ); alter table student add unique key(tel); alter table student add unique key(cardid); 3.5 关于复合唯一约束 create table 表名称( \t字段名 数据类型,  字段名 数据类型,  字段名 数据类型,  unique key(字段列表) #字段列表中写的是多个字段名，多个字段名用逗号分隔，表示那么是复合唯一，即多个字段的组合是唯一的 ); #学生表 create table student( \tsid int,\t#学号  sname varchar(20),\t#姓名  tel char(11) unique key, #电话  cardid char(18) unique key #身份证号 );  #课程表 create table course( \tcid int, #课程编号  cname varchar(20) #课程名称 );  #选课表 create table student_course(  id int, \tsid int,  cid int,  score int,  unique key(sid,cid) #复合唯一 ); insert into student values(1,'张三','13710011002','101223199012015623');#成功 insert into student values(2,'李四','13710011003','101223199012015624');#成功 insert into course values(1001,'Java'),(1002,'MySQL');#成功 mysql select * from student; +-----+-------+-------------+--------------------+ | sid | sname | tel | cardid | +-----+-------+-------------+--------------------+ | 1 | 张三 | 13710011002 | 101223199012015623 | | 2 | 李四 | 13710011003 | 101223199012015624 | +-----+-------+-------------+--------------------+ 2 rows in set (0.00 sec)  mysql select * from course; +------+-------+ | cid | cname | +------+-------+ | 1001 | Java | | 1002 | MySQL | +------+-------+ 2 rows in set (0.00 sec) insert into student_course values (1, 1, 1001, 89), (2, 1, 1002, 90), (3, 2, 1001, 88), (4, 2, 1002, 56);#成功 mysql select * from student_course; +----+------+------+-------+ | id | sid | cid | score | +----+------+------+-------+ | 1 | 1 | 1001 | 89 | | 2 | 1 | 1002 | 90 | | 3 | 2 | 1001 | 88 | | 4 | 2 | 1002 | 56 | +----+------+------+-------+ 4 rows in set (0.00 sec) insert into student_course values (5, 1, 1001, 88);#失败  #ERROR 1062 (23000): Duplicate entry '1-1001' for key 'sid' 违反sid-cid的复合唯一 3.5 删除唯一约束  添加唯一性约束的列上也会自动创建唯一索引。 删除唯一约束只能通过删除唯一索引的方式删除。 删除时需要指定唯一索引名，唯一索引名就和唯一约束名一样。 如果创建唯一约束时未指定名称，如果是单列，就默认和列名相同；如果是组合列，那么默认和()中排在第一个的列名相同。也可以自定义唯一性约束名。  SELECT * FROM information_schema.table_constraints WHERE table_name = '表名'; #查看都有哪些约束 ALTER TABLE USER DROP INDEX uk_name_pwd;  注意：可以通过 show index from 表名称; 查看表的索引\n 4. PRIMARY KEY 约束 4.1 作用 用来唯一标识表中的一行记录。\n4.2 关键字 primary key\n4.3 特点  主键约束相当于唯一约束+非空约束的组合，主键约束列不允许重复，也不允许出现空值。    一个表最多只能有一个主键约束，建立主键约束可以在列级别创建，也可以在表级别上创建。\n  主键约束对应着表中的一列或者多列（复合主键）\n  如果是多列组合的复合主键约束，那么这些列都不允许为空值，并且组合的值不允许重复。\n  MySQL的主键名总是PRIMARY，就算自己命名了主键约束名也没用。\n  当创建主键约束时，系统默认会在所在的列或列组合上建立对应的主键索引（能够根据主键查询的，就根据主键查询，效率更高）。如果删除主键约束了，主键约束对应的索引就自动删除了。\n  需要注意的一点是，不要修改主键字段的值。因为主键是数据记录的唯一标识，如果修改了主键的值，就有可能会破坏数据的完整性。\n  4.4 添加主键约束 （1）建表时指定主键约束\ncreate table 表名称( \t字段名 数据类型 primary key, #列级模式  字段名 数据类型,  字段名 数据类型 ); create table 表名称( \t字段名 数据类型,  字段名 数据类型,  字段名 数据类型,  [constraint 约束名] primary key(字段名) #表级模式 ); 举例：\ncreate table temp( \tid int primary key,  name varchar(20) ); mysql desc temp; +-------+-------------+------+-----+---------+-------+ | Field | Type | Null | Key | Default | Extra | +-------+-------------+------+-----+---------+-------+ | id | int(11) | NO | PRI | NULL | | | name | varchar(20) | YES | | NULL | | +-------+-------------+------+-----+---------+-------+ 2 rows in set (0.00 sec) insert into temp values(1,'张三');#成功 insert into temp values(2,'李四');#成功 mysql select * from temp; +----+------+ | id | name | +----+------+ | 1 | 张三 | | 2 | 李四 | +----+------+ 2 rows in set (0.00 sec) insert into temp values(1,'张三');#失败 ERROR 1062 (23000): Duplicate（重复） entry（键入，输入） '1' for key 'PRIMARY'   insert into temp values(1,'王五');#失败 ERROR 1062 (23000): Duplicate entry '1' for key 'PRIMARY'  insert into temp values(3,'张三');#成功 mysql select * from temp; +----+------+ | id | name | +----+------+ | 1 | 张三 | | 2 | 李四 | | 3 | 张三 | +----+------+ 3 rows in set (0.00 sec) insert into temp values(4,null);#成功   insert into temp values(null,'李琦');#失败 ERROR 1048 (23000): Column 'id' cannot be null mysql select * from temp; +----+------+ | id | name | +----+------+ | 1 | 张三 | | 2 | 李四 | | 3 | 张三 | | 4 | NULL | +----+------+ 4 rows in set (0.00 sec) #演示一个表建立两个主键约束 create table temp( \tid int primary key,  name varchar(20) primary key ); ERROR 1068 (42000): Multiple（多重的） primary key defined（定义） 再举例：\n 列级约束  CREATE TABLE emp4( id INT PRIMARY KEY AUTO_INCREMENT , NAME VARCHAR(20) );  表级约束  CREATE TABLE emp5( id INT NOT NULL AUTO_INCREMENT, NAME VARCHAR(20), pwd VARCHAR(15), CONSTRAINT emp5_id_pk PRIMARY KEY(id) ); （2）建表后增加主键约束\nALTER TABLE 表名称 ADD PRIMARY KEY(字段列表); #字段列表可以是一个字段，也可以是多个字段，如果是多个字段的话，是复合主键 ALTER TABLE student ADD PRIMARY KEY (sid); ALTER TABLE emp5 ADD PRIMARY KEY(NAME,pwd); 4.5 关于复合主键 create table 表名称( \t字段名 数据类型,  字段名 数据类型,  字段名 数据类型,  primary key(字段名1,字段名2) #表示字段1和字段2的组合是唯一的，也可以有更多个字段 ); #学生表 create table student( \tsid int primary key, #学号  sname varchar(20) #学生姓名 );  #课程表 create table course( \tcid int primary key, #课程编号  cname varchar(20) #课程名称 );  #选课表 create table student_course( \tsid int,  cid int,  score int,  primary key(sid,cid) #复合主键 ); insert into student values(1,'张三'),(2,'李四'); insert into course values(1001,'Java'),(1002,'MySQL'); mysql select * from student; +-----+-------+ | sid | sname | +-----+-------+ | 1 | 张三 | | 2 | 李四 | +-----+-------+ 2 rows in set (0.00 sec)  mysql select * from course; +------+-------+ | cid | cname | +------+-------+ | 1001 | Java | | 1002 | MySQL | +------+-------+ 2 rows in set (0.00 sec) insert into student_course values(1, 1001, 89),(1,1002,90),(2,1001,88),(2,1002,56); mysql select * from student_course; +-----+------+-------+ | sid | cid | score | +-----+------+-------+ | 1 | 1001 | 89 | | 1 | 1002 | 90 | | 2 | 1001 | 88 | | 2 | 1002 | 56 | +-----+------+-------+ 4 rows in set (0.00 sec) insert into student_course values(1, 1001, 100); ERROR 1062 (23000): Duplicate entry '1-1001' for key 'PRIMARY' mysql desc student_course; +-------+---------+------+-----+---------+-------+ | Field | Type | Null | Key | Default | Extra | +-------+---------+------+-----+---------+-------+ | sid | int(11) | NO | PRI | NULL | | | cid | int(11) | NO | PRI | NULL | | | score | int(11) | YES | | NULL | | +-------+---------+------+-----+---------+-------+ 3 rows in set (0.00 sec)  再举例  CREATE TABLE emp6( id INT NOT NULL, NAME VARCHAR(20), pwd VARCHAR(15), CONSTRAINT emp7_pk PRIMARY KEY(NAME,pwd) ); 4.6 删除主键约束 alter table 表名称 drop primary key; 举例：\nALTER TABLE student DROP PRIMARY KEY; ALTER TABLE emp5 DROP PRIMARY KEY;  说明：删除主键约束，不需要指定主键名，因为一个表只有一个主键，删除主键约束后，非空还存在。\n 5. 自增列：AUTO_INCREMENT 5.1 作用 某个字段的值自增\n5.2 关键字 auto_increment\n5.3 特点和要求 （1）一个表最多只能有一个自增长列\n（2）当需要产生唯一标识符或顺序值时，可设置自增长\n（3）自增长列约束的列必须是键列（主键列，唯一键列）\n（4）自增约束的列的数据类型必须是整数类型\n（5）如果自增列指定了 0 和 null，会在当前最大值的基础上自增；如果自增列手动指定了具体值，直接赋值为具体值。\n错误演示：\ncreate table employee( \teid int auto_increment,  ename varchar(20) ); # ERROR 1075 (42000): Incorrect table definition; there can be only one auto column and it must be defined as a key create table employee( \teid int primary key,  ename varchar(20) unique key auto_increment ); # ERROR 1063 (42000): Incorrect column specifier for column 'ename' 因为ename不是整数类型 5.4 如何指定自增约束 （1）建表时\ncreate table 表名称( \t字段名 数据类型 primary key auto_increment,  字段名 数据类型 unique key not null,  字段名 数据类型 unique key,  字段名 数据类型 not null default 默认值, ); create table 表名称( \t字段名 数据类型 default 默认值 ,  字段名 数据类型 unique key auto_increment,  字段名 数据类型 not null default 默认值,,  primary key(字段名) ); create table employee( \teid int primary key auto_increment,  ename varchar(20) ); mysql desc employee; +-------+-------------+------+-----+---------+----------------+ | Field | Type | Null | Key | Default | Extra | +-------+-------------+------+-----+---------+----------------+ | eid | int(11) | NO | PRI | NULL | auto_increment | | ename | varchar(20) | YES | | NULL | | +-------+-------------+------+-----+---------+----------------+ 2 rows in set (0.00 sec) （2）建表后\nalter table 表名称 modify 字段名 数据类型 auto_increment; 例如：\ncreate table employee( \teid int primary key ,  ename varchar(20) ); alter table employee modify eid int auto_increment; mysql desc employee; +-------+-------------+------+-----+---------+----------------+ | Field | Type | Null | Key | Default | Extra | +-------+-------------+------+-----+---------+----------------+ | eid | int(11) | NO | PRI | NULL | auto_increment | | ename | varchar(20) | YES | | NULL | | +-------+-------------+------+-----+---------+----------------+ 2 rows in set (0.00 sec) 5.5 如何删除自增约束 #alter table 表名称 modify 字段名 数据类型 auto_increment;#给这个字段增加自增约束  alter table 表名称 modify 字段名 数据类型; #去掉auto_increment相当于删除 alter table employee modify eid int; mysql desc employee; +-------+-------------+------+-----+---------+-------+ | Field | Type | Null | Key | Default | Extra | +-------+-------------+------+-----+---------+-------+ | eid | int(11) | NO | PRI | NULL | | | ename | varchar(20) | YES | | NULL | | +-------+-------------+------+-----+---------+-------+ 2 rows in set (0.00 sec) 5.6 MySQL 8.0新特性—自增变量的持久化 在MySQL 8.0之前，自增主键AUTO_INCREMENT的值如果大于max(primary key)+1，在MySQL重启后，会重置AUTO_INCREMENT=max(primary key)+1，这种现象在某些情况下会导致业务主键冲突或者其他难以发现的问题。 下面通过案例来对比不同的版本中自增变量是否持久化。 在MySQL 5.7版本中，测试步骤如下： 创建的数据表中包含自增主键的id字段，语句如下：\nCREATE TABLE test1( id INT PRIMARY KEY AUTO_INCREMENT ); 插入4个空值，执行如下：\nINSERT INTO test1 VALUES(0),(0),(0),(0); 查询数据表test1中的数据，结果如下：\nmysql SELECT * FROM test1; +----+ | id | +----+ | 1 | | 2 | | 3 | | 4 | +----+ 4 rows in set (0.00 sec) 删除id为4的记录，语句如下：\nDELETE FROM test1 WHERE id = 4; 再次插入一个空值，语句如下：\nINSERT INTO test1 VALUES(0); 查询此时数据表test1中的数据，结果如下：\nmysql SELECT * FROM test1; +----+ | id | +----+ | 1 | | 2 | | 3 | | 5 | +----+ 4 rows in set (0.00 sec) 从结果可以看出，虽然删除了id为4的记录，但是再次插入空值时，并没有重用被删除的4，而是分配了5。 删除id为5的记录，结果如下：\nDELETE FROM test1 where id=5; 重启数据库，重新插入一个空值。\nINSERT INTO test1 values(0); 再次查询数据表test1中的数据，结果如下：\nmysql SELECT * FROM test1; +----+ | id | +----+ | 1 | | 2 | | 3 | | 4 | +----+ 4 rows in set (0.00 sec) 从结果可以看出，新插入的0值分配的是4，按照重启前的操作逻辑，此处应该分配6。出现上述结果的主要原因是自增主键没有持久化。 在MySQL 5.7系统中，对于自增主键的分配规则，是由InnoDB数据字典内部一个计数器来决定的，而该计数器只在内存中维护，并不会持久化到磁盘中。当数据库重启时，该计数器会被初始化。\n在MySQL 8.0版本中，上述测试步骤最后一步的结果如下：\nmysql SELECT * FROM test1; +----+ | id | +----+ | 1 | | 2 | | 3 | | 6 | +----+ 4 rows in set (0.00 sec) 从结果可以看出，自增变量已经持久化了。\nMySQL 8.0将自增主键的计数器持久化到重做日志中。每次计数器发生改变，都会将其写入重做日志中。如果数据库重启，InnoDB会根据重做日志中的信息来初始化计数器的内存值。\n6. FOREIGN KEY 约束 6.1 作用 限定某个表的某个字段的引用完整性。\n比如：员工表的员工所在部门的选择，必须在部门表能找到对应的部分。\n6.2 关键字 FOREIGN KEY\n6.3 主表和从表/父表和子表 主表（父表）：被引用的表，被参考的表\n从表（子表）：引用别人的表，参考别人的表\n例如：员工表的员工所在部门这个字段的值要参考部门表：部门表是主表，员工表是从表。\n例如：学生表、课程表、选课表：选课表的学生和课程要分别参考学生表和课程表，学生表和课程表是主表，选课表是从表。\n6.4 特点 （1）从表的外键列，必须引用/参考主表的主键或唯一约束的列\n​ 为什么？因为被依赖/被参考的值必须是唯一的\n（2）在创建外键约束时，如果不给外键约束命名，默认名不是列名，而是自动产生一个外键名（例如 student_ibfk_1;），也可以指定外键约束名。\n（3）创建(CREATE)表时就指定外键约束的话，先创建主表，再创建从表\n（4）删表时，先删从表（或先删除外键约束），再删除主表\n（5）当主表的记录被从表参照时，主表的记录将不允许删除，如果要删除数据，需要先删除从表中依赖该记录的数据，然后才可以删除主表的数据\n（6）在“从表”中指定外键约束，并且一个表可以建立多个外键约束\n（7）从表的外键列与主表被参照的列名字可以不相同，但是数据类型必须一样，逻辑意义一致。如果类型不一样，创建子表时，就会出现错误“ERROR 1005 (HY000): Can’t create table’database.tablename’(errno: 150)”。\n​ 例如：都是表示部门编号，都是int类型。\n（8）当创建外键约束时，系统默认会在所在的列上建立对应的普通索引。但是索引名是外键的约束名。（根据外键查询效率很高）\n（9）删除外键约束后，必须手动删除对应的索引\n6.5 添加外键约束 （1）建表时\ncreate table 主表名称( \t字段1 数据类型 primary key,  字段2 数据类型 );  create table 从表名称( \t字段1 数据类型 primary key,  字段2 数据类型,  [CONSTRAINT 外键约束名称] FOREIGN KEY（从表的某个字段) references 主表名(被参考字段) ); #(从表的某个字段)的数据类型必须与主表名(被参考字段)的数据类型一致，逻辑意义也一样 #(从表的某个字段)的字段名可以与主表名(被参考字段)的字段名一样，也可以不一样  -- FOREIGN KEY: 在表级指定子表中的列 -- REFERENCES: 标示在父表中的列 create table dept( #主表 \tdid int primary key,\t#部门编号  dname varchar(50)\t#部门名称 );  create table emp(#从表 \teid int primary key, #员工编号  ename varchar(5), #员工姓名  deptid int,\t#员工所在的部门  foreign key (deptid) references dept(did) #在从表中指定外键约束  #emp表的deptid和和dept表的did的数据类型一致，意义都是表示部门的编号 );  说明： （1）主表dept必须先创建成功，然后才能创建emp表，指定外键成功。 （2）删除表时，先删除从表emp，再删除主表dept （2）建表后\n一般情况下，表与表的关联都是提前设计好了的，因此，会在创建表的时候就把外键约束定义好。不过，如果需要修改表的设计（比如添加新的字段，增加新的关联关系），但没有预先定义外键约束，那么，就要用修改表的方式来补充定义。\n格式：\nALTER TABLE 从表名 ADD [CONSTRAINT 约束名] FOREIGN KEY (从表的字段) REFERENCES 主表名(被引用字段) [on update xx][on delete xx]; 举例：\nALTER TABLE emp1 ADD [CONSTRAINT emp_dept_id_fk] FOREIGN KEY(dept_id) REFERENCES dept(dept_id); 举例：\ncreate table dept( \tdid int primary key,\t#部门编号  dname varchar(50)\t#部门名称 );  create table emp( \teid int primary key, #员工编号  ename varchar(5), #员工姓名  deptid int\t#员工所在的部门 ); #这两个表创建时，没有指定外键的话，那么创建顺序是随意 alter table emp add foreign key (deptid) references dept(did); 6.6 演示问题 （1）失败：不是键列\ncreate table dept( \tdid int ,\t#部门编号  dname varchar(50)\t#部门名称 );  create table emp( \teid int primary key, #员工编号  ename varchar(5), #员工姓名  deptid int,\t#员工所在的部门  foreign key (deptid) references dept(did) ); #ERROR 1215 (HY000): Cannot add foreign key constraint 原因是dept的did不是键列 （2）失败：数据类型不一致\ncreate table dept( \tdid int primary key,\t#部门编号  dname varchar(50)\t#部门名称 );  create table emp( \teid int primary key, #员工编号  ename varchar(5), #员工姓名  deptid char,\t#员工所在的部门  foreign key (deptid) references dept(did) ); #ERROR 1215 (HY000): Cannot add foreign key constraint 原因是从表的deptid字段和主表的did字段的数据类型不一致，并且要它俩的逻辑意义一致 （3）成功，两个表字段名一样\ncreate table dept( \tdid int primary key,\t#部门编号  dname varchar(50)\t#部门名称 );  create table emp( \teid int primary key, #员工编号  ename varchar(5), #员工姓名  did int,\t#员工所在的部门  foreign key (did) references dept(did)  #emp表的deptid和和dept表的did的数据类型一致，意义都是表示部门的编号  #是否重名没问题，因为两个did在不同的表中 ); （4）添加、删除、修改问题\ncreate table dept( \tdid int primary key,\t#部门编号  dname varchar(50)\t#部门名称 );  create table emp( \teid int primary key, #员工编号  ename varchar(5), #员工姓名  deptid int,\t#员工所在的部门  foreign key (deptid) references dept(did)  #emp表的deptid和和dept表的did的数据类型一致，意义都是表示部门的编号 ); insert into dept values(1001,'教学部'); insert into dept values(1003, '财务部');  insert into emp values(1,'张三',1001); #添加从表记录成功，在添加这条记录时，要求部门表有1001部门  insert into emp values(2,'李四',1005);#添加从表记录失败 ERROR 1452 (23000): Cannot add（添加） or update（修改） a child row: a foreign key constraint fails (`atguigudb`.`emp`, CONSTRAINT `emp_ibfk_1` FOREIGN KEY (`deptid`) REFERENCES `dept` (`did`)) 从表emp添加记录失败，因为主表dept没有1005部门 mysql select * from dept; +------+--------+ | did | dname | +------+--------+ | 1001 | 教学部 | | 1003 | 财务部 | +------+--------+ 2 rows in set (0.00 sec)  mysql select * from emp; +-----+-------+--------+ | eid | ename | deptid | +-----+-------+--------+ | 1 | 张三 | 1001 | +-----+-------+--------+ 1 row in set (0.00 sec) update emp set deptid = 1002 where eid = 1;#修改从表失败 ERROR 1452 (23000): Cannot add（添加） or update（修改） a child row（子表的记录）: a foreign key constraint fails（外键约束失败） (`atguigudb`.`emp`, CONSTRAINT `emp_ibfk_1` FOREIGN KEY (`deptid`) REFERENCES `dept` (`did`)) #部门表did字段现在没有1002的值，所以员工表中不能修改员工所在部门deptid为1002  update dept set did = 1002 where did = 1001;#修改主表失败 ERROR 1451 (23000): Cannot delete（删除） or update（修改） a parent row（父表的记录）: a foreign key constraint fails (`atguigudb`.`emp`, CONSTRAINT `emp_ibfk_1` FOREIGN KEY (`deptid`) REFERENCES `dept` (`did`)) #部门表did的1001字段已经被emp引用了，所以部门表的1001字段就不能修改了。  update dept set did = 1002 where did = 1003;#修改主表成功 因为部门表的1003部门没有被emp表引用，所以可以修改 delete from dept where did=1001; #删除主表失败 ERROR 1451 (23000): Cannot delete（删除） or update（修改） a parent row（父表记录）: a foreign key constraint fails (`atguigudb`.`emp`, CONSTRAINT `emp_ibfk_1` FOREIGN KEY (`deptid`) REFERENCES `dept` (`did`)) #因为部门表did的1001字段已经被emp引用了，所以部门表的1001字段对应的记录就不能被删除 总结：约束关系是针对双方的\n  添加了外键约束后，主表的修改和删除数据受约束\n  添加了外键约束后，从表的添加和修改数据受约束\n  在从表上建立外键，要求主表必须存在\n  删除主表时，要求从表从表先删除，或将从表中外键引用该主表的关系先删除\n  6.7 约束等级   Cascade方式：在父表上update/delete记录时，同步update/delete掉子表的匹配记录\n  Set null方式：在父表上update/delete记录时，将子表上匹配记录的列设为null，但是要注意子表的外键列不能为not null\n  No action方式：如果子表中有匹配的记录，则不允许对父表对应候选键进行update/delete操作\n  Restrict方式：同no action， 都是立即检查外键约束\n  Set default方式（在可视化工具SQLyog中可能显示空白）：父表有变更时，子表将外键列设置成一个默认的值，但Innodb不能识别\n  如果没有指定等级，就相当于Restrict方式。\n对于外键约束，最好是采用: ON UPDATE CASCADE ON DELETE RESTRICT 的方式。\n（1）演示1：on update cascade on delete set null\ncreate table dept( \tdid int primary key,\t#部门编号  dname varchar(50)\t#部门名称 );  create table emp( \teid int primary key, #员工编号  ename varchar(5), #员工姓名  deptid int,\t#员工所在的部门  foreign key (deptid) references dept(did) on update cascade on delete set null  #把修改操作设置为级联修改等级，把删除操作设置为set null等级 ); insert into dept values(1001,'教学部'); insert into dept values(1002, '财务部'); insert into dept values(1003, '咨询部');   insert into emp values(1,'张三',1001); #在添加这条记录时，要求部门表有1001部门 insert into emp values(2,'李四',1001); insert into emp values(3,'王五',1002); mysql select * from dept;  mysql select * from emp; #修改主表成功，从表也跟着修改，修改了主表被引用的字段1002为1004，从表的引用字段就跟着修改为1004了 mysql update dept set did = 1004 where did = 1002; Query OK, 1 row affected (0.00 sec) Rows matched: 1 Changed: 1 Warnings: 0  mysql select * from dept; +------+--------+ | did | dname | +------+--------+ | 1001 | 教学部 | | 1003 | 咨询部 | | 1004 | 财务部 | #原来是1002，修改为1004 +------+--------+ 3 rows in set (0.00 sec)  mysql select * from emp; +-----+-------+--------+ | eid | ename | deptid | +-----+-------+--------+ | 1 | 张三 | 1001 | | 2 | 李四 | 1001 | | 3 | 王五 | 1004 | #原来是1002，跟着修改为1004 +-----+-------+--------+ 3 rows in set (0.00 sec) #删除主表的记录成功，从表对应的字段的值被修改为null mysql delete from dept where did = 1001; Query OK, 1 row affected (0.01 sec)  mysql select * from dept; +------+--------+ | did | dname | #记录1001部门被删除了 +------+--------+ | 1003 | 咨询部 | | 1004 | 财务部 | +------+--------+ 2 rows in set (0.00 sec)  mysql select * from emp; +-----+-------+--------+ | eid | ename | deptid | +-----+-------+--------+ | 1 | 张三 | NULL | #原来引用1001部门的员工，deptid字段变为null | 2 | 李四 | NULL | | 3 | 王五 | 1004 | +-----+-------+--------+ 3 rows in set (0.00 sec) （2）演示2：on update set null on delete cascade\ncreate table dept( \tdid int primary key,\t#部门编号  dname varchar(50)\t#部门名称 );  create table emp( \teid int primary key, #员工编号  ename varchar(5), #员工姓名  deptid int,\t#员工所在的部门  foreign key (deptid) references dept(did) on update set null on delete cascade  #把修改操作设置为set null等级，把删除操作设置为级联删除等级 ); insert into dept values(1001,'教学部'); insert into dept values(1002, '财务部'); insert into dept values(1003, '咨询部');  insert into emp values(1,'张三',1001); #在添加这条记录时，要求部门表有1001部门 insert into emp values(2,'李四',1001); insert into emp values(3,'王五',1002); mysql select * from dept; +------+--------+ | did | dname | +------+--------+ | 1001 | 教学部 | | 1002 | 财务部 | | 1003 | 咨询部 | +------+--------+ 3 rows in set (0.00 sec)  mysql select * from emp; +-----+-------+--------+ | eid | ename | deptid | +-----+-------+--------+ | 1 | 张三 | 1001 | | 2 | 李四 | 1001 | | 3 | 王五 | 1002 | +-----+-------+--------+ 3 rows in set (0.00 sec) #修改主表，从表对应的字段设置为null mysql update dept set did = 1004 where did = 1002; Query OK, 1 row affected (0.00 sec) Rows matched: 1 Changed: 1 Warnings: 0  mysql select * from dept; +------+--------+ | did | dname | +------+--------+ | 1001 | 教学部 | | 1003 | 咨询部 | | 1004 | 财务部 | #原来did是1002 +------+--------+ 3 rows in set (0.00 sec)  mysql select * from emp; +-----+-------+--------+ | eid | ename | deptid | +-----+-------+--------+ | 1 | 张三 | 1001 | | 2 | 李四 | 1001 | | 3 | 王五 | NULL | #原来deptid是1002，因为部门表1002被修改了，1002没有对应的了，就设置为null +-----+-------+--------+ 3 rows in set (0.00 sec) #删除主表的记录成功，主表的1001行被删除了，从表相应的记录也被删除了 mysql delete from dept where did=1001; Query OK, 1 row affected (0.00 sec)  mysql select * from dept; +------+--------+ | did | dname | #部门表中1001部门被删除 +------+--------+ | 1003 | 咨询部 | | 1004 | 财务部 | +------+--------+ 2 rows in set (0.00 sec)  mysql select * from emp; +-----+-------+--------+ | eid | ename | deptid |#原来1001部门的员工也被删除了 +-----+-------+--------+ | 3 | 王五 | NULL | +-----+-------+--------+ 1 row in set (0.00 sec) （3）演示：on update cascade on delete cascade\ncreate table dept( \tdid int primary key,\t#部门编号  dname varchar(50)\t#部门名称 );  create table emp( \teid int primary key, #员工编号  ename varchar(5), #员工姓名  deptid int,\t#员工所在的部门  foreign key (deptid) references dept(did) on update cascade on delete cascade  #把修改操作设置为级联修改等级，把删除操作也设置为级联删除等级 ); insert into dept values(1001,'教学部'); insert into dept values(1002, '财务部'); insert into dept values(1003, '咨询部');  insert into emp values(1,'张三',1001); #在添加这条记录时，要求部门表有1001部门 insert into emp values(2,'李四',1001); insert into emp values(3,'王五',1002); mysql select * from dept; +------+--------+ | did | dname | +------+--------+ | 1001 | 教学部 | | 1002 | 财务部 | | 1003 | 咨询部 | +------+--------+ 3 rows in set (0.00 sec)  mysql select * from emp; +-----+-------+--------+ | eid | ename | deptid | +-----+-------+--------+ | 1 | 张三 | 1001 | | 2 | 李四 | 1001 | | 3 | 王五 | 1002 | +-----+-------+--------+ 3 rows in set (0.00 sec) #修改主表，从表对应的字段自动修改 mysql update dept set did = 1004 where did = 1002; Query OK, 1 row affected (0.00 sec) Rows matched: 1 Changed: 1 Warnings: 0  mysql select * from dept; +------+--------+ | did | dname | +------+--------+ | 1001 | 教学部 | | 1003 | 咨询部 | | 1004 | 财务部 | #部门1002修改为1004 +------+--------+ 3 rows in set (0.00 sec)  mysql select * from emp; +-----+-------+--------+ | eid | ename | deptid | +-----+-------+--------+ | 1 | 张三 | 1001 | | 2 | 李四 | 1001 | | 3 | 王五 | 1004 | #级联修改 +-----+-------+--------+ 3 rows in set (0.00 sec) #删除主表的记录成功，主表的1001行被删除了，从表相应的记录也被删除了 mysql delete from dept where did=1001; Query OK, 1 row affected (0.00 sec)  mysql select * from dept; +------+--------+ | did | dname | #1001部门被删除了 +------+--------+ | 1003 | 咨询部 | | 1004 | 财务部 | +------+--------+ 2 rows in set (0.00 sec)  mysql select * from emp; +-----+-------+--------+ | eid | ename | deptid | #1001部门的员工也被删除了 +-----+-------+--------+ | 3 | 王五 | 1004 | +-----+-------+--------+ 1 row in set (0.00 sec) 6.8 删除外键约束 流程如下：\n(1)第一步先查看约束名和删除外键约束 SELECT * FROM information_schema.table_constraints WHERE table_name = '表名称';#查看某个表的约束名  ALTER TABLE 从表名 DROP FOREIGN KEY 外键约束名;  （2）第二步查看索引名和删除索引。（注意，只能手动删除） SHOW INDEX FROM 表名称; #查看某个表的索引名  ALTER TABLE 从表名 DROP INDEX 索引名; 举例：\nmysql SELECT * FROM information_schema.table_constraints WHERE table_name = 'emp';  mysql alter table emp drop foreign key emp_ibfk_1; Query OK, 0 rows affected (0.02 sec) Records: 0 Duplicates: 0 Warnings: 0 mysql show index from emp;  mysql alter table emp drop index deptid; Query OK, 0 rows affected (0.01 sec) Records: 0 Duplicates: 0 Warnings: 0  mysql show index from emp; 6.9 开发场景 问题1：如果两个表之间有关系（一对一、一对多），比如：员工表和部门表（一对多），它们之间是否一定要建外键约束？\n答：不是的\n问题2：建和不建外键约束有什么区别？\n答：建外键约束，你的操作（创建表、删除表、添加、修改、删除）会受到限制，从语法层面受到限制。例如：在员工表中不可能添加一个员工信息，它的部门的值在部门表中找不到。\n不建外键约束，你的操作（创建表、删除表、添加、修改、删除）不受限制，要保证数据的引用完整性，只能依靠程序员的自觉，或者是在Java程序中进行限定。例如：在员工表中，可以添加一个员工的信息，它的部门指定为一个完全不存在的部门。\n问题3：那么建和不建外键约束和查询有没有关系？\n答：没有\n 在 MySQL 里，外键约束是有成本的，需要消耗系统资源。对于大并发的 SQL 操作，有可能会不适合。比如大型网站的中央数据库，可能会因为外键约束的系统开销而变得非常慢。所以， MySQL 允许你不使用系统自带的外键约束，在应用层面完成检查数据一致性的逻辑。也就是说，即使你不用外键约束，也要想办法通过应用层面的附加逻辑，来实现外键约束的功能，确保数据的一致性。\n 6.10 阿里开发规范 【强制】不得使用外键与级联，一切外键概念必须在应用层解决。\n说明：（概念解释）学生表中的 student_id 是主键，那么成绩表中的 student_id 则为外键。如果更新学生表中的 student_id，同时触发成绩表中的 student_id 更新，即为级联更新。外键与级联更新适用于单机低并发，不适合分布式、高并发集群；级联更新是强阻塞，存在数据库更新风暴的风险；外键影响数据库的插入速度。\n7. CHECK 约束 7.1 作用 检查某个字段的值是否符号xx要求，一般指的是值的范围\n2、关键字 CHECK\n3、说明：MySQL 5.7 不支持 MySQL5.7 可以使用check约束，但check约束对数据验证没有任何作用。添加数据时，没有任何错误或警告\n但是MySQL 8.0中可以使用check约束了。\ncreate table employee( \teid int primary key,  ename varchar(5),  gender char check ('男' or '女') ); insert into employee values(1,'张三','妖'); mysql select * from employee; +-----+-------+--------+ | eid | ename | gender | +-----+-------+--------+ | 1 | 张三 | 妖 | +-----+-------+--------+ 1 row in set (0.00 sec)  再举例  CREATE TABLE temp( id INT AUTO_INCREMENT, NAME VARCHAR(20), age INT CHECK(age  20), PRIMARY KEY(id) );  再举例  age tinyint check(age 20) 或 sex char(2) check(sex in(‘男’,’女’))  再举例  CHECK(height=0 AND height3) 8. DEFAULT约束 8.1 作用 给某个字段/某列指定默认值，一旦设置默认值，在插入数据时，如果此字段没有显式赋值，则赋值为默认值。\n8.2 关键字 DEFAULT\n8.3 如何给字段加默认值 （1）建表时\ncreate table 表名称( \t字段名 数据类型 primary key,  字段名 数据类型 unique key not null,  字段名 数据类型 unique key,  字段名 数据类型 not null default 默认值, ); create table 表名称( \t字段名 数据类型 default 默认值 ,  字段名 数据类型 not null default 默认值,  字段名 数据类型 not null default 默认值,  primary key(字段名),  unique key(字段名) );  说明：默认值约束一般不在唯一键和主键列上加 create table employee( \teid int primary key,  ename varchar(20) not null,  gender char default '男',  tel char(11) not null default '' #默认是空字符串 ); mysql desc employee; +--------+-------------+------+-----+---------+-------+ | Field | Type | Null | Key | Default | Extra | +--------+-------------+------+-----+---------+-------+ | eid | int(11) | NO | PRI | NULL | | | ename | varchar(20) | NO | | NULL | | | gender | char(1) | YES | | 男 | | | tel | char(11) | NO | | | | +--------+-------------+------+-----+---------+-------+ 4 rows in set (0.00 sec) insert into employee values(1,'汪飞','男','13700102535'); #成功 mysql select * from employee; +-----+-------+--------+-------------+ | eid | ename | gender | tel | +-----+-------+--------+-------------+ | 1 | 汪飞 | 男 | 13700102535 | +-----+-------+--------+-------------+ 1 row in set (0.00 sec) insert into employee(eid,ename) values(2,'天琪'); #成功 mysql select * from employee; +-----+-------+--------+-------------+ | eid | ename | gender | tel | +-----+-------+--------+-------------+ | 1 | 汪飞 | 男 | 13700102535 | | 2 | 天琪 | 男 | | +-----+-------+--------+-------------+ 2 rows in set (0.00 sec) insert into employee(eid,ename) values(3,'二虎'); #ERROR 1062 (23000): Duplicate entry '' for key 'tel' #如果tel有唯一性约束的话会报错，如果tel没有唯一性约束，可以添加成功 再举例：\nCREATE TABLE myemp( id INT AUTO_INCREMENT PRIMARY KEY, NAME VARCHAR(15), salary DOUBLE(10,2) DEFAULT 2000 ); （2）建表后\nalter table 表名称 modify 字段名 数据类型 default 默认值;  #如果这个字段原来有非空约束，你还保留非空约束，那么在加默认值约束时，还得保留非空约束，否则非空约束就被删除了 #同理，在给某个字段加非空约束也一样，如果这个字段原来有默认值约束，你想保留，也要在modify语句中保留默认值约束，否则就删除了 alter table 表名称 modify 字段名 数据类型 default 默认值 not null; create table employee( \teid int primary key,  ename varchar(20),  gender char,  tel char(11) not null ); mysql desc employee; +--------+-------------+------+-----+---------+-------+ | Field | Type | Null | Key | Default | Extra | +--------+-------------+------+-----+---------+-------+ | eid | int(11) | NO | PRI | NULL | | | ename | varchar(20) | YES | | NULL | | | gender | char(1) | YES | | NULL | | | tel | char(11) | NO | | NULL | | +--------+-------------+------+-----+---------+-------+ 4 rows in set (0.00 sec) alter table employee modify gender char default '男'; #给gender字段增加默认值约束 alter table employee modify tel char(11) default ''; #给tel字段增加默认值约束 mysql desc employee; +--------+-------------+------+-----+---------+-------+ | Field | Type | Null | Key | Default | Extra | +--------+-------------+------+-----+---------+-------+ | eid | int(11) | NO | PRI | NULL | | | ename | varchar(20) | YES | | NULL | | | gender | char(1) | YES | | 男 | | | tel | char(11) | YES | | | | +--------+-------------+------+-----+---------+-------+ 4 rows in set (0.00 sec) alter table employee modify tel char(11) default '' not null;#给tel字段增加默认值约束，并保留非空约束 mysql desc employee; +--------+-------------+------+-----+---------+-------+ | Field | Type | Null | Key | Default | Extra | +--------+-------------+------+-----+---------+-------+ | eid | int(11) | NO | PRI | NULL | | | ename | varchar(20) | YES | | NULL | | | gender | char(1) | YES | | 男 | | | tel | char(11) | NO | | | | +--------+-------------+------+-----+---------+-------+ 4 rows in set (0.00 sec) 8.4 如何删除默认值约束 alter table 表名称 modify 字段名 数据类型 ;#删除默认值约束，也不保留非空约束  alter table 表名称 modify 字段名 数据类型 not null; #删除默认值约束，保留非空约束 alter table employee modify gender char; #删除gender字段默认值约束，如果有非空约束，也一并删除 alter table employee modify tel char(11) not null;#删除tel字段默认值约束，保留非空约束 mysql desc employee; +--------+-------------+------+-----+---------+-------+ | Field | Type | Null | Key | Default | Extra | +--------+-------------+------+-----+---------+-------+ | eid | int(11) | NO | PRI | NULL | | | ename | varchar(20) | YES | | NULL | | | gender | char(1) | YES | | NULL | | | tel | char(11) | NO | | NULL | | +--------+-------------+------+-----+---------+-------+ 4 rows in set (0.00 sec) 9. 面试 面试1、为什么建表时，加 not null default ’’ 或 default 0\n答：不想让表中出现null值。\n面试2、为什么不想要 null 的值\n答:（1）不好比较。null是一种特殊值，比较时只能用专门的is null 和 is not null来比较。碰到运算符，通常返回null。\n​ （2）效率不高。影响提高索引效果。因此，我们往往在建表时 not null default ’’ 或 default 0\n面试3、带AUTO_INCREMENT约束的字段值是从1开始的吗？ 在MySQL中，默认AUTO_INCREMENT的初始值是1，每新增一条记录，字段值自动加1。设置自增属性（AUTO_INCREMENT）的时候，还可以指定第一条插入记录的自增字段的值，这样新插入的记录的自增字段值从初始值开始递增，如在表中插入第一条记录，同时指定id值为5，则以后插入的记录的id值就会从6开始往上增加。添加主键约束时，往往需要设置字段自动增加属性。\n面试4、并不是每个表都可以任意选择存储引擎？ 外键约束（FOREIGN KEY）不能跨引擎使用。\nMySQL支持多种存储引擎，每一个表都可以指定一个不同的存储引擎，需要注意的是：外键约束是用来保证数据的参照完整性的，如果表之间需要关联外键，却指定了不同的存储引擎，那么这些表之间是不能创建外键约束的。所以说，存储引擎的选择也不完全是随意的。\n","wordCount":"4270","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://jiayi26.github.io/posts/%E7%AC%AC13%E7%AB%A0_%E7%BA%A6%E6%9D%9F/"},"publisher":{"@type":"Organization","name":"JIAYI's Blog","logo":{"@type":"ImageObject","url":"https://xx.mzqcgc.cn/FrbOmxJvq96XDbDPXbiBWM0LU9e3"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://jiayi26.github.io/ accesskey=h title="Home (Alt + H)">Home</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://jiayi26.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://jiayi26.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://jiayi26.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://jiayi26.github.io/posts/>Posts</a></div><h1 class=post-title></h1><div class=post-meta>21 min&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/Pass-JIAYI%27s.github.io/post/posts/%e7%ac%ac13%e7%ab%a0_%e7%ba%a6%e6%9d%9f.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><h1 id=第13章_约束>第13章_约束<a hidden class=anchor aria-hidden=true href=#第13章_约束>#</a></h1><p>讲师：尚硅谷-宋红康（江湖人称：康师傅）</p><p>官网：<a href=http://www.atguigu.com/>http://www.atguigu.com</a></p><hr><h2 id=1-约束constraint概述>1. 约束(constraint)概述<a hidden class=anchor aria-hidden=true href=#1-约束constraint概述>#</a></h2><h3 id=11-为什么需要约束>1.1 为什么需要约束<a hidden class=anchor aria-hidden=true href=#11-为什么需要约束>#</a></h3><p>数据完整性（Data Integrity）是指数据的精确性（Accuracy）和可靠性（Reliability）。它是防止数据库中存在不符合语义规定的数据和防止因错误信息的输入输出造成无效操作或错误信息而提出的。</p><p>为了保证数据的完整性，SQL规范以约束的方式对<strong>表数据进行额外的条件限制</strong>。从以下四个方面考虑：</p><ul><li><code>实体完整性（Entity Integrity）</code>：例如，同一个表中，不能存在两条完全相同无法区分的记录</li><li><code>域完整性（Domain Integrity）</code>：例如：年龄范围0-120，性别范围“男/女”</li><li><code>引用完整性（Referential Integrity）</code>：例如：员工所在部门，在部门表中要能找到这个部门</li><li><code>用户自定义完整性（User-defined Integrity）</code>：例如：用户名唯一、密码不能为空等，本部门经理的工资不得高于本部门职工的平均工资的5倍。</li></ul><h3 id=12-什么是约束>1.2 什么是约束<a hidden class=anchor aria-hidden=true href=#12-什么是约束>#</a></h3><p>约束是表级的强制规定。</p><p>可以在<strong>创建表时规定约束（通过 CREATE TABLE 语句）</strong>，或者在<strong>表创建之后通过 ALTER TABLE 语句规定约束</strong>。</p><h3 id=13-约束的分类>1.3 约束的分类<a hidden class=anchor aria-hidden=true href=#13-约束的分类>#</a></h3><ul><li>**根据约束数据列的限制，**约束可分为：<ul><li><strong>单列约束</strong>：每个约束只约束一列</li><li><strong>多列约束</strong>：每个约束可约束多列数据</li></ul></li><li><strong>根据约束的作用范围</strong>，约束可分为：<ul><li><strong>列级约束</strong>：只能作用在一个列上，跟在列的定义后面</li><li><strong>表级约束</strong>：可以作用在多个列上，不与列一起，而是单独定义</li></ul></li></ul><pre tabindex=0><code>			位置			支持的约束类型					是否可以起约束名
列级约束：	列的后面		语法都支持，但外键没有效果		不可以
表级约束：	所有列的下面	   默认和非空不支持，其他支持	   可以（主键没有效果）
</code></pre><ul><li><strong>根据约束起的作用</strong>，约束可分为：<ul><li><strong>NOT NULL</strong> <strong>非空约束，规定某个字段不能为空</strong></li><li><strong>UNIQUE</strong> <strong>唯一约束</strong>，<strong>规定某个字段在整个表中是唯一的</strong></li><li><strong>PRIMARY KEY 主键(非空且唯一)约束</strong></li><li><strong>FOREIGN KEY</strong> <strong>外键约束</strong></li><li><strong>CHECK</strong> <strong>检查约束</strong></li><li><strong>DEFAULT</strong> <strong>默认值约束</strong></li></ul></li></ul><blockquote><p>注意： MySQL不支持check约束，但可以使用check约束，而没有任何效果</p></blockquote><ul><li>查看某个表已有的约束</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e>#information_schema数据库名（系统库）
</span></span></span><span style=display:flex><span><span style=color:#75715e>#table_constraints表名称（专门存储各个表的约束）
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> information_schema.table_constraints 
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> table_name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;表名称&#39;</span>;
</span></span></code></pre></div><h2 id=2-非空约束>2. 非空约束<a hidden class=anchor aria-hidden=true href=#2-非空约束>#</a></h2><h3 id=21-作用>2.1 作用<a hidden class=anchor aria-hidden=true href=#21-作用>#</a></h3><p>限定某个字段/某列的值不允许为空</p><p><img loading=lazy src=../_resources/1555426972098.png alt=1555426972098></p><h3 id=22-关键字>2.2 关键字<a hidden class=anchor aria-hidden=true href=#22-关键字>#</a></h3><p>NOT NULL</p><h3 id=23-特点>2.3 特点<a hidden class=anchor aria-hidden=true href=#23-特点>#</a></h3><ul><li><p>默认，所有的类型的值都可以是NULL，包括INT、FLOAT等数据类型</p></li><li><p>非空约束只能出现在表对象的列上，只能某个列单独限定非空，不能组合非空</p></li><li><p>一个表可以有很多列都分别限定了非空</p></li><li><p>空字符串&rsquo;&lsquo;不等于NULL，0也不等于NULL</p></li></ul><h3 id=24-添加非空约束>2.4 添加非空约束<a hidden class=anchor aria-hidden=true href=#24-添加非空约束>#</a></h3><p>（1）建表时</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#960050;background-color:#1e0010>表名称</span>(
</span></span><span style=display:flex><span>	<span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span>,
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span> <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,  
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span> <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>
</span></span><span style=display:flex><span>);
</span></span></code></pre></div><p>举例：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#a6e22e>emp</span>(
</span></span><span style=display:flex><span>id <span style=color:#66d9ef>INT</span>(<span style=color:#ae81ff>10</span>) <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
</span></span><span style=display:flex><span>NAME <span style=color:#66d9ef>VARCHAR</span>(<span style=color:#ae81ff>20</span>) <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
</span></span><span style=display:flex><span>sex <span style=color:#66d9ef>CHAR</span> <span style=color:#66d9ef>NULL</span>
</span></span><span style=display:flex><span>);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#a6e22e>student</span>(
</span></span><span style=display:flex><span>	sid <span style=color:#66d9ef>int</span>,
</span></span><span style=display:flex><span>    sname <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>20</span>) <span style=color:#66d9ef>not</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>    tel <span style=color:#66d9ef>char</span>(<span style=color:#ae81ff>11</span>) ,
</span></span><span style=display:flex><span>    cardid <span style=color:#66d9ef>char</span>(<span style=color:#ae81ff>18</span>) <span style=color:#66d9ef>not</span> <span style=color:#66d9ef>null</span>
</span></span><span style=display:flex><span>);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> student <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>1</span>,<span style=color:#e6db74>&#39;张三&#39;</span>,<span style=color:#e6db74>&#39;13710011002&#39;</span>,<span style=color:#e6db74>&#39;110222198912032545&#39;</span>); <span style=color:#75715e>#成功
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> student <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>2</span>,<span style=color:#e6db74>&#39;李四&#39;</span>,<span style=color:#e6db74>&#39;13710011002&#39;</span>,<span style=color:#66d9ef>null</span>);<span style=color:#75715e>#身份证号为空
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>ERROR <span style=color:#ae81ff>1048</span> (<span style=color:#ae81ff>23000</span>): <span style=color:#66d9ef>Column</span> <span style=color:#e6db74>&#39;cardid&#39;</span> cannot be <span style=color:#66d9ef>null</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> student <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>2</span>,<span style=color:#e6db74>&#39;李四&#39;</span>,<span style=color:#66d9ef>null</span>,<span style=color:#e6db74>&#39;110222198912032546&#39;</span>);<span style=color:#75715e>#成功，tel允许为空
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> student <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>3</span>,<span style=color:#66d9ef>null</span>,<span style=color:#66d9ef>null</span>,<span style=color:#e6db74>&#39;110222198912032547&#39;</span>);<span style=color:#75715e>#失败
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>ERROR <span style=color:#ae81ff>1048</span> (<span style=color:#ae81ff>23000</span>): <span style=color:#66d9ef>Column</span> <span style=color:#e6db74>&#39;sname&#39;</span> cannot be <span style=color:#66d9ef>null</span>
</span></span></code></pre></div><p>（2）建表后</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>alter</span> <span style=color:#66d9ef>table</span> <span style=color:#960050;background-color:#1e0010>表名称</span> modify <span style=color:#960050;background-color:#1e0010>字段名</span> <span style=color:#960050;background-color:#1e0010>数据类型</span> <span style=color:#66d9ef>not</span> <span style=color:#66d9ef>null</span>;
</span></span></code></pre></div><p>举例：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>ALTER</span> <span style=color:#66d9ef>TABLE</span> emp
</span></span><span style=display:flex><span>MODIFY sex <span style=color:#66d9ef>VARCHAR</span>(<span style=color:#ae81ff>30</span>) <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>alter</span> <span style=color:#66d9ef>table</span> student modify sname <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>20</span>) <span style=color:#66d9ef>not</span> <span style=color:#66d9ef>null</span>;
</span></span></code></pre></div><h3 id=25-删除非空约束>2.5 删除非空约束<a hidden class=anchor aria-hidden=true href=#25-删除非空约束>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>alter</span> <span style=color:#66d9ef>table</span> <span style=color:#960050;background-color:#1e0010>表名称</span> modify <span style=color:#960050;background-color:#1e0010>字段名</span> <span style=color:#960050;background-color:#1e0010>数据类型</span> <span style=color:#66d9ef>NULL</span>;<span style=color:#75715e>#去掉not null，相当于修改某个非注解字段，该字段允许为空
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>或</span> 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>alter</span> <span style=color:#66d9ef>table</span> <span style=color:#960050;background-color:#1e0010>表名称</span> modify <span style=color:#960050;background-color:#1e0010>字段名</span> <span style=color:#960050;background-color:#1e0010>数据类型</span>;<span style=color:#75715e>#去掉not null，相当于修改某个非注解字段，该字段允许为空
</span></span></span></code></pre></div><p>举例：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>ALTER</span> <span style=color:#66d9ef>TABLE</span> emp
</span></span><span style=display:flex><span>MODIFY sex <span style=color:#66d9ef>VARCHAR</span>(<span style=color:#ae81ff>30</span>) <span style=color:#66d9ef>NULL</span>;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>ALTER</span> <span style=color:#66d9ef>TABLE</span> emp
</span></span><span style=display:flex><span>MODIFY NAME <span style=color:#66d9ef>VARCHAR</span>(<span style=color:#ae81ff>15</span>) <span style=color:#66d9ef>DEFAULT</span> <span style=color:#e6db74>&#39;abc&#39;</span> <span style=color:#66d9ef>NULL</span>;
</span></span></code></pre></div><h2 id=3-唯一性约束>3. 唯一性约束<a hidden class=anchor aria-hidden=true href=#3-唯一性约束>#</a></h2><h3 id=31-作用>3.1 作用<a hidden class=anchor aria-hidden=true href=#31-作用>#</a></h3><p>用来限制某个字段/某列的值不能重复。</p><p><img loading=lazy src=../_resources/1555427198811.png alt=1555427198811></p><h3 id=32-关键字>3.2 关键字<a hidden class=anchor aria-hidden=true href=#32-关键字>#</a></h3><p>UNIQUE</p><h3 id=33-特点>3.3 特点<a hidden class=anchor aria-hidden=true href=#33-特点>#</a></h3><ul><li>同一个表可以有多个唯一约束。</li><li>唯一约束可以是某一个列的值唯一，也可以多个列组合的值唯一。</li><li>唯一性约束允许列值为空。</li><li>在创建唯一约束的时候，如果不给唯一约束命名，就默认和列名相同。</li><li><strong>MySQL会给唯一约束的列上默认创建一个唯一索引。</strong></li></ul><h3 id=34-添加唯一约束>3.4 添加唯一约束<a hidden class=anchor aria-hidden=true href=#34-添加唯一约束>#</a></h3><p>（1）建表时</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#960050;background-color:#1e0010>表名称</span>(
</span></span><span style=display:flex><span>	<span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span>,
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span>  <span style=color:#66d9ef>unique</span>,  
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span>  <span style=color:#66d9ef>unique</span> <span style=color:#66d9ef>key</span>,
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span>
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#960050;background-color:#1e0010>表名称</span>(
</span></span><span style=display:flex><span>	<span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span>,
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span>,  
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span>,
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>constraint</span> <span style=color:#960050;background-color:#1e0010>约束名</span>] <span style=color:#66d9ef>unique</span> <span style=color:#66d9ef>key</span>(<span style=color:#960050;background-color:#1e0010>字段名</span>)
</span></span><span style=display:flex><span>);
</span></span></code></pre></div><p>举例：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>student</span>(
</span></span><span style=display:flex><span>	sid <span style=color:#66d9ef>int</span>,
</span></span><span style=display:flex><span>    sname <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>20</span>),
</span></span><span style=display:flex><span>    tel <span style=color:#66d9ef>char</span>(<span style=color:#ae81ff>11</span>) <span style=color:#66d9ef>unique</span>,
</span></span><span style=display:flex><span>    cardid <span style=color:#66d9ef>char</span>(<span style=color:#ae81ff>18</span>) <span style=color:#66d9ef>unique</span> <span style=color:#66d9ef>key</span>
</span></span><span style=display:flex><span>);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#a6e22e>t_course</span>(
</span></span><span style=display:flex><span>	cid <span style=color:#66d9ef>INT</span> <span style=color:#66d9ef>UNIQUE</span>,
</span></span><span style=display:flex><span>	cname <span style=color:#66d9ef>VARCHAR</span>(<span style=color:#ae81ff>100</span>) <span style=color:#66d9ef>UNIQUE</span>,
</span></span><span style=display:flex><span>	description <span style=color:#66d9ef>VARCHAR</span>(<span style=color:#ae81ff>200</span>)
</span></span><span style=display:flex><span>);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#66d9ef>USER</span>(
</span></span><span style=display:flex><span> id <span style=color:#66d9ef>INT</span> <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
</span></span><span style=display:flex><span> NAME <span style=color:#66d9ef>VARCHAR</span>(<span style=color:#ae81ff>25</span>),
</span></span><span style=display:flex><span> PASSWORD <span style=color:#66d9ef>VARCHAR</span>(<span style=color:#ae81ff>16</span>),
</span></span><span style=display:flex><span> <span style=color:#75715e>-- 使用表级约束语法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> <span style=color:#66d9ef>CONSTRAINT</span> uk_name_pwd <span style=color:#66d9ef>UNIQUE</span>(NAME,PASSWORD)
</span></span><span style=display:flex><span>);
</span></span></code></pre></div><blockquote><p>表示用户名和密码组合不能重复</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> student <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>1</span>,<span style=color:#e6db74>&#39;张三&#39;</span>,<span style=color:#e6db74>&#39;13710011002&#39;</span>,<span style=color:#e6db74>&#39;101223199012015623&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> student <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>2</span>,<span style=color:#e6db74>&#39;李四&#39;</span>,<span style=color:#e6db74>&#39;13710011003&#39;</span>,<span style=color:#e6db74>&#39;101223199012015624&#39;</span>);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> student;
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+-------------+--------------------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> sid <span style=color:#f92672>|</span> sname <span style=color:#f92672>|</span> tel         <span style=color:#f92672>|</span> cardid             <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+-------------+--------------------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>1</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>张三</span>  <span style=color:#f92672>|</span> <span style=color:#ae81ff>13710011002</span> <span style=color:#f92672>|</span> <span style=color:#ae81ff>101223199012015623</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>2</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>李四</span>  <span style=color:#f92672>|</span> <span style=color:#ae81ff>13710011003</span> <span style=color:#f92672>|</span> <span style=color:#ae81ff>101223199012015624</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+-------------+--------------------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> student <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>3</span>,<span style=color:#e6db74>&#39;王五&#39;</span>,<span style=color:#e6db74>&#39;13710011004&#39;</span>,<span style=color:#e6db74>&#39;101223199012015624&#39;</span>); <span style=color:#75715e>#身份证号重复
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>ERROR <span style=color:#ae81ff>1062</span> (<span style=color:#ae81ff>23000</span>): Duplicate entry <span style=color:#e6db74>&#39;101223199012015624&#39;</span> <span style=color:#66d9ef>for</span> <span style=color:#66d9ef>key</span> <span style=color:#e6db74>&#39;cardid&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> student <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>3</span>,<span style=color:#e6db74>&#39;王五&#39;</span>,<span style=color:#e6db74>&#39;13710011003&#39;</span>,<span style=color:#e6db74>&#39;101223199012015625&#39;</span>); 
</span></span><span style=display:flex><span>ERROR <span style=color:#ae81ff>1062</span> (<span style=color:#ae81ff>23000</span>): Duplicate entry <span style=color:#e6db74>&#39;13710011003&#39;</span> <span style=color:#66d9ef>for</span> <span style=color:#66d9ef>key</span> <span style=color:#e6db74>&#39;tel&#39;</span>
</span></span></code></pre></div><p>（2）建表后指定唯一键约束</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e>#字段列表中如果是一个字段，表示该列的值唯一。如果是两个或更多个字段，那么复合唯一，即多个字段的组合是唯一的
</span></span></span><span style=display:flex><span><span style=color:#75715e>#方式1：
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>alter</span> <span style=color:#66d9ef>table</span> <span style=color:#960050;background-color:#1e0010>表名称</span> <span style=color:#66d9ef>add</span> <span style=color:#66d9ef>unique</span> <span style=color:#66d9ef>key</span>(<span style=color:#960050;background-color:#1e0010>字段列表</span>); 
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e>#方式2：
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>alter</span> <span style=color:#66d9ef>table</span> <span style=color:#960050;background-color:#1e0010>表名称</span> modify <span style=color:#960050;background-color:#1e0010>字段名</span> <span style=color:#960050;background-color:#1e0010>字段类型</span> <span style=color:#66d9ef>unique</span>;
</span></span></code></pre></div><p>举例：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>ALTER</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#66d9ef>USER</span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>ADD</span> <span style=color:#66d9ef>UNIQUE</span>(NAME,PASSWORD);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>ALTER</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#66d9ef>USER</span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>ADD</span> <span style=color:#66d9ef>CONSTRAINT</span> uk_name_pwd <span style=color:#66d9ef>UNIQUE</span>(NAME,PASSWORD);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>ALTER</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#66d9ef>USER</span> 
</span></span><span style=display:flex><span>MODIFY NAME <span style=color:#66d9ef>VARCHAR</span>(<span style=color:#ae81ff>20</span>) <span style=color:#66d9ef>UNIQUE</span>;
</span></span></code></pre></div><p>举例：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>student</span>(
</span></span><span style=display:flex><span>	sid <span style=color:#66d9ef>int</span> <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>,
</span></span><span style=display:flex><span>    sname <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>20</span>),
</span></span><span style=display:flex><span>    tel <span style=color:#66d9ef>char</span>(<span style=color:#ae81ff>11</span>) ,
</span></span><span style=display:flex><span>    cardid <span style=color:#66d9ef>char</span>(<span style=color:#ae81ff>18</span>) 
</span></span><span style=display:flex><span>);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>alter</span> <span style=color:#66d9ef>table</span> student <span style=color:#66d9ef>add</span> <span style=color:#66d9ef>unique</span> <span style=color:#66d9ef>key</span>(tel);
</span></span><span style=display:flex><span><span style=color:#66d9ef>alter</span> <span style=color:#66d9ef>table</span> student <span style=color:#66d9ef>add</span> <span style=color:#66d9ef>unique</span> <span style=color:#66d9ef>key</span>(cardid);
</span></span></code></pre></div><h3 id=35-关于复合唯一约束>3.5 关于复合唯一约束<a hidden class=anchor aria-hidden=true href=#35-关于复合唯一约束>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#960050;background-color:#1e0010>表名称</span>(
</span></span><span style=display:flex><span>	<span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span>,
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span>,  
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span>,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>unique</span> <span style=color:#66d9ef>key</span>(<span style=color:#960050;background-color:#1e0010>字段列表</span>) <span style=color:#75715e>#字段列表中写的是多个字段名，多个字段名用逗号分隔，表示那么是复合唯一，即多个字段的组合是唯一的
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e>#学生表
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>student</span>(
</span></span><span style=display:flex><span>	sid <span style=color:#66d9ef>int</span>,	<span style=color:#75715e>#学号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    sname <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>20</span>),			<span style=color:#75715e>#姓名
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    tel <span style=color:#66d9ef>char</span>(<span style=color:#ae81ff>11</span>) <span style=color:#66d9ef>unique</span> <span style=color:#66d9ef>key</span>,  <span style=color:#75715e>#电话
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    cardid <span style=color:#66d9ef>char</span>(<span style=color:#ae81ff>18</span>) <span style=color:#66d9ef>unique</span> <span style=color:#66d9ef>key</span> <span style=color:#75715e>#身份证号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#课程表
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>course</span>(
</span></span><span style=display:flex><span>	cid <span style=color:#66d9ef>int</span>,  <span style=color:#75715e>#课程编号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    cname <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>20</span>)     <span style=color:#75715e>#课程名称
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#选课表
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>student_course</span>(
</span></span><span style=display:flex><span>    id <span style=color:#66d9ef>int</span>,
</span></span><span style=display:flex><span>	sid <span style=color:#66d9ef>int</span>,
</span></span><span style=display:flex><span>    cid <span style=color:#66d9ef>int</span>,
</span></span><span style=display:flex><span>    score <span style=color:#66d9ef>int</span>,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>unique</span> <span style=color:#66d9ef>key</span>(sid,cid)  <span style=color:#75715e>#复合唯一
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> student <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>1</span>,<span style=color:#e6db74>&#39;张三&#39;</span>,<span style=color:#e6db74>&#39;13710011002&#39;</span>,<span style=color:#e6db74>&#39;101223199012015623&#39;</span>);<span style=color:#75715e>#成功
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> student <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>2</span>,<span style=color:#e6db74>&#39;李四&#39;</span>,<span style=color:#e6db74>&#39;13710011003&#39;</span>,<span style=color:#e6db74>&#39;101223199012015624&#39;</span>);<span style=color:#75715e>#成功
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> course <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>1001</span>,<span style=color:#e6db74>&#39;Java&#39;</span>),(<span style=color:#ae81ff>1002</span>,<span style=color:#e6db74>&#39;MySQL&#39;</span>);<span style=color:#75715e>#成功
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> student;
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+-------------+--------------------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> sid <span style=color:#f92672>|</span> sname <span style=color:#f92672>|</span> tel         <span style=color:#f92672>|</span> cardid             <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+-------------+--------------------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>1</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>张三</span>  <span style=color:#f92672>|</span> <span style=color:#ae81ff>13710011002</span> <span style=color:#f92672>|</span> <span style=color:#ae81ff>101223199012015623</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>2</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>李四</span>  <span style=color:#f92672>|</span> <span style=color:#ae81ff>13710011003</span> <span style=color:#f92672>|</span> <span style=color:#ae81ff>101223199012015624</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+-------------+--------------------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> course;
</span></span><span style=display:flex><span><span style=color:#f92672>+------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> cid  <span style=color:#f92672>|</span> cname <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#ae81ff>1001</span> <span style=color:#f92672>|</span> Java  <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#ae81ff>1002</span> <span style=color:#f92672>|</span> MySQL <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> student_course <span style=color:#66d9ef>values</span>
</span></span><span style=display:flex><span>(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1001</span>, <span style=color:#ae81ff>89</span>),
</span></span><span style=display:flex><span>(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1002</span>, <span style=color:#ae81ff>90</span>),
</span></span><span style=display:flex><span>(<span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1001</span>, <span style=color:#ae81ff>88</span>),
</span></span><span style=display:flex><span>(<span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1002</span>, <span style=color:#ae81ff>56</span>);<span style=color:#75715e>#成功
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> student_course;
</span></span><span style=display:flex><span><span style=color:#f92672>+----+------+------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> id <span style=color:#f92672>|</span> sid  <span style=color:#f92672>|</span> cid  <span style=color:#f92672>|</span> score <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+----+------+------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#ae81ff>1</span> <span style=color:#f92672>|</span>    <span style=color:#ae81ff>1</span> <span style=color:#f92672>|</span> <span style=color:#ae81ff>1001</span> <span style=color:#f92672>|</span>    <span style=color:#ae81ff>89</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#ae81ff>2</span> <span style=color:#f92672>|</span>    <span style=color:#ae81ff>1</span> <span style=color:#f92672>|</span> <span style=color:#ae81ff>1002</span> <span style=color:#f92672>|</span>    <span style=color:#ae81ff>90</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#ae81ff>3</span> <span style=color:#f92672>|</span>    <span style=color:#ae81ff>2</span> <span style=color:#f92672>|</span> <span style=color:#ae81ff>1001</span> <span style=color:#f92672>|</span>    <span style=color:#ae81ff>88</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#ae81ff>4</span> <span style=color:#f92672>|</span>    <span style=color:#ae81ff>2</span> <span style=color:#f92672>|</span> <span style=color:#ae81ff>1002</span> <span style=color:#f92672>|</span>    <span style=color:#ae81ff>56</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+----+------+------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>4</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> student_course <span style=color:#66d9ef>values</span> (<span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1001</span>, <span style=color:#ae81ff>88</span>);<span style=color:#75715e>#失败
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>#ERROR 1062 (23000): Duplicate entry &#39;1-1001&#39; for key &#39;sid&#39;   违反sid-cid的复合唯一
</span></span></span></code></pre></div><h3 id=35-删除唯一约束>3.5 删除唯一约束<a hidden class=anchor aria-hidden=true href=#35-删除唯一约束>#</a></h3><ul><li>添加唯一性约束的列上也会自动创建唯一索引。</li><li>删除唯一约束只能通过删除唯一索引的方式删除。</li><li>删除时需要指定唯一索引名，唯一索引名就和唯一约束名一样。</li><li>如果创建唯一约束时未指定名称，如果是单列，就默认和列名相同；如果是组合列，那么默认和()中排在第一个的列名相同。也可以自定义唯一性约束名。</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> information_schema.table_constraints <span style=color:#66d9ef>WHERE</span> table_name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;表名&#39;</span>; <span style=color:#75715e>#查看都有哪些约束
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>ALTER</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#66d9ef>USER</span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>DROP</span> <span style=color:#66d9ef>INDEX</span> uk_name_pwd;
</span></span></code></pre></div><blockquote><p>注意：可以通过 <code>show index from 表名称; </code>查看表的索引</p></blockquote><h2 id=4-primary-key-约束>4. PRIMARY KEY 约束<a hidden class=anchor aria-hidden=true href=#4-primary-key-约束>#</a></h2><h3 id=41-作用>4.1 作用<a hidden class=anchor aria-hidden=true href=#41-作用>#</a></h3><p>用来唯一标识表中的一行记录。</p><h3 id=42-关键字>4.2 关键字<a hidden class=anchor aria-hidden=true href=#42-关键字>#</a></h3><p>primary key</p><h3 id=43-特点>4.3 特点<a hidden class=anchor aria-hidden=true href=#43-特点>#</a></h3><ul><li>主键约束相当于<strong>唯一约束+非空约束的组合</strong>，主键约束列不允许重复，也不允许出现空值。</li></ul><p><img loading=lazy src=../_resources/1555427492244.png alt=1555427492244></p><ul><li><p>一个表最多只能有一个主键约束，建立主键约束可以在列级别创建，也可以在表级别上创建。</p></li><li><p>主键约束对应着表中的一列或者多列（复合主键）</p></li><li><p>如果是多列组合的复合主键约束，那么这些列都不允许为空值，并且组合的值不允许重复。</p></li><li><p><strong>MySQL的主键名总是PRIMARY</strong>，就算自己命名了主键约束名也没用。</p></li><li><p>当创建主键约束时，系统默认会在所在的列或列组合上建立对应的<strong>主键索引</strong>（能够根据主键查询的，就根据主键查询，效率更高）。如果删除主键约束了，主键约束对应的索引就自动删除了。</p></li><li><p>需要注意的一点是，不要修改主键字段的值。因为主键是数据记录的唯一标识，如果修改了主键的值，就有可能会破坏数据的完整性。</p></li></ul><h3 id=44-添加主键约束>4.4 添加主键约束<a hidden class=anchor aria-hidden=true href=#44-添加主键约束>#</a></h3><p>（1）建表时指定主键约束</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#960050;background-color:#1e0010>表名称</span>(
</span></span><span style=display:flex><span>	<span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span>  <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>, <span style=color:#75715e>#列级模式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span>,  
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span>  
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#960050;background-color:#1e0010>表名称</span>(
</span></span><span style=display:flex><span>	<span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span>,
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span>,  
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span>,
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>constraint</span> <span style=color:#960050;background-color:#1e0010>约束名</span>] <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>(<span style=color:#960050;background-color:#1e0010>字段名</span>) <span style=color:#75715e>#表级模式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>);
</span></span></code></pre></div><p>举例：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>temp</span>(
</span></span><span style=display:flex><span>	id <span style=color:#66d9ef>int</span> <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>,
</span></span><span style=display:flex><span>    name <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>20</span>)
</span></span><span style=display:flex><span>);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>desc</span> temp;
</span></span><span style=display:flex><span><span style=color:#f92672>+-------+-------------+------+-----+---------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> Field <span style=color:#f92672>|</span> Type        <span style=color:#f92672>|</span> <span style=color:#66d9ef>Null</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>Key</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>Default</span> <span style=color:#f92672>|</span> Extra <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-------+-------------+------+-----+---------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> id    <span style=color:#f92672>|</span> <span style=color:#66d9ef>int</span>(<span style=color:#ae81ff>11</span>)     <span style=color:#f92672>|</span> NO   <span style=color:#f92672>|</span> PRI <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>    <span style=color:#f92672>|</span>       <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> name  <span style=color:#f92672>|</span> <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>20</span>) <span style=color:#f92672>|</span> YES  <span style=color:#f92672>|</span>     <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>    <span style=color:#f92672>|</span>       <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-------+-------------+------+-----+---------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> temp <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>1</span>,<span style=color:#e6db74>&#39;张三&#39;</span>);<span style=color:#75715e>#成功
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> temp <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>2</span>,<span style=color:#e6db74>&#39;李四&#39;</span>);<span style=color:#75715e>#成功
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> temp;
</span></span><span style=display:flex><span><span style=color:#f92672>+----+------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> id <span style=color:#f92672>|</span> name <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+----+------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#ae81ff>1</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>张三</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#ae81ff>2</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>李四</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+----+------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> temp <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>1</span>,<span style=color:#e6db74>&#39;张三&#39;</span>);<span style=color:#75715e>#失败
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>ERROR <span style=color:#ae81ff>1062</span> (<span style=color:#ae81ff>23000</span>): Duplicate<span style=color:#960050;background-color:#1e0010>（重复）</span> entry<span style=color:#960050;background-color:#1e0010>（键入，输入）</span> <span style=color:#e6db74>&#39;1&#39;</span> <span style=color:#66d9ef>for</span> <span style=color:#66d9ef>key</span> <span style=color:#e6db74>&#39;PRIMARY&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> temp <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>1</span>,<span style=color:#e6db74>&#39;王五&#39;</span>);<span style=color:#75715e>#失败
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>ERROR <span style=color:#ae81ff>1062</span> (<span style=color:#ae81ff>23000</span>): Duplicate entry <span style=color:#e6db74>&#39;1&#39;</span> <span style=color:#66d9ef>for</span> <span style=color:#66d9ef>key</span> <span style=color:#e6db74>&#39;PRIMARY&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> temp <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>3</span>,<span style=color:#e6db74>&#39;张三&#39;</span>);<span style=color:#75715e>#成功
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> temp;
</span></span><span style=display:flex><span><span style=color:#f92672>+----+------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> id <span style=color:#f92672>|</span> name <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+----+------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#ae81ff>1</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>张三</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#ae81ff>2</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>李四</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#ae81ff>3</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>张三</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+----+------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> temp <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>4</span>,<span style=color:#66d9ef>null</span>);<span style=color:#75715e>#成功
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> temp <span style=color:#66d9ef>values</span>(<span style=color:#66d9ef>null</span>,<span style=color:#e6db74>&#39;李琦&#39;</span>);<span style=color:#75715e>#失败
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>ERROR <span style=color:#ae81ff>1048</span> (<span style=color:#ae81ff>23000</span>): <span style=color:#66d9ef>Column</span> <span style=color:#e6db74>&#39;id&#39;</span> cannot be <span style=color:#66d9ef>null</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> temp;
</span></span><span style=display:flex><span><span style=color:#f92672>+----+------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> id <span style=color:#f92672>|</span> name <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+----+------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#ae81ff>1</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>张三</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#ae81ff>2</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>李四</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#ae81ff>3</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>张三</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#ae81ff>4</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+----+------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>4</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e>#演示一个表建立两个主键约束
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>temp</span>(
</span></span><span style=display:flex><span>	id <span style=color:#66d9ef>int</span> <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>,
</span></span><span style=display:flex><span>    name <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>20</span>) <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span>ERROR <span style=color:#ae81ff>1068</span> (<span style=color:#ae81ff>42000</span>): Multiple<span style=color:#960050;background-color:#1e0010>（多重的）</span> <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span> defined<span style=color:#960050;background-color:#1e0010>（定义）</span>
</span></span></code></pre></div><p>再举例：</p><ul><li>列级约束</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#a6e22e>emp4</span>(
</span></span><span style=display:flex><span>id <span style=color:#66d9ef>INT</span> <span style=color:#66d9ef>PRIMARY</span> <span style=color:#66d9ef>KEY</span> <span style=color:#66d9ef>AUTO_INCREMENT</span> ,
</span></span><span style=display:flex><span>NAME <span style=color:#66d9ef>VARCHAR</span>(<span style=color:#ae81ff>20</span>)
</span></span><span style=display:flex><span>);
</span></span></code></pre></div><ul><li>表级约束</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#a6e22e>emp5</span>(
</span></span><span style=display:flex><span>id <span style=color:#66d9ef>INT</span> <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span> <span style=color:#66d9ef>AUTO_INCREMENT</span>,
</span></span><span style=display:flex><span>NAME <span style=color:#66d9ef>VARCHAR</span>(<span style=color:#ae81ff>20</span>),
</span></span><span style=display:flex><span>pwd <span style=color:#66d9ef>VARCHAR</span>(<span style=color:#ae81ff>15</span>),
</span></span><span style=display:flex><span><span style=color:#66d9ef>CONSTRAINT</span> emp5_id_pk <span style=color:#66d9ef>PRIMARY</span> <span style=color:#66d9ef>KEY</span>(id)
</span></span><span style=display:flex><span>);
</span></span></code></pre></div><p>（2）建表后增加主键约束</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>ALTER</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#960050;background-color:#1e0010>表名称</span> <span style=color:#66d9ef>ADD</span> <span style=color:#66d9ef>PRIMARY</span> <span style=color:#66d9ef>KEY</span>(<span style=color:#960050;background-color:#1e0010>字段列表</span>); <span style=color:#75715e>#字段列表可以是一个字段，也可以是多个字段，如果是多个字段的话，是复合主键
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>ALTER</span> <span style=color:#66d9ef>TABLE</span> student <span style=color:#66d9ef>ADD</span> <span style=color:#66d9ef>PRIMARY</span> <span style=color:#66d9ef>KEY</span> (sid);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>ALTER</span> <span style=color:#66d9ef>TABLE</span> emp5 <span style=color:#66d9ef>ADD</span> <span style=color:#66d9ef>PRIMARY</span> <span style=color:#66d9ef>KEY</span>(NAME,pwd);
</span></span></code></pre></div><h3 id=45-关于复合主键>4.5 关于复合主键<a hidden class=anchor aria-hidden=true href=#45-关于复合主键>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#960050;background-color:#1e0010>表名称</span>(
</span></span><span style=display:flex><span>	<span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span>,
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span>,  
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span>,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>(<span style=color:#960050;background-color:#1e0010>字段名</span><span style=color:#ae81ff>1</span>,<span style=color:#960050;background-color:#1e0010>字段名</span><span style=color:#ae81ff>2</span>)  <span style=color:#75715e>#表示字段1和字段2的组合是唯一的，也可以有更多个字段
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e>#学生表
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>student</span>(
</span></span><span style=display:flex><span>	sid <span style=color:#66d9ef>int</span> <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>,  <span style=color:#75715e>#学号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    sname <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>20</span>)     <span style=color:#75715e>#学生姓名
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#课程表
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>course</span>(
</span></span><span style=display:flex><span>	cid <span style=color:#66d9ef>int</span> <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>,  <span style=color:#75715e>#课程编号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    cname <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>20</span>)     <span style=color:#75715e>#课程名称
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#选课表
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>student_course</span>(
</span></span><span style=display:flex><span>	sid <span style=color:#66d9ef>int</span>,
</span></span><span style=display:flex><span>    cid <span style=color:#66d9ef>int</span>,
</span></span><span style=display:flex><span>    score <span style=color:#66d9ef>int</span>,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>(sid,cid)  <span style=color:#75715e>#复合主键
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> student <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>1</span>,<span style=color:#e6db74>&#39;张三&#39;</span>),(<span style=color:#ae81ff>2</span>,<span style=color:#e6db74>&#39;李四&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> course <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>1001</span>,<span style=color:#e6db74>&#39;Java&#39;</span>),(<span style=color:#ae81ff>1002</span>,<span style=color:#e6db74>&#39;MySQL&#39;</span>);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> student;
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> sid <span style=color:#f92672>|</span> sname <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>1</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>张三</span>  <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>2</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>李四</span>  <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> course;
</span></span><span style=display:flex><span><span style=color:#f92672>+------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> cid  <span style=color:#f92672>|</span> cname <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#ae81ff>1001</span> <span style=color:#f92672>|</span> Java  <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#ae81ff>1002</span> <span style=color:#f92672>|</span> MySQL <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> student_course <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1001</span>, <span style=color:#ae81ff>89</span>),(<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>1002</span>,<span style=color:#ae81ff>90</span>),(<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>1001</span>,<span style=color:#ae81ff>88</span>),(<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>1002</span>,<span style=color:#ae81ff>56</span>);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> student_course;
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> sid <span style=color:#f92672>|</span> cid  <span style=color:#f92672>|</span> score <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>1</span> <span style=color:#f92672>|</span> <span style=color:#ae81ff>1001</span> <span style=color:#f92672>|</span>    <span style=color:#ae81ff>89</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>1</span> <span style=color:#f92672>|</span> <span style=color:#ae81ff>1002</span> <span style=color:#f92672>|</span>    <span style=color:#ae81ff>90</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>2</span> <span style=color:#f92672>|</span> <span style=color:#ae81ff>1001</span> <span style=color:#f92672>|</span>    <span style=color:#ae81ff>88</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>2</span> <span style=color:#f92672>|</span> <span style=color:#ae81ff>1002</span> <span style=color:#f92672>|</span>    <span style=color:#ae81ff>56</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>4</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> student_course <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1001</span>, <span style=color:#ae81ff>100</span>);
</span></span><span style=display:flex><span>ERROR <span style=color:#ae81ff>1062</span> (<span style=color:#ae81ff>23000</span>): Duplicate entry <span style=color:#e6db74>&#39;1-1001&#39;</span> <span style=color:#66d9ef>for</span> <span style=color:#66d9ef>key</span> <span style=color:#e6db74>&#39;PRIMARY&#39;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>desc</span> student_course;
</span></span><span style=display:flex><span><span style=color:#f92672>+-------+---------+------+-----+---------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> Field <span style=color:#f92672>|</span> Type    <span style=color:#f92672>|</span> <span style=color:#66d9ef>Null</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>Key</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>Default</span> <span style=color:#f92672>|</span> Extra <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-------+---------+------+-----+---------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> sid   <span style=color:#f92672>|</span> <span style=color:#66d9ef>int</span>(<span style=color:#ae81ff>11</span>) <span style=color:#f92672>|</span> NO   <span style=color:#f92672>|</span> PRI <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>    <span style=color:#f92672>|</span>       <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> cid   <span style=color:#f92672>|</span> <span style=color:#66d9ef>int</span>(<span style=color:#ae81ff>11</span>) <span style=color:#f92672>|</span> NO   <span style=color:#f92672>|</span> PRI <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>    <span style=color:#f92672>|</span>       <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> score <span style=color:#f92672>|</span> <span style=color:#66d9ef>int</span>(<span style=color:#ae81ff>11</span>) <span style=color:#f92672>|</span> YES  <span style=color:#f92672>|</span>     <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>    <span style=color:#f92672>|</span>       <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-------+---------+------+-----+---------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><ul><li>再举例</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#a6e22e>emp6</span>(
</span></span><span style=display:flex><span>id <span style=color:#66d9ef>INT</span> <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
</span></span><span style=display:flex><span>NAME <span style=color:#66d9ef>VARCHAR</span>(<span style=color:#ae81ff>20</span>),
</span></span><span style=display:flex><span>pwd <span style=color:#66d9ef>VARCHAR</span>(<span style=color:#ae81ff>15</span>),
</span></span><span style=display:flex><span><span style=color:#66d9ef>CONSTRAINT</span> emp7_pk <span style=color:#66d9ef>PRIMARY</span> <span style=color:#66d9ef>KEY</span>(NAME,pwd)
</span></span><span style=display:flex><span>);
</span></span></code></pre></div><h3 id=46-删除主键约束>4.6 删除主键约束<a hidden class=anchor aria-hidden=true href=#46-删除主键约束>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>alter</span> <span style=color:#66d9ef>table</span> <span style=color:#960050;background-color:#1e0010>表名称</span> <span style=color:#66d9ef>drop</span> <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>;
</span></span></code></pre></div><p>举例：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>ALTER</span> <span style=color:#66d9ef>TABLE</span> student <span style=color:#66d9ef>DROP</span> <span style=color:#66d9ef>PRIMARY</span> <span style=color:#66d9ef>KEY</span>;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>ALTER</span> <span style=color:#66d9ef>TABLE</span> emp5 <span style=color:#66d9ef>DROP</span> <span style=color:#66d9ef>PRIMARY</span> <span style=color:#66d9ef>KEY</span>;
</span></span></code></pre></div><blockquote><p>说明：删除主键约束，不需要指定主键名，因为一个表只有一个主键，删除主键约束后，非空还存在。</p></blockquote><h2 id=5-自增列auto_increment>5. 自增列：AUTO_INCREMENT<a hidden class=anchor aria-hidden=true href=#5-自增列auto_increment>#</a></h2><h3 id=51-作用>5.1 作用<a hidden class=anchor aria-hidden=true href=#51-作用>#</a></h3><p>某个字段的值自增</p><h3 id=52-关键字>5.2 关键字<a hidden class=anchor aria-hidden=true href=#52-关键字>#</a></h3><p>auto_increment</p><h3 id=53-特点和要求>5.3 特点和要求<a hidden class=anchor aria-hidden=true href=#53-特点和要求>#</a></h3><p>（1）一个表最多只能有一个自增长列</p><p>（2）当需要产生唯一标识符或顺序值时，可设置自增长</p><p>（3）自增长列约束的列必须是键列（主键列，唯一键列）</p><p>（4）自增约束的列的数据类型必须是整数类型</p><p>（5）如果自增列指定了 0 和 null，会在当前最大值的基础上自增；如果自增列手动指定了具体值，直接赋值为具体值。</p><p>错误演示：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>employee</span>(
</span></span><span style=display:flex><span>	eid <span style=color:#66d9ef>int</span> <span style=color:#66d9ef>auto_increment</span>,
</span></span><span style=display:flex><span>    ename <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>20</span>)
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span><span style=color:#75715e># ERROR 1075 (42000): Incorrect table definition; there can be only one auto column and it must be defined as a key   
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>employee</span>(
</span></span><span style=display:flex><span>	eid <span style=color:#66d9ef>int</span> <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>,
</span></span><span style=display:flex><span>    ename <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>20</span>) <span style=color:#66d9ef>unique</span> <span style=color:#66d9ef>key</span> <span style=color:#66d9ef>auto_increment</span>
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span><span style=color:#75715e># ERROR 1063 (42000): Incorrect column specifier for column &#39;ename&#39;  因为ename不是整数类型
</span></span></span></code></pre></div><h3 id=54-如何指定自增约束>5.4 如何指定自增约束<a hidden class=anchor aria-hidden=true href=#54-如何指定自增约束>#</a></h3><p><strong>（1）建表时</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#960050;background-color:#1e0010>表名称</span>(
</span></span><span style=display:flex><span>	<span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span>  <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span> <span style=color:#66d9ef>auto_increment</span>,
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span>  <span style=color:#66d9ef>unique</span> <span style=color:#66d9ef>key</span> <span style=color:#66d9ef>not</span> <span style=color:#66d9ef>null</span>,  
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span>  <span style=color:#66d9ef>unique</span> <span style=color:#66d9ef>key</span>,
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span>  <span style=color:#66d9ef>not</span> <span style=color:#66d9ef>null</span> <span style=color:#66d9ef>default</span> <span style=color:#960050;background-color:#1e0010>默认值</span>, 
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#960050;background-color:#1e0010>表名称</span>(
</span></span><span style=display:flex><span>	<span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span> <span style=color:#66d9ef>default</span> <span style=color:#960050;background-color:#1e0010>默认值</span> ,
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span> <span style=color:#66d9ef>unique</span> <span style=color:#66d9ef>key</span> <span style=color:#66d9ef>auto_increment</span>,  
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span> <span style=color:#66d9ef>not</span> <span style=color:#66d9ef>null</span> <span style=color:#66d9ef>default</span> <span style=color:#960050;background-color:#1e0010>默认值</span>,,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>(<span style=color:#960050;background-color:#1e0010>字段名</span>)
</span></span><span style=display:flex><span>);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>employee</span>(
</span></span><span style=display:flex><span>	eid <span style=color:#66d9ef>int</span> <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span> <span style=color:#66d9ef>auto_increment</span>,
</span></span><span style=display:flex><span>    ename <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>20</span>)
</span></span><span style=display:flex><span>);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>desc</span> employee;
</span></span><span style=display:flex><span><span style=color:#f92672>+-------+-------------+------+-----+---------+----------------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> Field <span style=color:#f92672>|</span> Type        <span style=color:#f92672>|</span> <span style=color:#66d9ef>Null</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>Key</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>Default</span> <span style=color:#f92672>|</span> Extra          <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-------+-------------+------+-----+---------+----------------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> eid   <span style=color:#f92672>|</span> <span style=color:#66d9ef>int</span>(<span style=color:#ae81ff>11</span>)     <span style=color:#f92672>|</span> NO   <span style=color:#f92672>|</span> PRI <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>    <span style=color:#f92672>|</span> <span style=color:#66d9ef>auto_increment</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> ename <span style=color:#f92672>|</span> <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>20</span>) <span style=color:#f92672>|</span> YES  <span style=color:#f92672>|</span>     <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>    <span style=color:#f92672>|</span>                <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-------+-------------+------+-----+---------+----------------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><p><strong>（2）建表后</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>alter</span> <span style=color:#66d9ef>table</span> <span style=color:#960050;background-color:#1e0010>表名称</span> modify <span style=color:#960050;background-color:#1e0010>字段名</span> <span style=color:#960050;background-color:#1e0010>数据类型</span> <span style=color:#66d9ef>auto_increment</span>;
</span></span></code></pre></div><p>例如：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>employee</span>(
</span></span><span style=display:flex><span>	eid <span style=color:#66d9ef>int</span> <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span> ,
</span></span><span style=display:flex><span>    ename <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>20</span>)
</span></span><span style=display:flex><span>);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>alter</span> <span style=color:#66d9ef>table</span> employee modify eid <span style=color:#66d9ef>int</span> <span style=color:#66d9ef>auto_increment</span>;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>desc</span> employee;
</span></span><span style=display:flex><span><span style=color:#f92672>+-------+-------------+------+-----+---------+----------------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> Field <span style=color:#f92672>|</span> Type        <span style=color:#f92672>|</span> <span style=color:#66d9ef>Null</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>Key</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>Default</span> <span style=color:#f92672>|</span> Extra          <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-------+-------------+------+-----+---------+----------------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> eid   <span style=color:#f92672>|</span> <span style=color:#66d9ef>int</span>(<span style=color:#ae81ff>11</span>)     <span style=color:#f92672>|</span> NO   <span style=color:#f92672>|</span> PRI <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>    <span style=color:#f92672>|</span> <span style=color:#66d9ef>auto_increment</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> ename <span style=color:#f92672>|</span> <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>20</span>) <span style=color:#f92672>|</span> YES  <span style=color:#f92672>|</span>     <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>    <span style=color:#f92672>|</span>                <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-------+-------------+------+-----+---------+----------------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><h3 id=55-如何删除自增约束>5.5 如何删除自增约束<a hidden class=anchor aria-hidden=true href=#55-如何删除自增约束>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e>#alter table 表名称 modify 字段名 数据类型 auto_increment;#给这个字段增加自增约束
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>alter</span> <span style=color:#66d9ef>table</span> <span style=color:#960050;background-color:#1e0010>表名称</span> modify <span style=color:#960050;background-color:#1e0010>字段名</span> <span style=color:#960050;background-color:#1e0010>数据类型</span>; <span style=color:#75715e>#去掉auto_increment相当于删除
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>alter</span> <span style=color:#66d9ef>table</span> employee modify eid <span style=color:#66d9ef>int</span>;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>desc</span> employee;
</span></span><span style=display:flex><span><span style=color:#f92672>+-------+-------------+------+-----+---------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> Field <span style=color:#f92672>|</span> Type        <span style=color:#f92672>|</span> <span style=color:#66d9ef>Null</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>Key</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>Default</span> <span style=color:#f92672>|</span> Extra <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-------+-------------+------+-----+---------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> eid   <span style=color:#f92672>|</span> <span style=color:#66d9ef>int</span>(<span style=color:#ae81ff>11</span>)     <span style=color:#f92672>|</span> NO   <span style=color:#f92672>|</span> PRI <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>    <span style=color:#f92672>|</span>       <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> ename <span style=color:#f92672>|</span> <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>20</span>) <span style=color:#f92672>|</span> YES  <span style=color:#f92672>|</span>     <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>    <span style=color:#f92672>|</span>       <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-------+-------------+------+-----+---------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><h3 id=56-mysql-80新特性自增变量的持久化>5.6 MySQL 8.0新特性—自增变量的持久化<a hidden class=anchor aria-hidden=true href=#56-mysql-80新特性自增变量的持久化>#</a></h3><p>在MySQL 8.0之前，自增主键AUTO_INCREMENT的值如果大于max(primary key)+1，在MySQL重启后，会重置AUTO_INCREMENT=max(primary key)+1，这种现象在某些情况下会导致业务主键冲突或者其他难以发现的问题。
下面通过案例来对比不同的版本中自增变量是否持久化。
在MySQL 5.7版本中，测试步骤如下：
创建的数据表中包含自增主键的id字段，语句如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#a6e22e>test1</span>(
</span></span><span style=display:flex><span>id <span style=color:#66d9ef>INT</span> <span style=color:#66d9ef>PRIMARY</span> <span style=color:#66d9ef>KEY</span> <span style=color:#66d9ef>AUTO_INCREMENT</span>
</span></span><span style=display:flex><span>);
</span></span></code></pre></div><p>插入4个空值，执行如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> test1
</span></span><span style=display:flex><span><span style=color:#66d9ef>VALUES</span>(<span style=color:#ae81ff>0</span>),(<span style=color:#ae81ff>0</span>),(<span style=color:#ae81ff>0</span>),(<span style=color:#ae81ff>0</span>);
</span></span></code></pre></div><p>查询数据表test1中的数据，结果如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> test1;
</span></span><span style=display:flex><span><span style=color:#f92672>+----+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> id <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+----+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#ae81ff>1</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#ae81ff>2</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#ae81ff>3</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#ae81ff>4</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+----+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>4</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><p>删除id为4的记录，语句如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>DELETE</span> <span style=color:#66d9ef>FROM</span> test1 <span style=color:#66d9ef>WHERE</span> id <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>;
</span></span></code></pre></div><p>再次插入一个空值，语句如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> test1 <span style=color:#66d9ef>VALUES</span>(<span style=color:#ae81ff>0</span>);
</span></span></code></pre></div><p>查询此时数据表test1中的数据，结果如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> test1;
</span></span><span style=display:flex><span><span style=color:#f92672>+----+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> id <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+----+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#ae81ff>1</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#ae81ff>2</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#ae81ff>3</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#ae81ff>5</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+----+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>4</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><p>从结果可以看出，虽然删除了id为4的记录，但是再次插入空值时，并没有重用被删除的4，而是分配了5。
删除id为5的记录，结果如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>DELETE</span> <span style=color:#66d9ef>FROM</span> test1 <span style=color:#66d9ef>where</span> id<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>;
</span></span></code></pre></div><p><strong>重启数据库</strong>，重新插入一个空值。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> test1 <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>0</span>);
</span></span></code></pre></div><p>再次查询数据表test1中的数据，结果如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> test1;
</span></span><span style=display:flex><span><span style=color:#f92672>+----+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> id <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+----+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#ae81ff>1</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#ae81ff>2</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#ae81ff>3</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#ae81ff>4</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+----+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>4</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><p>从结果可以看出，新插入的0值分配的是4，按照重启前的操作逻辑，此处应该分配6。出现上述结果的主要原因是自增主键没有持久化。
在MySQL 5.7系统中，对于自增主键的分配规则，是由InnoDB数据字典内部一个<code>计数器</code>来决定的，而该计数器只在<code>内存中维护</code>，并不会持久化到磁盘中。当数据库重启时，该计数器会被初始化。</p><p>在MySQL 8.0版本中，上述测试步骤最后一步的结果如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> test1;
</span></span><span style=display:flex><span><span style=color:#f92672>+----+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> id <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+----+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#ae81ff>1</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#ae81ff>2</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#ae81ff>3</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#ae81ff>6</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+----+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>4</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><p>从结果可以看出，自增变量已经持久化了。</p><p>MySQL 8.0将自增主键的计数器持久化到<code>重做日志</code>中。每次计数器发生改变，都会将其写入重做日志中。如果数据库重启，InnoDB会根据重做日志中的信息来初始化计数器的内存值。</p><h2 id=6-foreign-key-约束>6. FOREIGN KEY 约束<a hidden class=anchor aria-hidden=true href=#6-foreign-key-约束>#</a></h2><h3 id=61-作用>6.1 作用<a hidden class=anchor aria-hidden=true href=#61-作用>#</a></h3><p>限定某个表的某个字段的引用完整性。</p><p>比如：员工表的员工所在部门的选择，必须在部门表能找到对应的部分。</p><p><img loading=lazy src=../_resources/1555428214706.png alt=1555428214706></p><h3 id=62-关键字>6.2 关键字<a hidden class=anchor aria-hidden=true href=#62-关键字>#</a></h3><p>FOREIGN KEY</p><h3 id=63-主表和从表父表和子表>6.3 主表和从表/父表和子表<a hidden class=anchor aria-hidden=true href=#63-主表和从表父表和子表>#</a></h3><p>主表（父表）：被引用的表，被参考的表</p><p>从表（子表）：引用别人的表，参考别人的表</p><p>例如：员工表的员工所在部门这个字段的值要参考部门表：部门表是主表，员工表是从表。</p><p>例如：学生表、课程表、选课表：选课表的学生和课程要分别参考学生表和课程表，学生表和课程表是主表，选课表是从表。</p><h3 id=64-特点>6.4 特点<a hidden class=anchor aria-hidden=true href=#64-特点>#</a></h3><p>（1）从表的外键列，必须引用/参考主表的主键或唯一约束的列</p><p>​ 为什么？因为被依赖/被参考的值必须是唯一的</p><p>（2）在创建外键约束时，如果不给外键约束命名，<strong>默认名不是列名，而是自动产生一个外键名</strong>（例如 student_ibfk_1;），也可以指定外键约束名。</p><p>（3）创建(CREATE)表时就指定外键约束的话，先创建主表，再创建从表</p><p>（4）删表时，先删从表（或先删除外键约束），再删除主表</p><p>（5）当主表的记录被从表参照时，主表的记录将不允许删除，如果要删除数据，需要先删除从表中依赖该记录的数据，然后才可以删除主表的数据</p><p>（6）在“从表”中指定外键约束，并且一个表可以建立多个外键约束</p><p>（7）从表的外键列与主表被参照的列名字可以不相同，但是数据类型必须一样，逻辑意义一致。如果类型不一样，创建子表时，就会出现错误“ERROR 1005 (HY000): Can&rsquo;t create table&rsquo;database.tablename&rsquo;(errno: 150)”。</p><p>​ 例如：都是表示部门编号，都是int类型。</p><p>（8）<strong>当创建外键约束时，系统默认会在所在的列上建立对应的普通索引</strong>。但是索引名是外键的约束名。（根据外键查询效率很高）</p><p>（9）删除外键约束后，必须<code>手动</code>删除对应的索引</p><h3 id=65-添加外键约束>6.5 添加外键约束<a hidden class=anchor aria-hidden=true href=#65-添加外键约束>#</a></h3><p>（1）建表时</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#960050;background-color:#1e0010>主表名称</span>(
</span></span><span style=display:flex><span>	<span style=color:#960050;background-color:#1e0010>字段</span><span style=color:#ae81ff>1</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span>  <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>,
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>字段</span><span style=color:#ae81ff>2</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span>
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#960050;background-color:#1e0010>从表名称</span>(
</span></span><span style=display:flex><span>	<span style=color:#960050;background-color:#1e0010>字段</span><span style=color:#ae81ff>1</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span>  <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>,
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>字段</span><span style=color:#ae81ff>2</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span>,
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>CONSTRAINT</span> <span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>外键约束名称</span><span style=color:#f92672>&gt;</span>] <span style=color:#66d9ef>FOREIGN</span> <span style=color:#66d9ef>KEY</span><span style=color:#960050;background-color:#1e0010>（从表的某个字段</span>) <span style=color:#66d9ef>references</span> <span style=color:#960050;background-color:#1e0010>主表名</span>(<span style=color:#960050;background-color:#1e0010>被参考字段</span>)
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span><span style=color:#75715e>#(从表的某个字段)的数据类型必须与主表名(被参考字段)的数据类型一致，逻辑意义也一样
</span></span></span><span style=display:flex><span><span style=color:#75715e>#(从表的某个字段)的字段名可以与主表名(被参考字段)的字段名一样，也可以不一样
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- FOREIGN KEY: 在表级指定子表中的列
</span></span></span><span style=display:flex><span><span style=color:#75715e>-- REFERENCES: 标示在父表中的列
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>dept</span>( <span style=color:#75715e>#主表
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	did <span style=color:#66d9ef>int</span> <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>,		<span style=color:#75715e>#部门编号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    dname <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>50</span>)			<span style=color:#75715e>#部门名称
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>emp</span>(<span style=color:#75715e>#从表
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	eid <span style=color:#66d9ef>int</span> <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>,  <span style=color:#75715e>#员工编号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    ename <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>5</span>),     <span style=color:#75715e>#员工姓名
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    deptid <span style=color:#66d9ef>int</span>,				<span style=color:#75715e>#员工所在的部门
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>foreign</span> <span style=color:#66d9ef>key</span> (deptid) <span style=color:#66d9ef>references</span> <span style=color:#a6e22e>dept</span>(did)   <span style=color:#75715e>#在从表中指定外键约束
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>#emp表的deptid和和dept表的did的数据类型一致，意义都是表示部门的编号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>说明：</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>（</span><span style=color:#ae81ff>1</span><span style=color:#960050;background-color:#1e0010>）主表</span>dept必须先创建成功<span style=color:#960050;background-color:#1e0010>，然后才能创建</span>emp表<span style=color:#960050;background-color:#1e0010>，指定外键成功。</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>（</span><span style=color:#ae81ff>2</span><span style=color:#960050;background-color:#1e0010>）删除表时，先删除从表</span>emp<span style=color:#960050;background-color:#1e0010>，再删除主表</span>dept
</span></span></code></pre></div><p>（2）建表后</p><p>一般情况下，表与表的关联都是提前设计好了的，因此，会在创建表的时候就把外键约束定义好。不过，如果需要修改表的设计（比如添加新的字段，增加新的关联关系），但没有预先定义外键约束，那么，就要用修改表的方式来补充定义。</p><p>格式：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>ALTER</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#960050;background-color:#1e0010>从表名</span> <span style=color:#66d9ef>ADD</span> [<span style=color:#66d9ef>CONSTRAINT</span> <span style=color:#960050;background-color:#1e0010>约束名</span>] <span style=color:#66d9ef>FOREIGN</span> <span style=color:#66d9ef>KEY</span> (<span style=color:#960050;background-color:#1e0010>从表的字段</span>) <span style=color:#66d9ef>REFERENCES</span> <span style=color:#960050;background-color:#1e0010>主表名</span>(<span style=color:#960050;background-color:#1e0010>被引用字段</span>) [<span style=color:#66d9ef>on</span> <span style=color:#66d9ef>update</span> xx][<span style=color:#66d9ef>on</span> <span style=color:#66d9ef>delete</span> xx];
</span></span></code></pre></div><p>举例：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>ALTER</span> <span style=color:#66d9ef>TABLE</span> emp1
</span></span><span style=display:flex><span><span style=color:#66d9ef>ADD</span> [<span style=color:#66d9ef>CONSTRAINT</span> emp_dept_id_fk] <span style=color:#66d9ef>FOREIGN</span> <span style=color:#66d9ef>KEY</span>(dept_id) <span style=color:#66d9ef>REFERENCES</span> <span style=color:#a6e22e>dept</span>(dept_id);
</span></span></code></pre></div><p>举例：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>dept</span>(
</span></span><span style=display:flex><span>	did <span style=color:#66d9ef>int</span> <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>,		<span style=color:#75715e>#部门编号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    dname <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>50</span>)			<span style=color:#75715e>#部门名称
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>emp</span>(
</span></span><span style=display:flex><span>	eid <span style=color:#66d9ef>int</span> <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>,  <span style=color:#75715e>#员工编号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    ename <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>5</span>),     <span style=color:#75715e>#员工姓名
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    deptid <span style=color:#66d9ef>int</span>				<span style=color:#75715e>#员工所在的部门
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>);
</span></span><span style=display:flex><span><span style=color:#75715e>#这两个表创建时，没有指定外键的话，那么创建顺序是随意
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>alter</span> <span style=color:#66d9ef>table</span> emp <span style=color:#66d9ef>add</span> <span style=color:#66d9ef>foreign</span> <span style=color:#66d9ef>key</span> (deptid) <span style=color:#66d9ef>references</span> <span style=color:#a6e22e>dept</span>(did);
</span></span></code></pre></div><h3 id=66-演示问题>6.6 演示问题<a hidden class=anchor aria-hidden=true href=#66-演示问题>#</a></h3><p>（1）失败：不是键列</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>dept</span>(
</span></span><span style=display:flex><span>	did <span style=color:#66d9ef>int</span> ,		<span style=color:#75715e>#部门编号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    dname <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>50</span>)			<span style=color:#75715e>#部门名称
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>emp</span>(
</span></span><span style=display:flex><span>	eid <span style=color:#66d9ef>int</span> <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>,  <span style=color:#75715e>#员工编号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    ename <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>5</span>),     <span style=color:#75715e>#员工姓名
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    deptid <span style=color:#66d9ef>int</span>,				<span style=color:#75715e>#员工所在的部门
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>foreign</span> <span style=color:#66d9ef>key</span> (deptid) <span style=color:#66d9ef>references</span> <span style=color:#a6e22e>dept</span>(did)
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span><span style=color:#75715e>#ERROR 1215 (HY000): Cannot add foreign key constraint  原因是dept的did不是键列
</span></span></span></code></pre></div><p>（2）失败：数据类型不一致</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>dept</span>(
</span></span><span style=display:flex><span>	did <span style=color:#66d9ef>int</span> <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>,		<span style=color:#75715e>#部门编号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    dname <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>50</span>)			<span style=color:#75715e>#部门名称
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>emp</span>(
</span></span><span style=display:flex><span>	eid <span style=color:#66d9ef>int</span> <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>,  <span style=color:#75715e>#员工编号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    ename <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>5</span>),     <span style=color:#75715e>#员工姓名
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    deptid <span style=color:#66d9ef>char</span>,				<span style=color:#75715e>#员工所在的部门
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>foreign</span> <span style=color:#66d9ef>key</span> (deptid) <span style=color:#66d9ef>references</span> <span style=color:#a6e22e>dept</span>(did)
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span><span style=color:#75715e>#ERROR 1215 (HY000): Cannot add foreign key constraint  原因是从表的deptid字段和主表的did字段的数据类型不一致，并且要它俩的逻辑意义一致
</span></span></span></code></pre></div><p>（3）成功，两个表字段名一样</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>dept</span>(
</span></span><span style=display:flex><span>	did <span style=color:#66d9ef>int</span> <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>,		<span style=color:#75715e>#部门编号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    dname <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>50</span>)			<span style=color:#75715e>#部门名称
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>emp</span>(
</span></span><span style=display:flex><span>	eid <span style=color:#66d9ef>int</span> <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>,  <span style=color:#75715e>#员工编号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    ename <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>5</span>),     <span style=color:#75715e>#员工姓名
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    did <span style=color:#66d9ef>int</span>,				<span style=color:#75715e>#员工所在的部门
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>foreign</span> <span style=color:#66d9ef>key</span> (did) <span style=color:#66d9ef>references</span> <span style=color:#a6e22e>dept</span>(did)  
</span></span><span style=display:flex><span>    <span style=color:#75715e>#emp表的deptid和和dept表的did的数据类型一致，意义都是表示部门的编号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>#是否重名没问题，因为两个did在不同的表中
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>);
</span></span></code></pre></div><p>（4）添加、删除、修改问题</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>dept</span>(
</span></span><span style=display:flex><span>	did <span style=color:#66d9ef>int</span> <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>,		<span style=color:#75715e>#部门编号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    dname <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>50</span>)			<span style=color:#75715e>#部门名称
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>emp</span>(
</span></span><span style=display:flex><span>	eid <span style=color:#66d9ef>int</span> <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>,  <span style=color:#75715e>#员工编号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    ename <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>5</span>),     <span style=color:#75715e>#员工姓名
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    deptid <span style=color:#66d9ef>int</span>,				<span style=color:#75715e>#员工所在的部门
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>foreign</span> <span style=color:#66d9ef>key</span> (deptid) <span style=color:#66d9ef>references</span> <span style=color:#a6e22e>dept</span>(did)  
</span></span><span style=display:flex><span>    <span style=color:#75715e>#emp表的deptid和和dept表的did的数据类型一致，意义都是表示部门的编号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> dept <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>1001</span>,<span style=color:#e6db74>&#39;教学部&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> dept <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>1003</span>, <span style=color:#e6db74>&#39;财务部&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> emp <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>1</span>,<span style=color:#e6db74>&#39;张三&#39;</span>,<span style=color:#ae81ff>1001</span>); <span style=color:#75715e>#添加从表记录成功，在添加这条记录时，要求部门表有1001部门
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> emp <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>2</span>,<span style=color:#e6db74>&#39;李四&#39;</span>,<span style=color:#ae81ff>1005</span>);<span style=color:#75715e>#添加从表记录失败
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>ERROR <span style=color:#ae81ff>1452</span> (<span style=color:#ae81ff>23000</span>): Cannot <span style=color:#66d9ef>add</span><span style=color:#960050;background-color:#1e0010>（添加）</span> <span style=color:#66d9ef>or</span> <span style=color:#66d9ef>update</span><span style=color:#960050;background-color:#1e0010>（修改）</span> a child row: a <span style=color:#66d9ef>foreign</span> <span style=color:#66d9ef>key</span> <span style=color:#66d9ef>constraint</span> <span style=color:#a6e22e>fails</span> (<span style=color:#f92672>`</span>atguigudb<span style=color:#f92672>`</span>.<span style=color:#f92672>`</span>emp<span style=color:#f92672>`</span>, <span style=color:#66d9ef>CONSTRAINT</span> <span style=color:#f92672>`</span>emp_ibfk_1<span style=color:#f92672>`</span> <span style=color:#66d9ef>FOREIGN</span> <span style=color:#66d9ef>KEY</span> (<span style=color:#f92672>`</span>deptid<span style=color:#f92672>`</span>) <span style=color:#66d9ef>REFERENCES</span> <span style=color:#f92672>`</span>dept<span style=color:#f92672>`</span> (<span style=color:#f92672>`</span>did<span style=color:#f92672>`</span>)) <span style=color:#960050;background-color:#1e0010>从表</span>emp添加记录失败<span style=color:#960050;background-color:#1e0010>，因为主表</span>dept没有1005部门
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> dept;
</span></span><span style=display:flex><span><span style=color:#f92672>+------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> did  <span style=color:#f92672>|</span> dname  <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#ae81ff>1001</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>教学部</span>  <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#ae81ff>1003</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>财务部</span>  <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> emp;
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> eid <span style=color:#f92672>|</span> ename <span style=color:#f92672>|</span> deptid <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>1</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>张三</span>   <span style=color:#f92672>|</span>   <span style=color:#ae81ff>1001</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span> row <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>update</span> emp <span style=color:#66d9ef>set</span> deptid <span style=color:#f92672>=</span> <span style=color:#ae81ff>1002</span> <span style=color:#66d9ef>where</span> eid <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;<span style=color:#75715e>#修改从表失败 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>ERROR <span style=color:#ae81ff>1452</span> (<span style=color:#ae81ff>23000</span>): Cannot <span style=color:#66d9ef>add</span><span style=color:#960050;background-color:#1e0010>（添加）</span> <span style=color:#66d9ef>or</span> <span style=color:#66d9ef>update</span><span style=color:#960050;background-color:#1e0010>（修改）</span> a child row<span style=color:#960050;background-color:#1e0010>（子表的记录）</span>: a <span style=color:#66d9ef>foreign</span> <span style=color:#66d9ef>key</span> <span style=color:#66d9ef>constraint</span> fails<span style=color:#960050;background-color:#1e0010>（外键约束失败）</span> (<span style=color:#f92672>`</span>atguigudb<span style=color:#f92672>`</span>.<span style=color:#f92672>`</span>emp<span style=color:#f92672>`</span>, <span style=color:#66d9ef>CONSTRAINT</span> <span style=color:#f92672>`</span>emp_ibfk_1<span style=color:#f92672>`</span> <span style=color:#66d9ef>FOREIGN</span> <span style=color:#66d9ef>KEY</span> (<span style=color:#f92672>`</span>deptid<span style=color:#f92672>`</span>) <span style=color:#66d9ef>REFERENCES</span> <span style=color:#f92672>`</span>dept<span style=color:#f92672>`</span> (<span style=color:#f92672>`</span>did<span style=color:#f92672>`</span>))  <span style=color:#75715e>#部门表did字段现在没有1002的值，所以员工表中不能修改员工所在部门deptid为1002
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>update</span> dept <span style=color:#66d9ef>set</span> did <span style=color:#f92672>=</span> <span style=color:#ae81ff>1002</span> <span style=color:#66d9ef>where</span> did <span style=color:#f92672>=</span> <span style=color:#ae81ff>1001</span>;<span style=color:#75715e>#修改主表失败
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>ERROR <span style=color:#ae81ff>1451</span> (<span style=color:#ae81ff>23000</span>): Cannot <span style=color:#66d9ef>delete</span><span style=color:#960050;background-color:#1e0010>（删除）</span> <span style=color:#66d9ef>or</span> <span style=color:#66d9ef>update</span><span style=color:#960050;background-color:#1e0010>（修改）</span> a parent row<span style=color:#960050;background-color:#1e0010>（父表的记录）</span>: a <span style=color:#66d9ef>foreign</span> <span style=color:#66d9ef>key</span> <span style=color:#66d9ef>constraint</span> <span style=color:#a6e22e>fails</span> (<span style=color:#f92672>`</span>atguigudb<span style=color:#f92672>`</span>.<span style=color:#f92672>`</span>emp<span style=color:#f92672>`</span>, <span style=color:#66d9ef>CONSTRAINT</span> <span style=color:#f92672>`</span>emp_ibfk_1<span style=color:#f92672>`</span> <span style=color:#66d9ef>FOREIGN</span> <span style=color:#66d9ef>KEY</span> (<span style=color:#f92672>`</span>deptid<span style=color:#f92672>`</span>) <span style=color:#66d9ef>REFERENCES</span> <span style=color:#f92672>`</span>dept<span style=color:#f92672>`</span> (<span style=color:#f92672>`</span>did<span style=color:#f92672>`</span>)) <span style=color:#75715e>#部门表did的1001字段已经被emp引用了，所以部门表的1001字段就不能修改了。
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>update</span> dept <span style=color:#66d9ef>set</span> did <span style=color:#f92672>=</span> <span style=color:#ae81ff>1002</span> <span style=color:#66d9ef>where</span> did <span style=color:#f92672>=</span> <span style=color:#ae81ff>1003</span>;<span style=color:#75715e>#修改主表成功  因为部门表的1003部门没有被emp表引用，所以可以修改
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>delete</span> <span style=color:#66d9ef>from</span> dept <span style=color:#66d9ef>where</span> did<span style=color:#f92672>=</span><span style=color:#ae81ff>1001</span>; <span style=color:#75715e>#删除主表失败
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>ERROR <span style=color:#ae81ff>1451</span> (<span style=color:#ae81ff>23000</span>): Cannot <span style=color:#66d9ef>delete</span><span style=color:#960050;background-color:#1e0010>（删除）</span> <span style=color:#66d9ef>or</span> <span style=color:#66d9ef>update</span><span style=color:#960050;background-color:#1e0010>（修改）</span> a parent row<span style=color:#960050;background-color:#1e0010>（父表记录）</span>: a <span style=color:#66d9ef>foreign</span> <span style=color:#66d9ef>key</span> <span style=color:#66d9ef>constraint</span> <span style=color:#a6e22e>fails</span> (<span style=color:#f92672>`</span>atguigudb<span style=color:#f92672>`</span>.<span style=color:#f92672>`</span>emp<span style=color:#f92672>`</span>, <span style=color:#66d9ef>CONSTRAINT</span> <span style=color:#f92672>`</span>emp_ibfk_1<span style=color:#f92672>`</span> <span style=color:#66d9ef>FOREIGN</span> <span style=color:#66d9ef>KEY</span> (<span style=color:#f92672>`</span>deptid<span style=color:#f92672>`</span>) <span style=color:#66d9ef>REFERENCES</span> <span style=color:#f92672>`</span>dept<span style=color:#f92672>`</span> (<span style=color:#f92672>`</span>did<span style=color:#f92672>`</span>))  <span style=color:#75715e>#因为部门表did的1001字段已经被emp引用了，所以部门表的1001字段对应的记录就不能被删除
</span></span></span></code></pre></div><p>总结：约束关系是针对双方的</p><ul><li><p>添加了外键约束后，主表的修改和删除数据受约束</p></li><li><p>添加了外键约束后，从表的添加和修改数据受约束</p></li><li><p>在从表上建立外键，要求主表必须存在</p></li><li><p>删除主表时，要求从表从表先删除，或将从表中外键引用该主表的关系先删除</p></li></ul><h3 id=67-约束等级>6.7 约束等级<a hidden class=anchor aria-hidden=true href=#67-约束等级>#</a></h3><ul><li><p><code>Cascade方式</code>：在父表上update/delete记录时，同步update/delete掉子表的匹配记录</p></li><li><p><code>Set null方式</code>：在父表上update/delete记录时，将子表上匹配记录的列设为null，但是要注意子表的外键列不能为not null</p></li><li><p><code>No action方式</code>：如果子表中有匹配的记录，则不允许对父表对应候选键进行update/delete操作</p></li><li><p><code>Restrict方式</code>：同no action， 都是立即检查外键约束</p></li><li><p><code>Set default方式</code>（在可视化工具SQLyog中可能显示空白）：父表有变更时，子表将外键列设置成一个默认的值，但Innodb不能识别</p></li></ul><p>如果没有指定等级，就相当于Restrict方式。</p><p>对于外键约束，最好是采用: <code>ON UPDATE CASCADE ON DELETE RESTRICT</code> 的方式。</p><p>（1）演示1：on update cascade on delete set null</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>dept</span>(
</span></span><span style=display:flex><span>	did <span style=color:#66d9ef>int</span> <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>,		<span style=color:#75715e>#部门编号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    dname <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>50</span>)			<span style=color:#75715e>#部门名称
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>emp</span>(
</span></span><span style=display:flex><span>	eid <span style=color:#66d9ef>int</span> <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>,  <span style=color:#75715e>#员工编号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    ename <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>5</span>),     <span style=color:#75715e>#员工姓名
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    deptid <span style=color:#66d9ef>int</span>,				<span style=color:#75715e>#员工所在的部门
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>foreign</span> <span style=color:#66d9ef>key</span> (deptid) <span style=color:#66d9ef>references</span> <span style=color:#a6e22e>dept</span>(did)  <span style=color:#66d9ef>on</span> <span style=color:#66d9ef>update</span> <span style=color:#66d9ef>cascade</span> <span style=color:#66d9ef>on</span> <span style=color:#66d9ef>delete</span> <span style=color:#66d9ef>set</span> <span style=color:#66d9ef>null</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#把修改操作设置为级联修改等级，把删除操作设置为set null等级
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> dept <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>1001</span>,<span style=color:#e6db74>&#39;教学部&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> dept <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>1002</span>, <span style=color:#e6db74>&#39;财务部&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> dept <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>1003</span>, <span style=color:#e6db74>&#39;咨询部&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> emp <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>1</span>,<span style=color:#e6db74>&#39;张三&#39;</span>,<span style=color:#ae81ff>1001</span>); <span style=color:#75715e>#在添加这条记录时，要求部门表有1001部门
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> emp <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>2</span>,<span style=color:#e6db74>&#39;李四&#39;</span>,<span style=color:#ae81ff>1001</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> emp <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>3</span>,<span style=color:#e6db74>&#39;王五&#39;</span>,<span style=color:#ae81ff>1002</span>);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> dept;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> emp;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e>#修改主表成功，从表也跟着修改，修改了主表被引用的字段1002为1004，从表的引用字段就跟着修改为1004了
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>update</span> dept <span style=color:#66d9ef>set</span> did <span style=color:#f92672>=</span> <span style=color:#ae81ff>1004</span> <span style=color:#66d9ef>where</span> did <span style=color:#f92672>=</span> <span style=color:#ae81ff>1002</span>;
</span></span><span style=display:flex><span>Query OK, <span style=color:#ae81ff>1</span> row <span style=color:#a6e22e>affected</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span><span style=display:flex><span>Rows matched: <span style=color:#ae81ff>1</span>  Changed: <span style=color:#ae81ff>1</span>  Warnings: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> dept;
</span></span><span style=display:flex><span><span style=color:#f92672>+------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> did  <span style=color:#f92672>|</span> dname  <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#ae81ff>1001</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>教学部</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#ae81ff>1003</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>咨询部</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#ae81ff>1004</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>财务部</span> <span style=color:#f92672>|</span> <span style=color:#75715e>#原来是1002，修改为1004
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>+------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> emp;
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> eid <span style=color:#f92672>|</span> ename <span style=color:#f92672>|</span> deptid <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>1</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>张三</span>  <span style=color:#f92672>|</span>   <span style=color:#ae81ff>1001</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>2</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>李四</span>  <span style=color:#f92672>|</span>   <span style=color:#ae81ff>1001</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>3</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>王五</span>  <span style=color:#f92672>|</span>   <span style=color:#ae81ff>1004</span> <span style=color:#f92672>|</span> <span style=color:#75715e>#原来是1002，跟着修改为1004
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>+-----+-------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e>#删除主表的记录成功，从表对应的字段的值被修改为null
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>delete</span> <span style=color:#66d9ef>from</span> dept <span style=color:#66d9ef>where</span> did <span style=color:#f92672>=</span> <span style=color:#ae81ff>1001</span>;
</span></span><span style=display:flex><span>Query OK, <span style=color:#ae81ff>1</span> row <span style=color:#a6e22e>affected</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>01</span> sec)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> dept;
</span></span><span style=display:flex><span><span style=color:#f92672>+------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> did  <span style=color:#f92672>|</span> dname  <span style=color:#f92672>|</span> <span style=color:#75715e>#记录1001部门被删除了
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>+------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#ae81ff>1003</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>咨询部</span>  <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#ae81ff>1004</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>财务部</span>  <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> emp;
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> eid <span style=color:#f92672>|</span> ename <span style=color:#f92672>|</span> deptid <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>1</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>张三</span>  <span style=color:#f92672>|</span>   <span style=color:#66d9ef>NULL</span> <span style=color:#f92672>|</span> <span style=color:#75715e>#原来引用1001部门的员工，deptid字段变为null
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>2</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>李四</span>  <span style=color:#f92672>|</span>   <span style=color:#66d9ef>NULL</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>3</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>王五</span>  <span style=color:#f92672>|</span>   <span style=color:#ae81ff>1004</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><p>（2）演示2：on update set null on delete cascade</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>dept</span>(
</span></span><span style=display:flex><span>	did <span style=color:#66d9ef>int</span> <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>,		<span style=color:#75715e>#部门编号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    dname <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>50</span>)			<span style=color:#75715e>#部门名称
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>emp</span>(
</span></span><span style=display:flex><span>	eid <span style=color:#66d9ef>int</span> <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>,  <span style=color:#75715e>#员工编号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    ename <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>5</span>),     <span style=color:#75715e>#员工姓名
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    deptid <span style=color:#66d9ef>int</span>,				<span style=color:#75715e>#员工所在的部门
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>foreign</span> <span style=color:#66d9ef>key</span> (deptid) <span style=color:#66d9ef>references</span> <span style=color:#a6e22e>dept</span>(did)  <span style=color:#66d9ef>on</span> <span style=color:#66d9ef>update</span> <span style=color:#66d9ef>set</span> <span style=color:#66d9ef>null</span> <span style=color:#66d9ef>on</span> <span style=color:#66d9ef>delete</span> <span style=color:#66d9ef>cascade</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#把修改操作设置为set null等级，把删除操作设置为级联删除等级
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> dept <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>1001</span>,<span style=color:#e6db74>&#39;教学部&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> dept <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>1002</span>, <span style=color:#e6db74>&#39;财务部&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> dept <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>1003</span>, <span style=color:#e6db74>&#39;咨询部&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> emp <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>1</span>,<span style=color:#e6db74>&#39;张三&#39;</span>,<span style=color:#ae81ff>1001</span>); <span style=color:#75715e>#在添加这条记录时，要求部门表有1001部门
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> emp <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>2</span>,<span style=color:#e6db74>&#39;李四&#39;</span>,<span style=color:#ae81ff>1001</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> emp <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>3</span>,<span style=color:#e6db74>&#39;王五&#39;</span>,<span style=color:#ae81ff>1002</span>);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> dept;
</span></span><span style=display:flex><span><span style=color:#f92672>+------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> did  <span style=color:#f92672>|</span> dname  <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#ae81ff>1001</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>教学部</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#ae81ff>1002</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>财务部</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#ae81ff>1003</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>咨询部</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> emp;
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> eid <span style=color:#f92672>|</span> ename <span style=color:#f92672>|</span> deptid <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>1</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>张三</span>  <span style=color:#f92672>|</span>   <span style=color:#ae81ff>1001</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>2</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>李四</span>  <span style=color:#f92672>|</span>   <span style=color:#ae81ff>1001</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>3</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>王五</span>  <span style=color:#f92672>|</span>   <span style=color:#ae81ff>1002</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e>#修改主表，从表对应的字段设置为null
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>update</span> dept <span style=color:#66d9ef>set</span> did <span style=color:#f92672>=</span> <span style=color:#ae81ff>1004</span> <span style=color:#66d9ef>where</span> did <span style=color:#f92672>=</span> <span style=color:#ae81ff>1002</span>;
</span></span><span style=display:flex><span>Query OK, <span style=color:#ae81ff>1</span> row <span style=color:#a6e22e>affected</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span><span style=display:flex><span>Rows matched: <span style=color:#ae81ff>1</span>  Changed: <span style=color:#ae81ff>1</span>  Warnings: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> dept;
</span></span><span style=display:flex><span><span style=color:#f92672>+------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> did  <span style=color:#f92672>|</span> dname  <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#ae81ff>1001</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>教学部</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#ae81ff>1003</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>咨询部</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#ae81ff>1004</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>财务部</span> <span style=color:#f92672>|</span> <span style=color:#75715e>#原来did是1002
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>+------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> emp;
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> eid <span style=color:#f92672>|</span> ename <span style=color:#f92672>|</span> deptid <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>1</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>张三</span>  <span style=color:#f92672>|</span>   <span style=color:#ae81ff>1001</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>2</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>李四</span>  <span style=color:#f92672>|</span>   <span style=color:#ae81ff>1001</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>3</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>王五</span>  <span style=color:#f92672>|</span>   <span style=color:#66d9ef>NULL</span> <span style=color:#f92672>|</span> <span style=color:#75715e>#原来deptid是1002，因为部门表1002被修改了，1002没有对应的了，就设置为null
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>+-----+-------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e>#删除主表的记录成功，主表的1001行被删除了，从表相应的记录也被删除了
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>delete</span> <span style=color:#66d9ef>from</span> dept <span style=color:#66d9ef>where</span> did<span style=color:#f92672>=</span><span style=color:#ae81ff>1001</span>;
</span></span><span style=display:flex><span>Query OK, <span style=color:#ae81ff>1</span> row <span style=color:#a6e22e>affected</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> dept;
</span></span><span style=display:flex><span><span style=color:#f92672>+------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> did  <span style=color:#f92672>|</span> dname  <span style=color:#f92672>|</span> <span style=color:#75715e>#部门表中1001部门被删除
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>+------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#ae81ff>1003</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>咨询部</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#ae81ff>1004</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>财务部</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> emp;
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> eid <span style=color:#f92672>|</span> ename <span style=color:#f92672>|</span> deptid <span style=color:#f92672>|</span><span style=color:#75715e>#原来1001部门的员工也被删除了
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>+-----+-------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>3</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>王五</span>  <span style=color:#f92672>|</span>   <span style=color:#66d9ef>NULL</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span> row <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><p>（3）演示：on update cascade on delete cascade</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>dept</span>(
</span></span><span style=display:flex><span>	did <span style=color:#66d9ef>int</span> <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>,		<span style=color:#75715e>#部门编号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    dname <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>50</span>)			<span style=color:#75715e>#部门名称
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>emp</span>(
</span></span><span style=display:flex><span>	eid <span style=color:#66d9ef>int</span> <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>,  <span style=color:#75715e>#员工编号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    ename <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>5</span>),     <span style=color:#75715e>#员工姓名
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    deptid <span style=color:#66d9ef>int</span>,				<span style=color:#75715e>#员工所在的部门
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>foreign</span> <span style=color:#66d9ef>key</span> (deptid) <span style=color:#66d9ef>references</span> <span style=color:#a6e22e>dept</span>(did)  <span style=color:#66d9ef>on</span> <span style=color:#66d9ef>update</span> <span style=color:#66d9ef>cascade</span> <span style=color:#66d9ef>on</span> <span style=color:#66d9ef>delete</span> <span style=color:#66d9ef>cascade</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#把修改操作设置为级联修改等级，把删除操作也设置为级联删除等级
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> dept <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>1001</span>,<span style=color:#e6db74>&#39;教学部&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> dept <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>1002</span>, <span style=color:#e6db74>&#39;财务部&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> dept <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>1003</span>, <span style=color:#e6db74>&#39;咨询部&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> emp <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>1</span>,<span style=color:#e6db74>&#39;张三&#39;</span>,<span style=color:#ae81ff>1001</span>); <span style=color:#75715e>#在添加这条记录时，要求部门表有1001部门
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> emp <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>2</span>,<span style=color:#e6db74>&#39;李四&#39;</span>,<span style=color:#ae81ff>1001</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> emp <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>3</span>,<span style=color:#e6db74>&#39;王五&#39;</span>,<span style=color:#ae81ff>1002</span>);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> dept;
</span></span><span style=display:flex><span><span style=color:#f92672>+------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> did  <span style=color:#f92672>|</span> dname  <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#ae81ff>1001</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>教学部</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#ae81ff>1002</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>财务部</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#ae81ff>1003</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>咨询部</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> emp;
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> eid <span style=color:#f92672>|</span> ename <span style=color:#f92672>|</span> deptid <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>1</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>张三</span>  <span style=color:#f92672>|</span>   <span style=color:#ae81ff>1001</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>2</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>李四</span>  <span style=color:#f92672>|</span>   <span style=color:#ae81ff>1001</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>3</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>王五</span>  <span style=color:#f92672>|</span>   <span style=color:#ae81ff>1002</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e>#修改主表，从表对应的字段自动修改
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>update</span> dept <span style=color:#66d9ef>set</span> did <span style=color:#f92672>=</span> <span style=color:#ae81ff>1004</span> <span style=color:#66d9ef>where</span> did <span style=color:#f92672>=</span> <span style=color:#ae81ff>1002</span>;
</span></span><span style=display:flex><span>Query OK, <span style=color:#ae81ff>1</span> row <span style=color:#a6e22e>affected</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span><span style=display:flex><span>Rows matched: <span style=color:#ae81ff>1</span>  Changed: <span style=color:#ae81ff>1</span>  Warnings: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> dept;
</span></span><span style=display:flex><span><span style=color:#f92672>+------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> did  <span style=color:#f92672>|</span> dname  <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#ae81ff>1001</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>教学部</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#ae81ff>1003</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>咨询部</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#ae81ff>1004</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>财务部</span> <span style=color:#f92672>|</span> <span style=color:#75715e>#部门1002修改为1004
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>+------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> emp;
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> eid <span style=color:#f92672>|</span> ename <span style=color:#f92672>|</span> deptid <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>1</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>张三</span>  <span style=color:#f92672>|</span>   <span style=color:#ae81ff>1001</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>2</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>李四</span>  <span style=color:#f92672>|</span>   <span style=color:#ae81ff>1001</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>3</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>王五</span>  <span style=color:#f92672>|</span>   <span style=color:#ae81ff>1004</span> <span style=color:#f92672>|</span> <span style=color:#75715e>#级联修改
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>+-----+-------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e>#删除主表的记录成功，主表的1001行被删除了，从表相应的记录也被删除了
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>delete</span> <span style=color:#66d9ef>from</span> dept <span style=color:#66d9ef>where</span> did<span style=color:#f92672>=</span><span style=color:#ae81ff>1001</span>;
</span></span><span style=display:flex><span>Query OK, <span style=color:#ae81ff>1</span> row <span style=color:#a6e22e>affected</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> dept;
</span></span><span style=display:flex><span><span style=color:#f92672>+------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> did  <span style=color:#f92672>|</span> dname  <span style=color:#f92672>|</span> <span style=color:#75715e>#1001部门被删除了
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>+------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#ae81ff>1003</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>咨询部</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#ae81ff>1004</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>财务部</span> <span style=color:#f92672>|</span> 
</span></span><span style=display:flex><span><span style=color:#f92672>+------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> emp;
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> eid <span style=color:#f92672>|</span> ename <span style=color:#f92672>|</span> deptid <span style=color:#f92672>|</span>  <span style=color:#75715e>#1001部门的员工也被删除了
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>+-----+-------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>3</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>王五</span>  <span style=color:#f92672>|</span>   <span style=color:#ae81ff>1004</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span> row <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><h3 id=68-删除外键约束>6.8 删除外键约束<a hidden class=anchor aria-hidden=true href=#68-删除外键约束>#</a></h3><p>流程如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>(<span style=color:#ae81ff>1</span>)<span style=color:#960050;background-color:#1e0010>第一步先查看约束名和删除外键约束</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> information_schema.table_constraints <span style=color:#66d9ef>WHERE</span> table_name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;表名称&#39;</span>;<span style=color:#75715e>#查看某个表的约束名
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>ALTER</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#960050;background-color:#1e0010>从表名</span> <span style=color:#66d9ef>DROP</span> <span style=color:#66d9ef>FOREIGN</span> <span style=color:#66d9ef>KEY</span> <span style=color:#960050;background-color:#1e0010>外键约束名</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>（</span><span style=color:#ae81ff>2</span><span style=color:#960050;background-color:#1e0010>）第二步查看索引名和删除索引。（注意，只能手动删除）</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>SHOW</span> <span style=color:#66d9ef>INDEX</span> <span style=color:#66d9ef>FROM</span> <span style=color:#960050;background-color:#1e0010>表名称</span>; <span style=color:#75715e>#查看某个表的索引名
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>ALTER</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#960050;background-color:#1e0010>从表名</span> <span style=color:#66d9ef>DROP</span> <span style=color:#66d9ef>INDEX</span> <span style=color:#960050;background-color:#1e0010>索引名</span>;
</span></span></code></pre></div><p>举例：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> information_schema.table_constraints <span style=color:#66d9ef>WHERE</span> table_name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;emp&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>alter</span> <span style=color:#66d9ef>table</span> emp <span style=color:#66d9ef>drop</span> <span style=color:#66d9ef>foreign</span> <span style=color:#66d9ef>key</span> emp_ibfk_1;
</span></span><span style=display:flex><span>Query OK, <span style=color:#ae81ff>0</span> rows <span style=color:#a6e22e>affected</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>02</span> sec)
</span></span><span style=display:flex><span>Records: <span style=color:#ae81ff>0</span>  Duplicates: <span style=color:#ae81ff>0</span>  Warnings: <span style=color:#ae81ff>0</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>show</span> <span style=color:#66d9ef>index</span> <span style=color:#66d9ef>from</span> emp;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>alter</span> <span style=color:#66d9ef>table</span> emp <span style=color:#66d9ef>drop</span> <span style=color:#66d9ef>index</span> deptid;
</span></span><span style=display:flex><span>Query OK, <span style=color:#ae81ff>0</span> rows <span style=color:#a6e22e>affected</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>01</span> sec)
</span></span><span style=display:flex><span>Records: <span style=color:#ae81ff>0</span>  Duplicates: <span style=color:#ae81ff>0</span>  Warnings: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span>  <span style=color:#66d9ef>show</span> <span style=color:#66d9ef>index</span> <span style=color:#66d9ef>from</span> emp;
</span></span></code></pre></div><h3 id=69-开发场景>6.9 开发场景<a hidden class=anchor aria-hidden=true href=#69-开发场景>#</a></h3><p><strong>问题1：如果两个表之间有关系（一对一、一对多），比如：员工表和部门表（一对多），它们之间是否一定要建外键约束？</strong></p><p>答：不是的</p><p><strong>问题2：建和不建外键约束有什么区别？</strong></p><p>答：建外键约束，你的操作（创建表、删除表、添加、修改、删除）会受到限制，从语法层面受到限制。例如：在员工表中不可能添加一个员工信息，它的部门的值在部门表中找不到。</p><p>不建外键约束，你的操作（创建表、删除表、添加、修改、删除）不受限制，要保证数据的<code>引用完整性</code>，只能依<code>靠程序员的自觉</code>，或者是<code>在Java程序中进行限定</code>。例如：在员工表中，可以添加一个员工的信息，它的部门指定为一个完全不存在的部门。</p><p><strong>问题3：那么建和不建外键约束和查询有没有关系？</strong></p><p>答：没有</p><blockquote><p>在 MySQL 里，外键约束是有成本的，需要消耗系统资源。对于大并发的 SQL 操作，有可能会不适合。比如大型网站的中央数据库，可能会<code>因为外键约束的系统开销而变得非常慢</code>。所以， MySQL 允许你不使用系统自带的外键约束，在<code>应用层面</code>完成检查数据一致性的逻辑。也就是说，即使你不用外键约束，也要想办法通过应用层面的附加逻辑，来实现外键约束的功能，确保数据的一致性。</p></blockquote><h3 id=610-阿里开发规范>6.10 阿里开发规范<a hidden class=anchor aria-hidden=true href=#610-阿里开发规范>#</a></h3><p>【<code>强制</code>】不得使用外键与级联，一切外键概念必须在应用层解决。</p><p>说明：（概念解释）学生表中的 student_id 是主键，那么成绩表中的 student_id 则为外键。如果更新学生表中的 student_id，同时触发成绩表中的 student_id 更新，即为级联更新。外键与级联更新适用于<code>单机低并发</code>，不适合<code>分布式</code>、<code>高并发集群</code>；级联更新是强阻塞，存在数据库<code>更新风暴</code>的风险；外键影响数据库的<code>插入速度</code>。</p><h2 id=7-check-约束>7. CHECK 约束<a hidden class=anchor aria-hidden=true href=#7-check-约束>#</a></h2><h3 id=71-作用>7.1 作用<a hidden class=anchor aria-hidden=true href=#71-作用>#</a></h3><p>检查某个字段的值是否符号xx要求，一般指的是值的范围</p><h3 id=2关键字>2、关键字<a hidden class=anchor aria-hidden=true href=#2关键字>#</a></h3><p>CHECK</p><h3 id=3说明mysql-57-不支持>3、说明：MySQL 5.7 不支持<a hidden class=anchor aria-hidden=true href=#3说明mysql-57-不支持>#</a></h3><p>MySQL5.7 可以使用check约束，但check约束对数据验证没有任何作用。添加数据时，没有任何错误或警告</p><p>但是<strong>MySQL 8.0中可以使用check约束了</strong>。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>employee</span>(
</span></span><span style=display:flex><span>	eid <span style=color:#66d9ef>int</span> <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>,
</span></span><span style=display:flex><span>    ename <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>5</span>),
</span></span><span style=display:flex><span>    gender <span style=color:#66d9ef>char</span> <span style=color:#66d9ef>check</span> (<span style=color:#e6db74>&#39;男&#39;</span> <span style=color:#66d9ef>or</span> <span style=color:#e6db74>&#39;女&#39;</span>)
</span></span><span style=display:flex><span>);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> employee <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>1</span>,<span style=color:#e6db74>&#39;张三&#39;</span>,<span style=color:#e6db74>&#39;妖&#39;</span>);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> employee;
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> eid <span style=color:#f92672>|</span> ename <span style=color:#f92672>|</span> gender <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>1</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>张三</span>   <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>妖</span>     <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+--------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span> row <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><ul><li>再举例</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#a6e22e>temp</span>(
</span></span><span style=display:flex><span>id <span style=color:#66d9ef>INT</span> <span style=color:#66d9ef>AUTO_INCREMENT</span>,
</span></span><span style=display:flex><span>NAME <span style=color:#66d9ef>VARCHAR</span>(<span style=color:#ae81ff>20</span>),
</span></span><span style=display:flex><span>age <span style=color:#66d9ef>INT</span> <span style=color:#66d9ef>CHECK</span>(age <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>20</span>),
</span></span><span style=display:flex><span><span style=color:#66d9ef>PRIMARY</span> <span style=color:#66d9ef>KEY</span>(id)
</span></span><span style=display:flex><span>);
</span></span></code></pre></div><ul><li>再举例</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>age <span style=color:#66d9ef>tinyint</span> <span style=color:#66d9ef>check</span>(age <span style=color:#f92672>&gt;</span><span style=color:#ae81ff>20</span>) <span style=color:#960050;background-color:#1e0010>或</span> sex <span style=color:#66d9ef>char</span>(<span style=color:#ae81ff>2</span>) <span style=color:#66d9ef>check</span>(sex <span style=color:#66d9ef>in</span>(<span style=color:#960050;background-color:#1e0010>‘男’</span>,<span style=color:#960050;background-color:#1e0010>’女’</span>))
</span></span></code></pre></div><ul><li>再举例</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>CHECK</span>(height<span style=color:#f92672>&gt;=</span><span style=color:#ae81ff>0</span> <span style=color:#66d9ef>AND</span> height<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>3</span>)
</span></span></code></pre></div><h2 id=8-default约束>8. DEFAULT约束<a hidden class=anchor aria-hidden=true href=#8-default约束>#</a></h2><h3 id=81-作用>8.1 作用<a hidden class=anchor aria-hidden=true href=#81-作用>#</a></h3><p>给某个字段/某列指定默认值，一旦设置默认值，在插入数据时，如果此字段没有显式赋值，则赋值为默认值。</p><h3 id=82-关键字>8.2 关键字<a hidden class=anchor aria-hidden=true href=#82-关键字>#</a></h3><p>DEFAULT</p><h3 id=83-如何给字段加默认值>8.3 如何给字段加默认值<a hidden class=anchor aria-hidden=true href=#83-如何给字段加默认值>#</a></h3><p>（1）建表时</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#960050;background-color:#1e0010>表名称</span>(
</span></span><span style=display:flex><span>	<span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span>  <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>,
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span>  <span style=color:#66d9ef>unique</span> <span style=color:#66d9ef>key</span> <span style=color:#66d9ef>not</span> <span style=color:#66d9ef>null</span>,  
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span>  <span style=color:#66d9ef>unique</span> <span style=color:#66d9ef>key</span>,
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span>  <span style=color:#66d9ef>not</span> <span style=color:#66d9ef>null</span> <span style=color:#66d9ef>default</span> <span style=color:#960050;background-color:#1e0010>默认值</span>, 
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#960050;background-color:#1e0010>表名称</span>(
</span></span><span style=display:flex><span>	<span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span> <span style=color:#66d9ef>default</span> <span style=color:#960050;background-color:#1e0010>默认值</span> ,
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span> <span style=color:#66d9ef>not</span> <span style=color:#66d9ef>null</span> <span style=color:#66d9ef>default</span> <span style=color:#960050;background-color:#1e0010>默认值</span>,  
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>字段名</span>  <span style=color:#960050;background-color:#1e0010>数据类型</span> <span style=color:#66d9ef>not</span> <span style=color:#66d9ef>null</span> <span style=color:#66d9ef>default</span> <span style=color:#960050;background-color:#1e0010>默认值</span>,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>(<span style=color:#960050;background-color:#1e0010>字段名</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>unique</span> <span style=color:#66d9ef>key</span>(<span style=color:#960050;background-color:#1e0010>字段名</span>)
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>说明：默认值约束一般不在唯一键和主键列上加</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>employee</span>(
</span></span><span style=display:flex><span>	eid <span style=color:#66d9ef>int</span> <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>,
</span></span><span style=display:flex><span>    ename <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>20</span>) <span style=color:#66d9ef>not</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>    gender <span style=color:#66d9ef>char</span> <span style=color:#66d9ef>default</span> <span style=color:#e6db74>&#39;男&#39;</span>,
</span></span><span style=display:flex><span>    tel <span style=color:#66d9ef>char</span>(<span style=color:#ae81ff>11</span>) <span style=color:#66d9ef>not</span> <span style=color:#66d9ef>null</span> <span style=color:#66d9ef>default</span> <span style=color:#e6db74>&#39;&#39;</span> <span style=color:#75715e>#默认是空字符串
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>desc</span> employee;
</span></span><span style=display:flex><span><span style=color:#f92672>+--------+-------------+------+-----+---------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> Field  <span style=color:#f92672>|</span> Type        <span style=color:#f92672>|</span> <span style=color:#66d9ef>Null</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>Key</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>Default</span> <span style=color:#f92672>|</span> Extra <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+--------+-------------+------+-----+---------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> eid    <span style=color:#f92672>|</span> <span style=color:#66d9ef>int</span>(<span style=color:#ae81ff>11</span>)     <span style=color:#f92672>|</span> NO   <span style=color:#f92672>|</span> PRI <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>    <span style=color:#f92672>|</span>       <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> ename  <span style=color:#f92672>|</span> <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>20</span>) <span style=color:#f92672>|</span> NO   <span style=color:#f92672>|</span>     <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>    <span style=color:#f92672>|</span>       <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> gender <span style=color:#f92672>|</span> <span style=color:#66d9ef>char</span>(<span style=color:#ae81ff>1</span>)     <span style=color:#f92672>|</span> YES  <span style=color:#f92672>|</span>     <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>男</span>      <span style=color:#f92672>|</span>       <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> tel    <span style=color:#f92672>|</span> <span style=color:#66d9ef>char</span>(<span style=color:#ae81ff>11</span>)    <span style=color:#f92672>|</span> NO   <span style=color:#f92672>|</span>     <span style=color:#f92672>|</span>         <span style=color:#f92672>|</span>       <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+--------+-------------+------+-----+---------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>4</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> employee <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>1</span>,<span style=color:#e6db74>&#39;汪飞&#39;</span>,<span style=color:#e6db74>&#39;男&#39;</span>,<span style=color:#e6db74>&#39;13700102535&#39;</span>); <span style=color:#75715e>#成功
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> employee;
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+--------+-------------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> eid <span style=color:#f92672>|</span> ename <span style=color:#f92672>|</span> gender <span style=color:#f92672>|</span> tel         <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+--------+-------------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>1</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>汪飞</span>  <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>男</span>     <span style=color:#f92672>|</span> <span style=color:#ae81ff>13700102535</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+--------+-------------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span> row <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> <span style=color:#a6e22e>employee</span>(eid,ename) <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>2</span>,<span style=color:#e6db74>&#39;天琪&#39;</span>); <span style=color:#75715e>#成功
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> employee;
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+--------+-------------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> eid <span style=color:#f92672>|</span> ename <span style=color:#f92672>|</span> gender <span style=color:#f92672>|</span> tel         <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+--------+-------------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>1</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>汪飞</span>  <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>男</span>     <span style=color:#f92672>|</span> <span style=color:#ae81ff>13700102535</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>2</span> <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>天琪</span>  <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>男</span>     <span style=color:#f92672>|</span>             <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-----+-------+--------+-------------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> <span style=color:#a6e22e>employee</span>(eid,ename) <span style=color:#66d9ef>values</span>(<span style=color:#ae81ff>3</span>,<span style=color:#e6db74>&#39;二虎&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#75715e>#ERROR 1062 (23000): Duplicate entry &#39;&#39; for key &#39;tel&#39;  
</span></span></span><span style=display:flex><span><span style=color:#75715e>#如果tel有唯一性约束的话会报错，如果tel没有唯一性约束，可以添加成功
</span></span></span></code></pre></div><p>再举例：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#a6e22e>myemp</span>(
</span></span><span style=display:flex><span>id <span style=color:#66d9ef>INT</span> <span style=color:#66d9ef>AUTO_INCREMENT</span> <span style=color:#66d9ef>PRIMARY</span> <span style=color:#66d9ef>KEY</span>,
</span></span><span style=display:flex><span>NAME <span style=color:#66d9ef>VARCHAR</span>(<span style=color:#ae81ff>15</span>),
</span></span><span style=display:flex><span>salary <span style=color:#66d9ef>DOUBLE</span>(<span style=color:#ae81ff>10</span>,<span style=color:#ae81ff>2</span>) <span style=color:#66d9ef>DEFAULT</span> <span style=color:#ae81ff>2000</span>
</span></span><span style=display:flex><span>);
</span></span></code></pre></div><p>（2）建表后</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>alter</span> <span style=color:#66d9ef>table</span> <span style=color:#960050;background-color:#1e0010>表名称</span> modify <span style=color:#960050;background-color:#1e0010>字段名</span> <span style=color:#960050;background-color:#1e0010>数据类型</span> <span style=color:#66d9ef>default</span> <span style=color:#960050;background-color:#1e0010>默认值</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#如果这个字段原来有非空约束，你还保留非空约束，那么在加默认值约束时，还得保留非空约束，否则非空约束就被删除了
</span></span></span><span style=display:flex><span><span style=color:#75715e>#同理，在给某个字段加非空约束也一样，如果这个字段原来有默认值约束，你想保留，也要在modify语句中保留默认值约束，否则就删除了
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>alter</span> <span style=color:#66d9ef>table</span> <span style=color:#960050;background-color:#1e0010>表名称</span> modify <span style=color:#960050;background-color:#1e0010>字段名</span> <span style=color:#960050;background-color:#1e0010>数据类型</span> <span style=color:#66d9ef>default</span> <span style=color:#960050;background-color:#1e0010>默认值</span> <span style=color:#66d9ef>not</span> <span style=color:#66d9ef>null</span>;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> <span style=color:#a6e22e>employee</span>(
</span></span><span style=display:flex><span>	eid <span style=color:#66d9ef>int</span> <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span>,
</span></span><span style=display:flex><span>    ename <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>20</span>),
</span></span><span style=display:flex><span>    gender <span style=color:#66d9ef>char</span>,
</span></span><span style=display:flex><span>    tel <span style=color:#66d9ef>char</span>(<span style=color:#ae81ff>11</span>) <span style=color:#66d9ef>not</span> <span style=color:#66d9ef>null</span>
</span></span><span style=display:flex><span>);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>desc</span> employee;
</span></span><span style=display:flex><span><span style=color:#f92672>+--------+-------------+------+-----+---------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> Field  <span style=color:#f92672>|</span> Type        <span style=color:#f92672>|</span> <span style=color:#66d9ef>Null</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>Key</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>Default</span> <span style=color:#f92672>|</span> Extra <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+--------+-------------+------+-----+---------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> eid    <span style=color:#f92672>|</span> <span style=color:#66d9ef>int</span>(<span style=color:#ae81ff>11</span>)     <span style=color:#f92672>|</span> NO   <span style=color:#f92672>|</span> PRI <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>    <span style=color:#f92672>|</span>       <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> ename  <span style=color:#f92672>|</span> <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>20</span>) <span style=color:#f92672>|</span> YES  <span style=color:#f92672>|</span>     <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>    <span style=color:#f92672>|</span>       <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> gender <span style=color:#f92672>|</span> <span style=color:#66d9ef>char</span>(<span style=color:#ae81ff>1</span>)     <span style=color:#f92672>|</span> YES  <span style=color:#f92672>|</span>     <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>    <span style=color:#f92672>|</span>       <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> tel    <span style=color:#f92672>|</span> <span style=color:#66d9ef>char</span>(<span style=color:#ae81ff>11</span>)    <span style=color:#f92672>|</span> NO   <span style=color:#f92672>|</span>     <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>    <span style=color:#f92672>|</span>       <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+--------+-------------+------+-----+---------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>4</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>alter</span> <span style=color:#66d9ef>table</span> employee modify gender <span style=color:#66d9ef>char</span> <span style=color:#66d9ef>default</span> <span style=color:#e6db74>&#39;男&#39;</span>;  <span style=color:#75715e>#给gender字段增加默认值约束
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>alter</span> <span style=color:#66d9ef>table</span> employee modify tel <span style=color:#66d9ef>char</span>(<span style=color:#ae81ff>11</span>) <span style=color:#66d9ef>default</span> <span style=color:#e6db74>&#39;&#39;</span>; <span style=color:#75715e>#给tel字段增加默认值约束
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>desc</span> employee;
</span></span><span style=display:flex><span><span style=color:#f92672>+--------+-------------+------+-----+---------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> Field  <span style=color:#f92672>|</span> Type        <span style=color:#f92672>|</span> <span style=color:#66d9ef>Null</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>Key</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>Default</span> <span style=color:#f92672>|</span> Extra <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+--------+-------------+------+-----+---------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> eid    <span style=color:#f92672>|</span> <span style=color:#66d9ef>int</span>(<span style=color:#ae81ff>11</span>)     <span style=color:#f92672>|</span> NO   <span style=color:#f92672>|</span> PRI <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>    <span style=color:#f92672>|</span>       <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> ename  <span style=color:#f92672>|</span> <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>20</span>) <span style=color:#f92672>|</span> YES  <span style=color:#f92672>|</span>     <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>    <span style=color:#f92672>|</span>       <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> gender <span style=color:#f92672>|</span> <span style=color:#66d9ef>char</span>(<span style=color:#ae81ff>1</span>)     <span style=color:#f92672>|</span> YES  <span style=color:#f92672>|</span>     <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>男</span>      <span style=color:#f92672>|</span>       <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> tel    <span style=color:#f92672>|</span> <span style=color:#66d9ef>char</span>(<span style=color:#ae81ff>11</span>)    <span style=color:#f92672>|</span> YES  <span style=color:#f92672>|</span>     <span style=color:#f92672>|</span>         <span style=color:#f92672>|</span>       <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+--------+-------------+------+-----+---------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>4</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>alter</span> <span style=color:#66d9ef>table</span> employee modify tel <span style=color:#66d9ef>char</span>(<span style=color:#ae81ff>11</span>) <span style=color:#66d9ef>default</span> <span style=color:#e6db74>&#39;&#39;</span>  <span style=color:#66d9ef>not</span> <span style=color:#66d9ef>null</span>;<span style=color:#75715e>#给tel字段增加默认值约束，并保留非空约束
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>desc</span> employee;
</span></span><span style=display:flex><span><span style=color:#f92672>+--------+-------------+------+-----+---------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> Field  <span style=color:#f92672>|</span> Type        <span style=color:#f92672>|</span> <span style=color:#66d9ef>Null</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>Key</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>Default</span> <span style=color:#f92672>|</span> Extra <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+--------+-------------+------+-----+---------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> eid    <span style=color:#f92672>|</span> <span style=color:#66d9ef>int</span>(<span style=color:#ae81ff>11</span>)     <span style=color:#f92672>|</span> NO   <span style=color:#f92672>|</span> PRI <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>    <span style=color:#f92672>|</span>       <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> ename  <span style=color:#f92672>|</span> <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>20</span>) <span style=color:#f92672>|</span> YES  <span style=color:#f92672>|</span>     <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>    <span style=color:#f92672>|</span>       <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> gender <span style=color:#f92672>|</span> <span style=color:#66d9ef>char</span>(<span style=color:#ae81ff>1</span>)     <span style=color:#f92672>|</span> YES  <span style=color:#f92672>|</span>     <span style=color:#f92672>|</span> <span style=color:#960050;background-color:#1e0010>男</span>      <span style=color:#f92672>|</span>       <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> tel    <span style=color:#f92672>|</span> <span style=color:#66d9ef>char</span>(<span style=color:#ae81ff>11</span>)    <span style=color:#f92672>|</span> NO   <span style=color:#f92672>|</span>     <span style=color:#f92672>|</span>         <span style=color:#f92672>|</span>       <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+--------+-------------+------+-----+---------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>4</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><h3 id=84-如何删除默认值约束>8.4 如何删除默认值约束<a hidden class=anchor aria-hidden=true href=#84-如何删除默认值约束>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>alter</span> <span style=color:#66d9ef>table</span> <span style=color:#960050;background-color:#1e0010>表名称</span> modify <span style=color:#960050;background-color:#1e0010>字段名</span> <span style=color:#960050;background-color:#1e0010>数据类型</span> ;<span style=color:#75715e>#删除默认值约束，也不保留非空约束
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>alter</span> <span style=color:#66d9ef>table</span> <span style=color:#960050;background-color:#1e0010>表名称</span> modify <span style=color:#960050;background-color:#1e0010>字段名</span> <span style=color:#960050;background-color:#1e0010>数据类型</span>  <span style=color:#66d9ef>not</span> <span style=color:#66d9ef>null</span>; <span style=color:#75715e>#删除默认值约束，保留非空约束
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>alter</span> <span style=color:#66d9ef>table</span> employee modify gender <span style=color:#66d9ef>char</span>; <span style=color:#75715e>#删除gender字段默认值约束，如果有非空约束，也一并删除
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>alter</span> <span style=color:#66d9ef>table</span> employee modify tel <span style=color:#66d9ef>char</span>(<span style=color:#ae81ff>11</span>)  <span style=color:#66d9ef>not</span> <span style=color:#66d9ef>null</span>;<span style=color:#75715e>#删除tel字段默认值约束，保留非空约束
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>desc</span> employee;
</span></span><span style=display:flex><span><span style=color:#f92672>+--------+-------------+------+-----+---------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> Field  <span style=color:#f92672>|</span> Type        <span style=color:#f92672>|</span> <span style=color:#66d9ef>Null</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>Key</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>Default</span> <span style=color:#f92672>|</span> Extra <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+--------+-------------+------+-----+---------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> eid    <span style=color:#f92672>|</span> <span style=color:#66d9ef>int</span>(<span style=color:#ae81ff>11</span>)     <span style=color:#f92672>|</span> NO   <span style=color:#f92672>|</span> PRI <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>    <span style=color:#f92672>|</span>       <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> ename  <span style=color:#f92672>|</span> <span style=color:#66d9ef>varchar</span>(<span style=color:#ae81ff>20</span>) <span style=color:#f92672>|</span> YES  <span style=color:#f92672>|</span>     <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>    <span style=color:#f92672>|</span>       <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> gender <span style=color:#f92672>|</span> <span style=color:#66d9ef>char</span>(<span style=color:#ae81ff>1</span>)     <span style=color:#f92672>|</span> YES  <span style=color:#f92672>|</span>     <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>    <span style=color:#f92672>|</span>       <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> tel    <span style=color:#f92672>|</span> <span style=color:#66d9ef>char</span>(<span style=color:#ae81ff>11</span>)    <span style=color:#f92672>|</span> NO   <span style=color:#f92672>|</span>     <span style=color:#f92672>|</span> <span style=color:#66d9ef>NULL</span>    <span style=color:#f92672>|</span>       <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+--------+-------------+------+-----+---------+-------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>4</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>00</span> sec)
</span></span></code></pre></div><h2 id=9-面试>9. 面试<a hidden class=anchor aria-hidden=true href=#9-面试>#</a></h2><p><strong>面试1、为什么建表时，加 not null default &rsquo;&rsquo; 或 default 0</strong></p><p>答：不想让表中出现null值。</p><p><strong>面试2、为什么不想要 null 的值</strong></p><p>答:（1）不好比较。null是一种特殊值，比较时只能用专门的is null 和 is not null来比较。碰到运算符，通常返回null。</p><p>​ （2）效率不高。影响提高索引效果。因此，我们往往在建表时 not null default &rsquo;&rsquo; 或 default 0</p><p><strong>面试3、带AUTO_INCREMENT约束的字段值是从1开始的吗？</strong>
在MySQL中，默认AUTO_INCREMENT的初始值是1，每新增一条记录，字段值自动加1。设置自增属性（AUTO_INCREMENT）的时候，还可以指定第一条插入记录的自增字段的值，这样新插入的记录的自增字段值从初始值开始递增，如在表中插入第一条记录，同时指定id值为5，则以后插入的记录的id值就会从6开始往上增加。添加主键约束时，往往需要设置字段自动增加属性。</p><p><strong>面试4、并不是每个表都可以任意选择存储引擎？</strong>
外键约束（FOREIGN KEY）不能跨引擎使用。</p><p>MySQL支持多种存储引擎，每一个表都可以指定一个不同的存储引擎，需要注意的是：外键约束是用来保证数据的参照完整性的，如果表之间需要关联外键，却指定了不同的存储引擎，那么这些表之间是不能创建外键约束的。所以说，存储引擎的选择也不完全是随意的。</p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://jiayi26.github.io/posts/%E7%AC%AC12%E7%AB%A0_mysql%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E7%B2%BE%E8%AE%B2/><span class=title>« Prev Page</span><br><span></span></a>
<a class=next href=https://jiayi26.github.io/posts/%E7%AC%AC14%E7%AB%A0_%E8%A7%86%E5%9B%BE/><span class=title>Next Page »</span><br><span></span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share  on twitter" href="https://twitter.com/intent/tweet/?text=&url=https%3a%2f%2fjiayi26.github.io%2fposts%2f%25E7%25AC%25AC13%25E7%25AB%25A0_%25E7%25BA%25A6%25E6%259D%259F%2f&hashtags="><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share  on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fjiayi26.github.io%2fposts%2f%25E7%25AC%25AC13%25E7%25AB%25A0_%25E7%25BA%25A6%25E6%259D%259F%2f&title=&summary=&source=https%3a%2f%2fjiayi26.github.io%2fposts%2f%25E7%25AC%25AC13%25E7%25AB%25A0_%25E7%25BA%25A6%25E6%259D%259F%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share  on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fjiayi26.github.io%2fposts%2f%25E7%25AC%25AC13%25E7%25AB%25A0_%25E7%25BA%25A6%25E6%259D%259F%2f&title="><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share  on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fjiayi26.github.io%2fposts%2f%25E7%25AC%25AC13%25E7%25AB%25A0_%25E7%25BA%25A6%25E6%259D%259F%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share  on whatsapp" href="https://api.whatsapp.com/send?text=%20-%20https%3a%2f%2fjiayi26.github.io%2fposts%2f%25E7%25AC%25AC13%25E7%25AB%25A0_%25E7%25BA%25A6%25E6%259D%259F%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share  on telegram" href="https://telegram.me/share/url?text=&url=https%3a%2f%2fjiayi26.github.io%2fposts%2f%25E7%25AC%25AC13%25E7%25AB%25A0_%25E7%25BA%25A6%25E6%259D%259F%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://jiayi26.github.io/>JIAYI's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>