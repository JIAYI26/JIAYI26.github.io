<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>JIAYI's Blog</title><meta name=keywords content><meta name=description content="第06章_多表查询 讲师：尚硅谷-宋红康（江湖人称：康师傅）
官网：http://www.atguigu.com
 多表查询，也称为关联查询，指两个或更多个表一起完成查询操作。
前提条件：这些一起查询的表之间是有关系的（一对一、一对多），它们之间一定是有关联字段，这个关联字段可能建立了外键，也可能没有建立外键。比如：员工表和部门表，这两个表依靠“部门编号”进行关联。
1. 一个案例引发的多表连接 1.1 案例说明 从多个表中获取数据：
#案例：查询员工的姓名及其部门名称 SELECT last_name, department_name FROM employees, departments; 查询结果：
+-----------+----------------------+ | last_name | department_name | +-----------+----------------------+ | King | Administration | | King | Marketing | | King | Purchasing | | King | Human Resources | | King | Shipping | | King | IT | | King | Public Relations | | King | Sales | | King | Executive | | King | Finance | | King | Accounting | | King | Treasury | ."><meta name=author content="Me"><link rel=canonical href=https://jiayi26.github.io/posts/%E7%AC%AC06%E7%AB%A0_%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2/><link crossorigin=anonymous href=/assets/css/stylesheet.min.b4e19c453811e60acfec1f00c15ac2be1c53f6ab90187e684358ce7faaf48bab.css integrity="sha256-tOGcRTgR5grP7B8AwVrCvhxT9quQGH5oQ1jOf6r0i6s=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.2840b7fccd34145847db71a290569594bdbdb00047097f75d6495d162f5d7dff.js integrity="sha256-KEC3/M00FFhH23GikFaVlL29sABHCX911kldFi9dff8=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://xx.mzqcgc.cn/FrbOmxJvq96XDbDPXbiBWM0LU9e3><link rel=icon type=image/png sizes=16x16 href=https://xx.mzqcgc.cn/FrbOmxJvq96XDbDPXbiBWM0LU9e3><link rel=icon type=image/png sizes=32x32 href=https://xx.mzqcgc.cn/FrbOmxJvq96XDbDPXbiBWM0LU9e3><link rel=apple-touch-icon href=https://xx.mzqcgc.cn/FrbOmxJvq96XDbDPXbiBWM0LU9e3><link rel=mask-icon href=https://jiayi26.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,o,i,a,t,n,s){e.GoogleAnalyticsObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=o.createElement(i),s=o.getElementsByTagName(i)[0],n.async=1,n.src=a,s.parentNode.insertBefore(n,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content><meta property="og:description" content="第06章_多表查询 讲师：尚硅谷-宋红康（江湖人称：康师傅）
官网：http://www.atguigu.com
 多表查询，也称为关联查询，指两个或更多个表一起完成查询操作。
前提条件：这些一起查询的表之间是有关系的（一对一、一对多），它们之间一定是有关联字段，这个关联字段可能建立了外键，也可能没有建立外键。比如：员工表和部门表，这两个表依靠“部门编号”进行关联。
1. 一个案例引发的多表连接 1.1 案例说明 从多个表中获取数据：
#案例：查询员工的姓名及其部门名称 SELECT last_name, department_name FROM employees, departments; 查询结果：
+-----------+----------------------+ | last_name | department_name | +-----------+----------------------+ | King | Administration | | King | Marketing | | King | Purchasing | | King | Human Resources | | King | Shipping | | King | IT | | King | Public Relations | | King | Sales | | King | Executive | | King | Finance | | King | Accounting | | King | Treasury | ."><meta property="og:type" content="article"><meta property="og:url" content="https://jiayi26.github.io/posts/%E7%AC%AC06%E7%AB%A0_%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2/"><meta property="article:section" content="posts"><meta property="og:site_name" content="JIAYI's Blog"><meta name=twitter:card content="summary"><meta name=twitter:title content><meta name=twitter:description content="第06章_多表查询 讲师：尚硅谷-宋红康（江湖人称：康师傅）
官网：http://www.atguigu.com
 多表查询，也称为关联查询，指两个或更多个表一起完成查询操作。
前提条件：这些一起查询的表之间是有关系的（一对一、一对多），它们之间一定是有关联字段，这个关联字段可能建立了外键，也可能没有建立外键。比如：员工表和部门表，这两个表依靠“部门编号”进行关联。
1. 一个案例引发的多表连接 1.1 案例说明 从多个表中获取数据：
#案例：查询员工的姓名及其部门名称 SELECT last_name, department_name FROM employees, departments; 查询结果：
+-----------+----------------------+ | last_name | department_name | +-----------+----------------------+ | King | Administration | | King | Marketing | | King | Purchasing | | King | Human Resources | | King | Shipping | | King | IT | | King | Public Relations | | King | Sales | | King | Executive | | King | Finance | | King | Accounting | | King | Treasury | ."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://jiayi26.github.io/posts/"},{"@type":"ListItem","position":2,"name":"","item":"https://jiayi26.github.io/posts/%E7%AC%AC06%E7%AB%A0_%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"","name":"","description":"第06章_多表查询 讲师：尚硅谷-宋红康（江湖人称：康师傅）\n官网：http://www.atguigu.com\n 多表查询，也称为关联查询，指两个或更多个表一起完成查询操作。\n前提条件：这些一起查询的表之间是有关系的（一对一、一对多），它们之间一定是有关联字段，这个关联字段可能建立了外键，也可能没有建立外键。比如：员工表和部门表，这两个表依靠“部门编号”进行关联。\n1. 一个案例引发的多表连接 1.1 案例说明 从多个表中获取数据：\n#案例：查询员工的姓名及其部门名称 SELECT last_name, department_name FROM employees, departments; 查询结果：\n+-----------+----------------------+ | last_name | department_name | +-----------+----------------------+ | King | Administration | | King | Marketing | | King | Purchasing | | King | Human Resources | | King | Shipping | | King | IT | | King | Public Relations | | King | Sales | | King | Executive | | King | Finance | | King | Accounting | | King | Treasury | .","keywords":[],"articleBody":"第06章_多表查询 讲师：尚硅谷-宋红康（江湖人称：康师傅）\n官网：http://www.atguigu.com\n 多表查询，也称为关联查询，指两个或更多个表一起完成查询操作。\n前提条件：这些一起查询的表之间是有关系的（一对一、一对多），它们之间一定是有关联字段，这个关联字段可能建立了外键，也可能没有建立外键。比如：员工表和部门表，这两个表依靠“部门编号”进行关联。\n1. 一个案例引发的多表连接 1.1 案例说明 从多个表中获取数据：\n#案例：查询员工的姓名及其部门名称 SELECT last_name, department_name FROM employees, departments; 查询结果：\n+-----------+----------------------+ | last_name | department_name | +-----------+----------------------+ | King | Administration | | King | Marketing | | King | Purchasing | | King | Human Resources | | King | Shipping | | King | IT | | King | Public Relations | | King | Sales | | King | Executive | | King | Finance | | King | Accounting | | King | Treasury | ... | Gietz | IT Support | | Gietz | NOC | | Gietz | IT Helpdesk | | Gietz | Government Sales | | Gietz | Retail Sales | | Gietz | Recruiting | | Gietz | Payroll | +-----------+----------------------+ 2889 rows in set (0.01 sec) 分析错误情况：\nSELECT COUNT(employee_id) FROM employees; #输出107行  SELECT COUNT(department_id)FROM departments; #输出27行  SELECT 107*27 FROM dual; 我们把上述多表查询中出现的问题称为：笛卡尔积的错误。\n1.2 笛卡尔积（或交叉连接）的理解 笛卡尔乘积是一个数学运算。假设我有两个集合 X 和 Y，那么 X 和 Y 的笛卡尔积就是 X 和 Y 的所有可能组合，也就是第一个对象来自于 X，第二个对象来自于 Y 的所有可能。组合的个数即为两个集合中元素个数的乘积数。\nSQL92中，笛卡尔积也称为交叉连接，英文是 CROSS JOIN。在 SQL99 中也是使用 CROSS JOIN表示交叉连接。它的作用就是可以把任意表进行连接，即使这两张表不相关。在MySQL中如下情况会出现笛卡尔积：\n#查询员工姓名和所在部门名称 SELECT last_name,department_name FROM employees,departments; SELECT last_name,department_name FROM employees CROSS JOIN departments; SELECT last_name,department_name FROM employees INNER JOIN departments; SELECT last_name,department_name FROM employees JOIN departments; 1.3 案例分析与问题解决   笛卡尔积的错误会在下面条件下产生：\n 省略多个表的连接条件（或关联条件） 连接条件（或关联条件）无效 所有表中的所有行互相连接    为了避免笛卡尔积， 可以在 WHERE 加入有效的连接条件。\n  加入连接条件后，查询语法：\nSELECT\ttable1.column, table2.column FROM\ttable1, table2 WHERE\ttable1.column1 = table2.column2; #连接条件  在 WHERE子句中写入连接条件。    正确写法：\n#案例：查询员工的姓名及其部门名称 SELECT last_name, department_name FROM employees, departments WHERE employees.department_id = departments.department_id;   在表中有相同列时，在列名之前加上表名前缀。\n  2. 多表查询分类讲解 分类1：等值连接 vs 非等值连接 等值连接 SELECT employees.employee_id, employees.last_name,  employees.department_id, departments.department_id,  departments.location_id FROM employees, departments WHERE employees.department_id = departments.department_id; 拓展1：多个连接条件与 AND 操作符\n拓展2：区分重复的列名\n 多个表中有相同列时，必须在列名之前加上表名前缀。 在不同表中具有相同列名的列可以用表名加以区分。  SELECT employees.last_name, departments.department_name,employees.department_id FROM employees, departments WHERE employees.department_id = departments.department_id; 拓展3：表的别名\n  使用别名可以简化查询。\n  列名前使用表名前缀可以提高查询效率。\n  SELECT e.employee_id, e.last_name, e.department_id,  d.department_id, d.location_id FROM employees e , departments d WHERE e.department_id = d.department_id;  需要注意的是，如果我们使用了表的别名，在查询字段中、过滤条件中就只能使用别名进行代替，不能使用原有的表名，否则就会报错。\n  阿里开发规范：\n【强制】对于数据库中表记录的查询和变更，只要涉及多个表，都需要在列名前加表的别名（或 表名）进行限定。\n说明：对多表进行查询记录、更新记录、删除记录时，如果对操作列没有限定表的别名（或表名），并且操作列在多个表中存在时，就会抛异常。\n正例：select t1.name from table_first as t1 , table_second as t2 where t1.id=t2.id;\n反例：在某业务中，由于多表关联查询语句没有加表的别名（或表名）的限制，正常运行两年后，最近在 某个表中增加一个同名字段，在预发布环境做数据库变更后，线上查询语句出现出 1052 异常：Column ’name’ in field list is ambiguous。\n 拓展4：连接多个表\n**总结：连接 n个表,至少需要n-1个连接条件。**比如，连接三个表，至少需要两个连接条件。\n练习：查询出公司员工的 last_name,department_name, city\n非等值连接 SELECT e.last_name, e.salary, j.grade_level FROM employees e, job_grades j WHERE e.salary BETWEEN j.lowest_sal AND j.highest_sal; 分类2：自连接 vs 非自连接  当table1和table2本质上是同一张表，只是用取别名的方式虚拟成两张表以代表不同的意义。然后两个表再进行内连接，外连接等查询。  题目：查询employees表，返回“Xxx works for Xxx”\nSELECT CONCAT(worker.last_name ,' works for '  , manager.last_name) FROM employees worker, employees manager WHERE worker.manager_id = manager.employee_id ; 练习：查询出last_name为 ‘Chen’ 的员工的 manager 的信息。\n分类3：内连接 vs 外连接 除了查询满足条件的记录以外，外连接还可以查询某一方不满足条件的记录。\n  内连接: 合并具有同一列的两个以上的表的行, 结果集中不包含一个表与另一个表不匹配的行\n  外连接: 两个表在连接过程中除了返回满足连接条件的行以外还返回左（或右）表中不满足条件的行 ，这种连接称为左（或右） 外连接。没有匹配的行时, 结果表中相应的列为空(NULL)。\n  如果是左外连接，则连接条件中左边的表也称为主表，右边的表称为从表。\n如果是右外连接，则连接条件中右边的表也称为主表，左边的表称为从表。\n  SQL92：使用(+)创建连接   在 SQL92 中采用（+）代表从表所在的位置。即左或右外连接中，(+) 表示哪个是从表。\n  Oracle 对 SQL92 支持较好，而 MySQL 则不支持 SQL92 的外连接。\n#左外连接 SELECT last_name,department_name FROM employees ,departments WHERE employees.department_id = departments.department_id(+);  #右外连接 SELECT last_name,department_name FROM employees ,departments WHERE employees.department_id(+) = departments.department_id;   而且在 SQL92 中，只有左外连接和右外连接，没有满（或全）外连接。\n  3. SQL99语法实现多表查询 3.1 基本语法   使用JOIN…ON子句创建连接的语法结构：\nSELECT table1.column, table2.column,table3.column FROM table1  JOIN table2 ON table1 和 table2 的连接条件  JOIN table3 ON table2 和 table3 的连接条件 它的嵌套逻辑类似我们使用的 FOR 循环：\nfor t1 in table1:  for t2 in table2:  if condition1:  for t3 in table3:  if condition2:  output t1 + t2 + t3 SQL99 采用的这种嵌套结构非常清爽、层次性更强、可读性更强，即使再多的表进行连接也都清晰可见。如果你采用 SQL92，可读性就会大打折扣。\n  语法说明：\n 可以使用 ON 子句指定额外的连接条件。 这个连接条件是与其它条件分开的。 ON 子句使语句具有更高的易读性。 关键字 JOIN、INNER JOIN、CROSS JOIN 的含义是一样的，都表示内连接    3.2 内连接(INNER JOIN)的实现  语法：  SELECT 字段列表 FROM A表 INNER JOIN B表 ON 关联条件 WHERE 等其他子句; 题目1：\nSELECT e.employee_id, e.last_name, e.department_id,  d.department_id, d.location_id FROM employees e JOIN departments d ON (e.department_id = d.department_id); 题目2：\nSELECT employee_id, city, department_name FROM employees e JOIN departments d ON d.department_id = e.department_id JOIN locations l ON d.location_id = l.location_id; 3.3 外连接(OUTER JOIN)的实现 3.3.1 左外连接(LEFT OUTER JOIN)  语法：  #实现查询结果是A SELECT 字段列表 FROM A表 LEFT JOIN B表 ON 关联条件 WHERE 等其他子句;  举例：  SELECT e.last_name, e.department_id, d.department_name FROM employees e LEFT OUTER JOIN departments d ON (e.department_id = d.department_id) ; 3.3.2 右外连接(RIGHT OUTER JOIN)  语法：  #实现查询结果是B SELECT 字段列表 FROM A表 RIGHT JOIN B表 ON 关联条件 WHERE 等其他子句;  举例：  SELECT e.last_name, e.department_id, d.department_name FROM employees e RIGHT OUTER JOIN departments d ON (e.department_id = d.department_id) ;  需要注意的是，LEFT JOIN 和 RIGHT JOIN 只存在于 SQL99 及以后的标准中，在 SQL92 中不存在，只能用 (+) 表示。\n 3.3.3 满外连接(FULL OUTER JOIN)  满外连接的结果 = 左右表匹配的数据 + 左表没有匹配到的数据 + 右表没有匹配到的数据。 SQL99是支持满外连接的。使用FULL JOIN 或 FULL OUTER JOIN来实现。 需要注意的是，MySQL不支持FULL JOIN，但是可以用 LEFT JOIN UNION RIGHT join代替。  4. UNION的使用 合并查询结果 利用UNION关键字，可以给出多条SELECT语句，并将它们的结果组合成单个结果集。合并时，两个表对应的列数和数据类型必须相同，并且相互对应。各个SELECT语句之间使用UNION或UNION ALL关键字分隔。\n语法格式：\nSELECT column,... FROM table1 UNION [ALL] SELECT column,... FROM table2 UNION操作符\nUNION 操作符返回两个查询的结果集的并集，去除重复记录。\nUNION ALL操作符\nUNION ALL操作符返回两个查询的结果集的并集。对于两个结果集的重复部分，不去重。\n 注意：执行UNION ALL语句时所需要的资源比UNION语句少。如果明确知道合并数据后的结果数据不存在重复数据，或者不需要去除重复的数据，则尽量使用UNION ALL语句，以提高数据查询的效率。\n 举例：查询部门编号90或邮箱包含a的员工信息\n#方式1 SELECT * FROM employees WHERE email LIKE '%a%' OR department_id90; #方式2 SELECT * FROM employees WHERE email LIKE '%a%' UNION SELECT * FROM employees WHERE department_id90; 举例：查询中国用户中男性的信息以及美国用户中年男性的用户信息\nSELECT id,cname FROM t_chinamale WHERE csex='男' UNION ALL SELECT id,tname FROM t_usmale WHERE tGender='male'; 5. 7种SQL JOINS的实现 5.7.1 代码实现 #中图：内连接 A∩B SELECT employee_id,last_name,department_name FROM employees e JOIN departments d ON e.`department_id` = d.`department_id`; #左上图：左外连接 SELECT employee_id,last_name,department_name FROM employees e LEFT JOIN departments d ON e.`department_id` = d.`department_id`; #右上图：右外连接 SELECT employee_id,last_name,department_name FROM employees e RIGHT JOIN departments d ON e.`department_id` = d.`department_id`; #左中图：A - A∩B SELECT employee_id,last_name,department_name FROM employees e LEFT JOIN departments d ON e.`department_id` = d.`department_id` WHERE d.`department_id` IS NULL #右中图：B-A∩B SELECT employee_id,last_name,department_name FROM employees e RIGHT JOIN departments d ON e.`department_id` = d.`department_id` WHERE e.`department_id` IS NULL #左下图：满外连接 # 左中图 + 右上图 A∪B SELECT employee_id,last_name,department_name FROM employees e LEFT JOIN departments d ON e.`department_id` = d.`department_id` WHERE d.`department_id` IS NULL UNION ALL #没有去重操作，效率高 SELECT employee_id,last_name,department_name FROM employees e RIGHT JOIN departments d ON e.`department_id` = d.`department_id`; #右下图 #左中图 + 右中图 A ∪B- A∩B 或者 (A - A∩B) ∪ （B - A∩B） SELECT employee_id,last_name,department_name FROM employees e LEFT JOIN departments d ON e.`department_id` = d.`department_id` WHERE d.`department_id` IS NULL UNION ALL SELECT employee_id,last_name,department_name FROM employees e RIGHT JOIN departments d ON e.`department_id` = d.`department_id` WHERE e.`department_id` IS NULL 5.7.2 语法格式小结  左中图  #实现A - A∩B select 字段列表 from A表 left join B表 on 关联条件 where 从表关联字段 is null and 等其他子句;  右中图  #实现B - A∩B select 字段列表 from A表 right join B表 on 关联条件 where 从表关联字段 is null and 等其他子句;  左下图  #实现查询结果是A∪B #用左外的A，union 右外的B select 字段列表 from A表 left join B表 on 关联条件 where 等其他子句  union  select 字段列表 from A表 right join B表 on 关联条件 where 等其他子句;  右下图  #实现A∪B - A∩B 或 (A - A∩B) ∪ （B - A∩B） #使用左外的 (A - A∩B) union 右外的（B - A∩B） select 字段列表 from A表 left join B表 on 关联条件 where 从表关联字段 is null and 等其他子句  union  select 字段列表 from A表 right join B表 on 关联条件 where 从表关联字段 is null and 等其他子句 6. SQL99语法新特性 6.1 自然连接 SQL99 在 SQL92 的基础上提供了一些特殊语法，比如 NATURAL JOIN 用来表示自然连接。我们可以把自然连接理解为 SQL92 中的等值连接。它会帮你自动查询两张连接表中所有相同的字段，然后进行等值连接。\n在SQL92标准中：\nSELECT employee_id,last_name,department_name FROM employees e JOIN departments d ON e.`department_id` = d.`department_id` AND e.`manager_id` = d.`manager_id`; 在 SQL99 中你可以写成：\nSELECT employee_id,last_name,department_name FROM employees e NATURAL JOIN departments d; 6.2 USING连接 当我们进行连接的时候，SQL99还支持使用 USING 指定数据表里的同名字段进行等值连接。但是只能配合JOIN一起使用。比如：\nSELECT employee_id,last_name,department_name FROM employees e JOIN departments d USING (department_id); 你能看出与自然连接 NATURAL JOIN 不同的是，USING 指定了具体的相同的字段名称，你需要在 USING 的括号 () 中填入要指定的同名字段。同时使用 JOIN...USING 可以简化 JOIN ON 的等值连接。它与下面的 SQL 查询结果是相同的：\nSELECT employee_id,last_name,department_name FROM employees e ,departments d WHERE e.department_id = d.department_id; 7. 章节小结 表连接的约束条件可以有三种方式：WHERE, ON, USING\n  WHERE：适用于所有关联查询\n  ON：只能和JOIN一起使用，只能写关联条件。虽然关联条件可以并到WHERE中和其他条件一起写，但分开写可读性更好。\n  USING：只能和JOIN一起使用，而且要求两个关联字段在关联表中名称一致，而且只能表示关联字段值相等\n  #关联条件 #把关联条件写在where后面 SELECT last_name,department_name FROM employees,departments WHERE employees.department_id = departments.department_id;  #把关联条件写在on后面，只能和JOIN一起使用 SELECT last_name,department_name FROM employees INNER JOIN departments ON employees.department_id = departments.department_id;  SELECT last_name,department_name FROM employees CROSS JOIN departments ON employees.department_id = departments.department_id;  SELECT last_name,department_name FROM employees JOIN departments ON employees.department_id = departments.department_id;  #把关联字段写在using()中，只能和JOIN一起使用 #而且两个表中的关联字段必须名称相同，而且只能表示= #查询员工姓名与基本工资 SELECT last_name,job_title FROM employees INNER JOIN jobs USING(job_id);  #n张表关联，需要n-1个关联条件 #查询员工姓名，基本工资，部门名称 SELECT last_name,job_title,department_name FROM employees,departments,jobs WHERE employees.department_id = departments.department_id AND employees.job_id = jobs.job_id;  SELECT last_name,job_title,department_name FROM employees INNER JOIN departments INNER JOIN jobs ON employees.department_id = departments.department_id AND employees.job_id = jobs.job_id; 注意：\n我们要控制连接表的数量。多表连接就相当于嵌套 for 循环一样，非常消耗资源，会让 SQL 查询性能下降得很严重，因此不要连接不必要的表。在许多 DBMS 中，也都会有最大连接表的限制。\n 【强制】超过三个表禁止 join。需要 join 的字段，数据类型保持绝对一致；多表关联查询时， 保证被关联的字段需要有索引。\n说明：即使双表 join 也要注意表索引、SQL 性能。\n来源：阿里巴巴《Java开发手册》\n 附录：常用的 SQL 标准有哪些 在正式开始讲连接表的种类时，我们首先需要知道 SQL 存在不同版本的标准规范，因为不同规范下的表连接操作是有区别的。\nSQL 有两个主要的标准，分别是 SQL92 和 SQL99。92 和 99 代表了标准提出的时间，SQL92 就是 92 年提出的标准规范。当然除了 SQL92 和 SQL99 以外，还存在 SQL-86、SQL-89、SQL:2003、SQL:2008、SQL:2011 和 SQL:2016 等其他的标准。\n这么多标准，到底该学习哪个呢？实际上最重要的 SQL 标准就是 SQL92 和 SQL99。一般来说 SQL92 的形式更简单，但是写的 SQL 语句会比较长，可读性较差。而 SQL99 相比于 SQL92 来说，语法更加复杂，但可读性更强。我们从这两个标准发布的页数也能看出，SQL92 的标准有 500 页，而 SQL99 标准超过了 1000 页。实际上从 SQL99 之后，很少有人能掌握所有内容，因为确实太多了。就好比我们使用 Windows、Linux 和 Office 的时候，很少有人能掌握全部内容一样。我们只需要掌握一些核心的功能，满足日常工作的需求即可。\n**SQL92 和 SQL99 是经典的 SQL 标准，也分别叫做 SQL-2 和 SQL-3 标准。**也正是在这两个标准发布之后，SQL 影响力越来越大，甚至超越了数据库领域。现如今 SQL 已经不仅仅是数据库领域的主流语言，还是信息领域中信息处理的主流语言。在图形检索、图像检索以及语音检索中都能看到 SQL 语言的使用。\n","wordCount":"1271","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://jiayi26.github.io/posts/%E7%AC%AC06%E7%AB%A0_%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2/"},"publisher":{"@type":"Organization","name":"JIAYI's Blog","logo":{"@type":"ImageObject","url":"https://xx.mzqcgc.cn/FrbOmxJvq96XDbDPXbiBWM0LU9e3"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://jiayi26.github.io/ accesskey=h title="Home (Alt + H)">Home</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://jiayi26.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://jiayi26.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://jiayi26.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://jiayi26.github.io/posts/>Posts</a></div><h1 class=post-title></h1><div class=post-meta>6 min&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/Pass-JIAYI%27s.github.io/post/posts/%e7%ac%ac06%e7%ab%a0_%e5%a4%9a%e8%a1%a8%e6%9f%a5%e8%af%a2.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><h1 id=第06章_多表查询>第06章_多表查询<a hidden class=anchor aria-hidden=true href=#第06章_多表查询>#</a></h1><p>讲师：尚硅谷-宋红康（江湖人称：康师傅）</p><p>官网：<a href=http://www.atguigu.com/>http://www.atguigu.com</a></p><hr><p>多表查询，也称为关联查询，指两个或更多个表一起完成查询操作。</p><p>前提条件：这些一起查询的表之间是有关系的（一对一、一对多），它们之间一定是有关联字段，这个关联字段可能建立了外键，也可能没有建立外键。比如：员工表和部门表，这两个表依靠“部门编号”进行关联。</p><h2 id=1-一个案例引发的多表连接>1. 一个案例引发的多表连接<a hidden class=anchor aria-hidden=true href=#1-一个案例引发的多表连接>#</a></h2><h3 id=11-案例说明>1.1 案例说明<a hidden class=anchor aria-hidden=true href=#11-案例说明>#</a></h3><p><img loading=lazy src=../_resources/1554974984600.png alt=1554974984600></p><p>从多个表中获取数据：</p><p><img loading=lazy src=../_resources/1554975020388.png alt=1554975020388></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e>#案例：查询员工的姓名及其部门名称
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> last_name, department_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> employees, departments;
</span></span></code></pre></div><p><img loading=lazy src=../_resources/1554975097631.png alt=1554975097631></p><p>查询结果：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#f92672>+-----------+----------------------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> last_name <span style=color:#f92672>|</span> department_name      <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-----------+----------------------+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> King      <span style=color:#f92672>|</span> Administration       <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> King      <span style=color:#f92672>|</span> Marketing            <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> King      <span style=color:#f92672>|</span> Purchasing           <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> King      <span style=color:#f92672>|</span> Human Resources      <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> King      <span style=color:#f92672>|</span> Shipping             <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> King      <span style=color:#f92672>|</span> IT                   <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> King      <span style=color:#f92672>|</span> Public Relations     <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> King      <span style=color:#f92672>|</span> Sales                <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> King      <span style=color:#f92672>|</span> Executive            <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> King      <span style=color:#f92672>|</span> Finance              <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> King      <span style=color:#f92672>|</span> Accounting           <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> King      <span style=color:#f92672>|</span> Treasury             <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> Gietz     <span style=color:#f92672>|</span> IT Support           <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> Gietz     <span style=color:#f92672>|</span> NOC                  <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> Gietz     <span style=color:#f92672>|</span> IT Helpdesk          <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> Gietz     <span style=color:#f92672>|</span> Government Sales     <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> Gietz     <span style=color:#f92672>|</span> Retail Sales         <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> Gietz     <span style=color:#f92672>|</span> Recruiting           <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> Gietz     <span style=color:#f92672>|</span> Payroll              <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+-----------+----------------------+</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>2889</span> rows <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>set</span> (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>01</span> sec)
</span></span></code></pre></div><p><strong>分析错误情况：</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#a6e22e>COUNT</span>(employee_id) <span style=color:#66d9ef>FROM</span> employees;
</span></span><span style=display:flex><span><span style=color:#75715e>#输出107行
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#a6e22e>COUNT</span>(department_id)<span style=color:#66d9ef>FROM</span> departments;
</span></span><span style=display:flex><span><span style=color:#75715e>#输出27行
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#ae81ff>107</span><span style=color:#f92672>*</span><span style=color:#ae81ff>27</span> <span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>dual</span>;
</span></span></code></pre></div><p>我们把上述多表查询中出现的问题称为：笛卡尔积的错误。</p><h3 id=12-笛卡尔积或交叉连接的理解>1.2 笛卡尔积（或交叉连接）的理解<a hidden class=anchor aria-hidden=true href=#12-笛卡尔积或交叉连接的理解>#</a></h3><p>笛卡尔乘积是一个数学运算。假设我有两个集合 X 和 Y，那么 X 和 Y 的笛卡尔积就是 X 和 Y 的所有可能组合，也就是第一个对象来自于 X，第二个对象来自于 Y 的所有可能。组合的个数即为两个集合中元素个数的乘积数。</p><p>SQL92中，笛卡尔积也称为<code>交叉连接</code>，英文是 <code>CROSS JOIN</code>。在 SQL99 中也是使用 CROSS JOIN表示交叉连接。它的作用就是可以把任意表进行连接，即使这两张表不相关。在MySQL中如下情况会出现笛卡尔积：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e>#查询员工姓名和所在部门名称
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> last_name,department_name <span style=color:#66d9ef>FROM</span> employees,departments;
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> last_name,department_name <span style=color:#66d9ef>FROM</span> employees <span style=color:#66d9ef>CROSS</span> <span style=color:#66d9ef>JOIN</span> departments;
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> last_name,department_name <span style=color:#66d9ef>FROM</span> employees <span style=color:#66d9ef>INNER</span> <span style=color:#66d9ef>JOIN</span> departments;
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> last_name,department_name <span style=color:#66d9ef>FROM</span> employees <span style=color:#66d9ef>JOIN</span> departments;
</span></span></code></pre></div><h3 id=13-案例分析与问题解决>1.3 案例分析与问题解决<a hidden class=anchor aria-hidden=true href=#13-案例分析与问题解决>#</a></h3><ul><li><p><strong>笛卡尔积的错误会在下面条件下产生</strong>：</p><ul><li>省略多个表的连接条件（或关联条件）</li><li>连接条件（或关联条件）无效</li><li>所有表中的所有行互相连接</li></ul></li><li><p>为了避免笛卡尔积， 可以<strong>在 WHERE 加入有效的连接条件。</strong></p></li><li><p>加入连接条件后，查询语法：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span>	table1.<span style=color:#66d9ef>column</span>, table2.<span style=color:#66d9ef>column</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span>	table1, table2
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span>	table1.column1 <span style=color:#f92672>=</span> table2.column2;  <span style=color:#75715e>#连接条件
</span></span></span></code></pre></div><ul><li><strong>在 WHERE子句中写入连接条件。</strong></li></ul></li><li><p>正确写法：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e>#案例：查询员工的姓名及其部门名称
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> last_name, department_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> employees, departments
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> employees.department_id <span style=color:#f92672>=</span> departments.department_id;
</span></span></code></pre></div></li><li><p><strong>在表中有相同列时，在列名之前加上表名前缀。</strong></p></li></ul><h2 id=2-多表查询分类讲解>2. 多表查询分类讲解<a hidden class=anchor aria-hidden=true href=#2-多表查询分类讲解>#</a></h2><h3 id=分类1等值连接-vs-非等值连接>分类1：等值连接 vs 非等值连接<a hidden class=anchor aria-hidden=true href=#分类1等值连接-vs-非等值连接>#</a></h3><h4 id=等值连接>等值连接<a hidden class=anchor aria-hidden=true href=#等值连接>#</a></h4><p><img loading=lazy src=../_resources/1554975496900.png alt=1554975496900></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> employees.employee_id, employees.last_name, 
</span></span><span style=display:flex><span>       employees.department_id, departments.department_id,
</span></span><span style=display:flex><span>       departments.location_id
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span>   employees, departments
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span>  employees.department_id <span style=color:#f92672>=</span> departments.department_id;
</span></span></code></pre></div><p><img loading=lazy src=../_resources/1554975522600.png alt=1554975522600></p><p><img loading=lazy src=../_resources/1554975526339.png alt=1554975526339></p><p><strong>拓展1：多个连接条件与 AND 操作符</strong></p><p><img loading=lazy src=../_resources/1554975606231.png alt=1554975606231></p><p><strong>拓展2：区分重复的列名</strong></p><ul><li><strong>多个表中有相同列时，必须在列名之前加上表名前缀。</strong></li><li>在不同表中具有相同列名的列可以用<code>表名</code>加以区分。</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> employees.last_name, departments.department_name,employees.department_id
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> employees, departments
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> employees.department_id <span style=color:#f92672>=</span> departments.department_id;
</span></span></code></pre></div><p><strong>拓展3：表的别名</strong></p><ul><li><p>使用别名可以简化查询。</p></li><li><p>列名前使用表名前缀可以提高查询效率。</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> e.employee_id, e.last_name, e.department_id,
</span></span><span style=display:flex><span>       d.department_id, d.location_id
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span>   employees e , departments d
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span>  e.department_id <span style=color:#f92672>=</span> d.department_id;
</span></span></code></pre></div><blockquote><p>需要注意的是，如果我们使用了表的别名，在查询字段中、过滤条件中就只能使用别名进行代替，不能使用原有的表名，否则就会报错。</p></blockquote><blockquote><p><code>阿里开发规范</code>：</p><p>【<code>强制</code>】对于数据库中表记录的查询和变更，只要涉及多个表，都需要在列名前加表的别名（或 表名）进行限定。</p><p><code>说明</code>：对多表进行查询记录、更新记录、删除记录时，如果对操作列没有限定表的别名（或表名），并且操作列在多个表中存在时，就会抛异常。</p><p><code>正例</code>：select t1.name from table_first as t1 , table_second as t2 where t1.id=t2.id;</p><p><code>反例</code>：在某业务中，由于多表关联查询语句没有加表的别名（或表名）的限制，正常运行两年后，最近在 某个表中增加一个同名字段，在预发布环境做数据库变更后，线上查询语句出现出 1052 异常：Column &rsquo;name&rsquo; in field list is ambiguous。</p></blockquote><p><strong>拓展4：连接多个表</strong></p><p><img loading=lazy src=../_resources/1554978354431.png alt=1554978354431></p><p>**总结：连接 n个表,至少需要n-1个连接条件。**比如，连接三个表，至少需要两个连接条件。</p><p>练习：查询出公司员工的 last_name,department_name, city</p><h4 id=非等值连接>非等值连接<a hidden class=anchor aria-hidden=true href=#非等值连接>#</a></h4><p><img loading=lazy src=../_resources/1554978442447.png alt=1554978442447></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> e.last_name, e.salary, j.grade_level
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span>   employees e, job_grades j
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span>  e.salary <span style=color:#66d9ef>BETWEEN</span> j.lowest_sal <span style=color:#66d9ef>AND</span> j.highest_sal;
</span></span></code></pre></div><p><img loading=lazy src=../_resources/1554978477013.png alt=1554978477013></p><p><img loading=lazy src=../_resources/1554978482652.png alt=1554978482652></p><h3 id=分类2自连接-vs-非自连接>分类2：自连接 vs 非自连接<a hidden class=anchor aria-hidden=true href=#分类2自连接-vs-非自连接>#</a></h3><p><img loading=lazy src=../_resources/1554978514321.png alt=1554978514321></p><ul><li>当table1和table2本质上是同一张表，只是用取别名的方式虚拟成两张表以代表不同的意义。然后两个表再进行内连接，外连接等查询。</li></ul><p><strong>题目：查询employees表，返回“Xxx works for Xxx”</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#a6e22e>CONCAT</span>(worker.last_name ,<span style=color:#e6db74>&#39; works for &#39;</span> 
</span></span><span style=display:flex><span>       , manager.last_name)
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span>   employees worker, employees manager
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span>  worker.manager_id <span style=color:#f92672>=</span> manager.employee_id ;
</span></span></code></pre></div><p><img loading=lazy src=../_resources/1554978684947.png alt=1554978684947></p><p><img loading=lazy src=../_resources/1554978690764.png alt=1554978690764></p><p>练习：查询出last_name为 ‘Chen’ 的员工的 manager 的信息。</p><h3 id=分类3内连接-vs-外连接>分类3：内连接 vs 外连接<a hidden class=anchor aria-hidden=true href=#分类3内连接-vs-外连接>#</a></h3><p>除了查询满足条件的记录以外，外连接还可以查询某一方不满足条件的记录。</p><p><img loading=lazy src=../_resources/1554978955659.png alt=1554978955659></p><ul><li><p>内连接: 合并具有同一列的两个以上的表的行, <strong>结果集中不包含一个表与另一个表不匹配的行</strong></p></li><li><p>外连接: 两个表在连接过程中除了返回满足连接条件的行以外<strong>还返回左（或右）表中不满足条件的行</strong> <strong>，这种连接称为左（或右） 外连接</strong>。没有匹配的行时, 结果表中相应的列为空(NULL)。</p></li><li><p>如果是左外连接，则连接条件中左边的表也称为<code>主表</code>，右边的表称为<code>从表</code>。</p><p>如果是右外连接，则连接条件中右边的表也称为<code>主表</code>，左边的表称为<code>从表</code>。</p></li></ul><h4 id=sql92使用创建连接>SQL92：使用(+)创建连接<a hidden class=anchor aria-hidden=true href=#sql92使用创建连接>#</a></h4><ul><li><p>在 SQL92 中采用（+）代表从表所在的位置。即左或右外连接中，(+) 表示哪个是从表。</p></li><li><p>Oracle 对 SQL92 支持较好，而 MySQL 则不支持 SQL92 的外连接。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e>#左外连接
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> last_name,department_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> employees ,departments
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> employees.department_id <span style=color:#f92672>=</span> departments.<span style=color:#a6e22e>department_id</span>(<span style=color:#f92672>+</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#右外连接
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> last_name,department_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> employees ,departments
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> employees.<span style=color:#a6e22e>department_id</span>(<span style=color:#f92672>+</span>) <span style=color:#f92672>=</span> departments.department_id;
</span></span></code></pre></div></li><li><p>而且在 SQL92 中，只有左外连接和右外连接，没有满（或全）外连接。</p></li></ul><h2 id=3-sql99语法实现多表查询>3. SQL99语法实现多表查询<a hidden class=anchor aria-hidden=true href=#3-sql99语法实现多表查询>#</a></h2><h3 id=31-基本语法>3.1 基本语法<a hidden class=anchor aria-hidden=true href=#31-基本语法>#</a></h3><ul><li><p>使用JOIN&mldr;ON子句创建连接的语法结构：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> table1.<span style=color:#66d9ef>column</span>, table2.<span style=color:#66d9ef>column</span>,table3.<span style=color:#66d9ef>column</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> table1
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>JOIN</span> table2 <span style=color:#66d9ef>ON</span> table1 <span style=color:#960050;background-color:#1e0010>和</span> table2 <span style=color:#960050;background-color:#1e0010>的连接条件</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>JOIN</span> table3 <span style=color:#66d9ef>ON</span> table2 <span style=color:#960050;background-color:#1e0010>和</span> table3 <span style=color:#960050;background-color:#1e0010>的连接条件</span>
</span></span></code></pre></div><p>它的嵌套逻辑类似我们使用的 FOR 循环：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>for</span> t1 <span style=color:#66d9ef>in</span> table1:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> t2 <span style=color:#66d9ef>in</span> table2:
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>if</span> condition1:
</span></span><span style=display:flex><span>           <span style=color:#66d9ef>for</span> t3 <span style=color:#66d9ef>in</span> table3:
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>if</span> condition2:
</span></span><span style=display:flex><span>                  output t1 <span style=color:#f92672>+</span> t2 <span style=color:#f92672>+</span> t3
</span></span></code></pre></div><p>SQL99 采用的这种嵌套结构非常清爽、层次性更强、可读性更强，即使再多的表进行连接也都清晰可见。如果你采用 SQL92，可读性就会大打折扣。</p></li><li><p>语法说明：</p><ul><li><strong>可以使用</strong> <strong>ON</strong> <strong>子句指定额外的连接条件</strong>。</li><li>这个连接条件是与其它条件分开的。</li><li><strong>ON</strong> <strong>子句使语句具有更高的易读性</strong>。</li><li>关键字 JOIN、INNER JOIN、CROSS JOIN 的含义是一样的，都表示内连接</li></ul></li></ul><h3 id=32-内连接inner-join的实现>3.2 内连接(INNER JOIN)的实现<a hidden class=anchor aria-hidden=true href=#32-内连接inner-join的实现>#</a></h3><ul><li>语法：</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#960050;background-color:#1e0010>字段列表</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> A表 <span style=color:#66d9ef>INNER</span> <span style=color:#66d9ef>JOIN</span> B表
</span></span><span style=display:flex><span><span style=color:#66d9ef>ON</span> <span style=color:#960050;background-color:#1e0010>关联条件</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> <span style=color:#960050;background-color:#1e0010>等其他子句</span>;
</span></span></code></pre></div><p>题目1：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> e.employee_id, e.last_name, e.department_id, 
</span></span><span style=display:flex><span>       d.department_id, d.location_id
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span>   employees e <span style=color:#66d9ef>JOIN</span> departments d
</span></span><span style=display:flex><span><span style=color:#66d9ef>ON</span>     (e.department_id <span style=color:#f92672>=</span> d.department_id);
</span></span></code></pre></div><p><img loading=lazy src=../_resources/1554979073996.png alt=1554979073996></p><p><img loading=lazy src=../_resources/1554979079395.png alt=1554979079395></p><p>题目2：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> employee_id, city, department_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span>   employees e 
</span></span><span style=display:flex><span><span style=color:#66d9ef>JOIN</span>   departments d
</span></span><span style=display:flex><span><span style=color:#66d9ef>ON</span>     d.department_id <span style=color:#f92672>=</span> e.department_id 
</span></span><span style=display:flex><span><span style=color:#66d9ef>JOIN</span>   locations l
</span></span><span style=display:flex><span><span style=color:#66d9ef>ON</span>     d.location_id <span style=color:#f92672>=</span> l.location_id;
</span></span></code></pre></div><p><img loading=lazy src=../_resources/1554979110008.png alt=1554979110008></p><p><img loading=lazy src=../_resources/1554979115642.png alt=1554979115642></p><h3 id=33-外连接outer-join的实现>3.3 外连接(OUTER JOIN)的实现<a hidden class=anchor aria-hidden=true href=#33-外连接outer-join的实现>#</a></h3><h4 id=331-左外连接left-outer-join>3.3.1 左外连接(LEFT OUTER JOIN)<a hidden class=anchor aria-hidden=true href=#331-左外连接left-outer-join>#</a></h4><ul><li>语法：</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e>#实现查询结果是A
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> <span style=color:#960050;background-color:#1e0010>字段列表</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> A表 <span style=color:#66d9ef>LEFT</span> <span style=color:#66d9ef>JOIN</span> B表
</span></span><span style=display:flex><span><span style=color:#66d9ef>ON</span> <span style=color:#960050;background-color:#1e0010>关联条件</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> <span style=color:#960050;background-color:#1e0010>等其他子句</span>;
</span></span></code></pre></div><ul><li>举例：</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> e.last_name, e.department_id, d.department_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span>   employees e
</span></span><span style=display:flex><span><span style=color:#66d9ef>LEFT</span> <span style=color:#66d9ef>OUTER</span> <span style=color:#66d9ef>JOIN</span> departments d
</span></span><span style=display:flex><span><span style=color:#66d9ef>ON</span>   (e.department_id <span style=color:#f92672>=</span> d.department_id) ;
</span></span></code></pre></div><p><img loading=lazy src=../_resources/1554979200961.png alt=1554979200961></p><h4 id=332-右外连接right-outer-join>3.3.2 右外连接(RIGHT OUTER JOIN)<a hidden class=anchor aria-hidden=true href=#332-右外连接right-outer-join>#</a></h4><ul><li>语法：</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e>#实现查询结果是B
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> <span style=color:#960050;background-color:#1e0010>字段列表</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> A表 <span style=color:#66d9ef>RIGHT</span> <span style=color:#66d9ef>JOIN</span> B表
</span></span><span style=display:flex><span><span style=color:#66d9ef>ON</span> <span style=color:#960050;background-color:#1e0010>关联条件</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> <span style=color:#960050;background-color:#1e0010>等其他子句</span>;
</span></span></code></pre></div><ul><li>举例：</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> e.last_name, e.department_id, d.department_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span>   employees e
</span></span><span style=display:flex><span><span style=color:#66d9ef>RIGHT</span> <span style=color:#66d9ef>OUTER</span> <span style=color:#66d9ef>JOIN</span> departments d
</span></span><span style=display:flex><span><span style=color:#66d9ef>ON</span>    (e.department_id <span style=color:#f92672>=</span> d.department_id) ;
</span></span></code></pre></div><p><img loading=lazy src=../_resources/1554979243194.png alt=1554979243194></p><blockquote><p>需要注意的是，LEFT JOIN 和 RIGHT JOIN 只存在于 SQL99 及以后的标准中，在 SQL92 中不存在，只能用 (+) 表示。</p></blockquote><h4 id=333-满外连接full-outer-join>3.3.3 满外连接(FULL OUTER JOIN)<a hidden class=anchor aria-hidden=true href=#333-满外连接full-outer-join>#</a></h4><ul><li>满外连接的结果 = 左右表匹配的数据 + 左表没有匹配到的数据 + 右表没有匹配到的数据。</li><li>SQL99是支持满外连接的。使用FULL JOIN 或 FULL OUTER JOIN来实现。</li><li>需要注意的是，MySQL不支持FULL JOIN，但是可以用 LEFT JOIN <strong>UNION</strong> RIGHT join代替。</li></ul><h2 id=4-union的使用>4. UNION的使用<a hidden class=anchor aria-hidden=true href=#4-union的使用>#</a></h2><p><strong>合并查询结果</strong>
利用UNION关键字，可以给出多条SELECT语句，并将它们的结果组合成单个结果集。合并时，两个表对应的列数和数据类型必须相同，并且相互对应。各个SELECT语句之间使用UNION或UNION ALL关键字分隔。</p><p>语法格式：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>column</span>,... <span style=color:#66d9ef>FROM</span> table1
</span></span><span style=display:flex><span><span style=color:#66d9ef>UNION</span> [<span style=color:#66d9ef>ALL</span>]
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>column</span>,... <span style=color:#66d9ef>FROM</span> table2
</span></span></code></pre></div><p><strong>UNION操作符</strong></p><p>UNION 操作符返回两个查询的结果集的并集，去除重复记录。</p><p><strong>UNION ALL操作符</strong></p><p>UNION ALL操作符返回两个查询的结果集的并集。对于两个结果集的重复部分，不去重。</p><blockquote><p>注意：执行UNION ALL语句时所需要的资源比UNION语句少。如果明确知道合并数据后的结果数据不存在重复数据，或者不需要去除重复的数据，则尽量使用UNION ALL语句，以提高数据查询的效率。</p></blockquote><p>举例：查询部门编号>90或邮箱包含a的员工信息</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e>#方式1
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> employees <span style=color:#66d9ef>WHERE</span> email <span style=color:#66d9ef>LIKE</span> <span style=color:#e6db74>&#39;%a%&#39;</span> <span style=color:#66d9ef>OR</span> department_id<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>90</span>;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e>#方式2
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> employees  <span style=color:#66d9ef>WHERE</span> email <span style=color:#66d9ef>LIKE</span> <span style=color:#e6db74>&#39;%a%&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>UNION</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> employees  <span style=color:#66d9ef>WHERE</span> department_id<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>90</span>;
</span></span></code></pre></div><p>举例：查询中国用户中男性的信息以及美国用户中年男性的用户信息</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> id,cname <span style=color:#66d9ef>FROM</span> t_chinamale <span style=color:#66d9ef>WHERE</span> csex<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;男&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>UNION</span> <span style=color:#66d9ef>ALL</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> id,tname <span style=color:#66d9ef>FROM</span> t_usmale <span style=color:#66d9ef>WHERE</span> tGender<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;male&#39;</span>;
</span></span></code></pre></div><h2 id=5-7种sql-joins的实现>5. 7种SQL JOINS的实现<a hidden class=anchor aria-hidden=true href=#5-7种sql-joins的实现>#</a></h2><h3 id=571-代码实现>5.7.1 代码实现<a hidden class=anchor aria-hidden=true href=#571-代码实现>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e>#中图：内连接 A∩B
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> employee_id,last_name,department_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> employees e <span style=color:#66d9ef>JOIN</span> departments d
</span></span><span style=display:flex><span><span style=color:#66d9ef>ON</span> e.<span style=color:#f92672>`</span>department_id<span style=color:#f92672>`</span> <span style=color:#f92672>=</span> d.<span style=color:#f92672>`</span>department_id<span style=color:#f92672>`</span>;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e>#左上图：左外连接
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> employee_id,last_name,department_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> employees e <span style=color:#66d9ef>LEFT</span> <span style=color:#66d9ef>JOIN</span> departments d
</span></span><span style=display:flex><span><span style=color:#66d9ef>ON</span> e.<span style=color:#f92672>`</span>department_id<span style=color:#f92672>`</span> <span style=color:#f92672>=</span> d.<span style=color:#f92672>`</span>department_id<span style=color:#f92672>`</span>;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e>#右上图：右外连接
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> employee_id,last_name,department_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> employees e <span style=color:#66d9ef>RIGHT</span> <span style=color:#66d9ef>JOIN</span> departments d
</span></span><span style=display:flex><span><span style=color:#66d9ef>ON</span> e.<span style=color:#f92672>`</span>department_id<span style=color:#f92672>`</span> <span style=color:#f92672>=</span> d.<span style=color:#f92672>`</span>department_id<span style=color:#f92672>`</span>;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e>#左中图：A - A∩B
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> employee_id,last_name,department_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> employees e <span style=color:#66d9ef>LEFT</span> <span style=color:#66d9ef>JOIN</span> departments d
</span></span><span style=display:flex><span><span style=color:#66d9ef>ON</span> e.<span style=color:#f92672>`</span>department_id<span style=color:#f92672>`</span> <span style=color:#f92672>=</span> d.<span style=color:#f92672>`</span>department_id<span style=color:#f92672>`</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> d.<span style=color:#f92672>`</span>department_id<span style=color:#f92672>`</span> <span style=color:#66d9ef>IS</span> <span style=color:#66d9ef>NULL</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e>#右中图：B-A∩B
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> employee_id,last_name,department_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> employees e <span style=color:#66d9ef>RIGHT</span> <span style=color:#66d9ef>JOIN</span> departments d
</span></span><span style=display:flex><span><span style=color:#66d9ef>ON</span> e.<span style=color:#f92672>`</span>department_id<span style=color:#f92672>`</span> <span style=color:#f92672>=</span> d.<span style=color:#f92672>`</span>department_id<span style=color:#f92672>`</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> e.<span style=color:#f92672>`</span>department_id<span style=color:#f92672>`</span> <span style=color:#66d9ef>IS</span> <span style=color:#66d9ef>NULL</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e>#左下图：满外连接
</span></span></span><span style=display:flex><span><span style=color:#75715e># 左中图 + 右上图  A∪B
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> employee_id,last_name,department_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> employees e <span style=color:#66d9ef>LEFT</span> <span style=color:#66d9ef>JOIN</span> departments d
</span></span><span style=display:flex><span><span style=color:#66d9ef>ON</span> e.<span style=color:#f92672>`</span>department_id<span style=color:#f92672>`</span> <span style=color:#f92672>=</span> d.<span style=color:#f92672>`</span>department_id<span style=color:#f92672>`</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> d.<span style=color:#f92672>`</span>department_id<span style=color:#f92672>`</span> <span style=color:#66d9ef>IS</span> <span style=color:#66d9ef>NULL</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>UNION</span> <span style=color:#66d9ef>ALL</span>  <span style=color:#75715e>#没有去重操作，效率高
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> employee_id,last_name,department_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> employees e <span style=color:#66d9ef>RIGHT</span> <span style=color:#66d9ef>JOIN</span> departments d
</span></span><span style=display:flex><span><span style=color:#66d9ef>ON</span> e.<span style=color:#f92672>`</span>department_id<span style=color:#f92672>`</span> <span style=color:#f92672>=</span> d.<span style=color:#f92672>`</span>department_id<span style=color:#f92672>`</span>;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e>#右下图
</span></span></span><span style=display:flex><span><span style=color:#75715e>#左中图 + 右中图  A ∪B- A∩B 或者 (A -  A∩B) ∪ （B - A∩B）
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> employee_id,last_name,department_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> employees e <span style=color:#66d9ef>LEFT</span> <span style=color:#66d9ef>JOIN</span> departments d
</span></span><span style=display:flex><span><span style=color:#66d9ef>ON</span> e.<span style=color:#f92672>`</span>department_id<span style=color:#f92672>`</span> <span style=color:#f92672>=</span> d.<span style=color:#f92672>`</span>department_id<span style=color:#f92672>`</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> d.<span style=color:#f92672>`</span>department_id<span style=color:#f92672>`</span> <span style=color:#66d9ef>IS</span> <span style=color:#66d9ef>NULL</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>UNION</span> <span style=color:#66d9ef>ALL</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> employee_id,last_name,department_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> employees e <span style=color:#66d9ef>RIGHT</span> <span style=color:#66d9ef>JOIN</span> departments d
</span></span><span style=display:flex><span><span style=color:#66d9ef>ON</span> e.<span style=color:#f92672>`</span>department_id<span style=color:#f92672>`</span> <span style=color:#f92672>=</span> d.<span style=color:#f92672>`</span>department_id<span style=color:#f92672>`</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> e.<span style=color:#f92672>`</span>department_id<span style=color:#f92672>`</span> <span style=color:#66d9ef>IS</span> <span style=color:#66d9ef>NULL</span>
</span></span></code></pre></div><h3 id=572-语法格式小结>5.7.2 语法格式小结<a hidden class=anchor aria-hidden=true href=#572-语法格式小结>#</a></h3><ul><li>左中图</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e>#实现A -  A∩B
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>select</span> <span style=color:#960050;background-color:#1e0010>字段列表</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>from</span> A表 <span style=color:#66d9ef>left</span> <span style=color:#66d9ef>join</span> B表
</span></span><span style=display:flex><span><span style=color:#66d9ef>on</span> <span style=color:#960050;background-color:#1e0010>关联条件</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>where</span> <span style=color:#960050;background-color:#1e0010>从表关联字段</span> <span style=color:#66d9ef>is</span> <span style=color:#66d9ef>null</span> <span style=color:#66d9ef>and</span> <span style=color:#960050;background-color:#1e0010>等其他子句</span>;
</span></span></code></pre></div><ul><li>右中图</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e>#实现B -  A∩B
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>select</span> <span style=color:#960050;background-color:#1e0010>字段列表</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>from</span> A表 <span style=color:#66d9ef>right</span> <span style=color:#66d9ef>join</span> B表
</span></span><span style=display:flex><span><span style=color:#66d9ef>on</span> <span style=color:#960050;background-color:#1e0010>关联条件</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>where</span> <span style=color:#960050;background-color:#1e0010>从表关联字段</span> <span style=color:#66d9ef>is</span> <span style=color:#66d9ef>null</span> <span style=color:#66d9ef>and</span> <span style=color:#960050;background-color:#1e0010>等其他子句</span>;
</span></span></code></pre></div><ul><li>左下图</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e>#实现查询结果是A∪B
</span></span></span><span style=display:flex><span><span style=color:#75715e>#用左外的A，union 右外的B
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>select</span> <span style=color:#960050;background-color:#1e0010>字段列表</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>from</span> A表 <span style=color:#66d9ef>left</span> <span style=color:#66d9ef>join</span> B表
</span></span><span style=display:flex><span><span style=color:#66d9ef>on</span> <span style=color:#960050;background-color:#1e0010>关联条件</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>where</span> <span style=color:#960050;background-color:#1e0010>等其他子句</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>union</span> 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>select</span> <span style=color:#960050;background-color:#1e0010>字段列表</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>from</span> A表 <span style=color:#66d9ef>right</span> <span style=color:#66d9ef>join</span> B表
</span></span><span style=display:flex><span><span style=color:#66d9ef>on</span> <span style=color:#960050;background-color:#1e0010>关联条件</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>where</span> <span style=color:#960050;background-color:#1e0010>等其他子句</span>;
</span></span></code></pre></div><ul><li>右下图</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e>#实现A∪B -  A∩B  或   (A -  A∩B) ∪ （B - A∩B）
</span></span></span><span style=display:flex><span><span style=color:#75715e>#使用左外的 (A -  A∩B)  union 右外的（B - A∩B）
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>select</span> <span style=color:#960050;background-color:#1e0010>字段列表</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>from</span> A表 <span style=color:#66d9ef>left</span> <span style=color:#66d9ef>join</span> B表
</span></span><span style=display:flex><span><span style=color:#66d9ef>on</span> <span style=color:#960050;background-color:#1e0010>关联条件</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>where</span> <span style=color:#960050;background-color:#1e0010>从表关联字段</span> <span style=color:#66d9ef>is</span> <span style=color:#66d9ef>null</span> <span style=color:#66d9ef>and</span> <span style=color:#960050;background-color:#1e0010>等其他子句</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>union</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>select</span> <span style=color:#960050;background-color:#1e0010>字段列表</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>from</span> A表 <span style=color:#66d9ef>right</span> <span style=color:#66d9ef>join</span> B表
</span></span><span style=display:flex><span><span style=color:#66d9ef>on</span> <span style=color:#960050;background-color:#1e0010>关联条件</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>where</span> <span style=color:#960050;background-color:#1e0010>从表关联字段</span> <span style=color:#66d9ef>is</span> <span style=color:#66d9ef>null</span> <span style=color:#66d9ef>and</span> <span style=color:#960050;background-color:#1e0010>等其他子句</span>
</span></span></code></pre></div><h2 id=6-sql99语法新特性>6. SQL99语法新特性<a hidden class=anchor aria-hidden=true href=#6-sql99语法新特性>#</a></h2><h3 id=61-自然连接>6.1 自然连接<a hidden class=anchor aria-hidden=true href=#61-自然连接>#</a></h3><p>SQL99 在 SQL92 的基础上提供了一些特殊语法，比如 <code>NATURAL JOIN</code> 用来表示自然连接。我们可以把自然连接理解为 SQL92 中的等值连接。它会帮你自动查询两张连接表中<code>所有相同的字段</code>，然后进行<code>等值连接</code>。</p><p>在SQL92标准中：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> employee_id,last_name,department_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> employees e <span style=color:#66d9ef>JOIN</span> departments d
</span></span><span style=display:flex><span><span style=color:#66d9ef>ON</span> e.<span style=color:#f92672>`</span>department_id<span style=color:#f92672>`</span> <span style=color:#f92672>=</span> d.<span style=color:#f92672>`</span>department_id<span style=color:#f92672>`</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>AND</span> e.<span style=color:#f92672>`</span>manager_id<span style=color:#f92672>`</span> <span style=color:#f92672>=</span> d.<span style=color:#f92672>`</span>manager_id<span style=color:#f92672>`</span>;
</span></span></code></pre></div><p>在 SQL99 中你可以写成：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> employee_id,last_name,department_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> employees e <span style=color:#66d9ef>NATURAL</span> <span style=color:#66d9ef>JOIN</span> departments d;
</span></span></code></pre></div><h3 id=62-using连接>6.2 USING连接<a hidden class=anchor aria-hidden=true href=#62-using连接>#</a></h3><p>当我们进行连接的时候，SQL99还支持使用 USING 指定数据表里的<code>同名字段</code>进行等值连接。但是只能配合JOIN一起使用。比如：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> employee_id,last_name,department_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> employees e <span style=color:#66d9ef>JOIN</span> departments d
</span></span><span style=display:flex><span><span style=color:#66d9ef>USING</span> (department_id);
</span></span></code></pre></div><p>你能看出与自然连接 NATURAL JOIN 不同的是，USING 指定了具体的相同的字段名称，你需要在 USING 的括号 () 中填入要指定的同名字段。同时使用 <code>JOIN...USING</code> 可以简化 JOIN ON 的等值连接。它与下面的 SQL 查询结果是相同的：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> employee_id,last_name,department_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> employees e ,departments d
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> e.department_id <span style=color:#f92672>=</span> d.department_id;
</span></span></code></pre></div><h2 id=7-章节小结>7. 章节小结<a hidden class=anchor aria-hidden=true href=#7-章节小结>#</a></h2><p>表连接的约束条件可以有三种方式：WHERE, ON, USING</p><ul><li><p>WHERE：适用于所有关联查询</p></li><li><p><code>ON</code>：只能和JOIN一起使用，只能写关联条件。虽然关联条件可以并到WHERE中和其他条件一起写，但分开写可读性更好。</p></li><li><p>USING：只能和JOIN一起使用，而且要求<strong>两个</strong>关联字段在关联表中名称一致，而且只能表示关联字段值相等</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#75715e>#关联条件
</span></span></span><span style=display:flex><span><span style=color:#75715e>#把关联条件写在where后面
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> last_name,department_name 
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> employees,departments 
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> employees.department_id <span style=color:#f92672>=</span> departments.department_id;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#把关联条件写在on后面，只能和JOIN一起使用
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> last_name,department_name 
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> employees <span style=color:#66d9ef>INNER</span> <span style=color:#66d9ef>JOIN</span> departments 
</span></span><span style=display:flex><span><span style=color:#66d9ef>ON</span> employees.department_id <span style=color:#f92672>=</span> departments.department_id;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> last_name,department_name 
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> employees <span style=color:#66d9ef>CROSS</span> <span style=color:#66d9ef>JOIN</span> departments 
</span></span><span style=display:flex><span><span style=color:#66d9ef>ON</span> employees.department_id <span style=color:#f92672>=</span> departments.department_id;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> last_name,department_name  
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> employees <span style=color:#66d9ef>JOIN</span> departments 
</span></span><span style=display:flex><span><span style=color:#66d9ef>ON</span> employees.department_id <span style=color:#f92672>=</span> departments.department_id;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#把关联字段写在using()中，只能和JOIN一起使用
</span></span></span><span style=display:flex><span><span style=color:#75715e>#而且两个表中的关联字段必须名称相同，而且只能表示=
</span></span></span><span style=display:flex><span><span style=color:#75715e>#查询员工姓名与基本工资
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> last_name,job_title
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> employees <span style=color:#66d9ef>INNER</span> <span style=color:#66d9ef>JOIN</span> jobs <span style=color:#66d9ef>USING</span>(job_id);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#n张表关联，需要n-1个关联条件
</span></span></span><span style=display:flex><span><span style=color:#75715e>#查询员工姓名，基本工资，部门名称
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> last_name,job_title,department_name <span style=color:#66d9ef>FROM</span> employees,departments,jobs 
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> employees.department_id <span style=color:#f92672>=</span> departments.department_id 
</span></span><span style=display:flex><span><span style=color:#66d9ef>AND</span> employees.job_id <span style=color:#f92672>=</span> jobs.job_id;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> last_name,job_title,department_name 
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> employees <span style=color:#66d9ef>INNER</span> <span style=color:#66d9ef>JOIN</span> departments <span style=color:#66d9ef>INNER</span> <span style=color:#66d9ef>JOIN</span> jobs 
</span></span><span style=display:flex><span><span style=color:#66d9ef>ON</span> employees.department_id <span style=color:#f92672>=</span> departments.department_id 
</span></span><span style=display:flex><span><span style=color:#66d9ef>AND</span> employees.job_id <span style=color:#f92672>=</span> jobs.job_id;
</span></span></code></pre></div><p><strong>注意：</strong></p><p>我们要<code>控制连接表的数量</code>。多表连接就相当于嵌套 for 循环一样，非常消耗资源，会让 SQL 查询性能下降得很严重，因此不要连接不必要的表。在许多 DBMS 中，也都会有最大连接表的限制。</p><blockquote><p>【强制】超过三个表禁止 join。需要 join 的字段，数据类型保持绝对一致；多表关联查询时， 保证被关联的字段需要有索引。</p><p>说明：即使双表 join 也要注意表索引、SQL 性能。</p><p>来源：阿里巴巴《Java开发手册》</p></blockquote><h2 id=附录常用的-sql-标准有哪些>附录：常用的 SQL 标准有哪些<a hidden class=anchor aria-hidden=true href=#附录常用的-sql-标准有哪些>#</a></h2><p>在正式开始讲连接表的种类时，我们首先需要知道 SQL 存在不同版本的标准规范，因为不同规范下的表连接操作是有区别的。</p><p>SQL 有两个主要的标准，分别是 <code>SQL92</code> 和 <code>SQL99</code>。92 和 99 代表了标准提出的时间，SQL92 就是 92 年提出的标准规范。当然除了 SQL92 和 SQL99 以外，还存在 SQL-86、SQL-89、SQL:2003、SQL:2008、SQL:2011 和 SQL:2016 等其他的标准。</p><p>这么多标准，到底该学习哪个呢？<strong>实际上最重要的 SQL 标准就是 SQL92 和 SQL99</strong>。一般来说 SQL92 的形式更简单，但是写的 SQL 语句会比较长，可读性较差。而 SQL99 相比于 SQL92 来说，语法更加复杂，但可读性更强。我们从这两个标准发布的页数也能看出，SQL92 的标准有 500 页，而 SQL99 标准超过了 1000 页。实际上从 SQL99 之后，很少有人能掌握所有内容，因为确实太多了。就好比我们使用 Windows、Linux 和 Office 的时候，很少有人能掌握全部内容一样。我们只需要掌握一些核心的功能，满足日常工作的需求即可。</p><p>**SQL92 和 SQL99 是经典的 SQL 标准，也分别叫做 SQL-2 和 SQL-3 标准。**也正是在这两个标准发布之后，SQL 影响力越来越大，甚至超越了数据库领域。现如今 SQL 已经不仅仅是数据库领域的主流语言，还是信息领域中信息处理的主流语言。在图形检索、图像检索以及语音检索中都能看到 SQL 语言的使用。</p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://jiayi26.github.io/posts/%E7%AC%AC05%E7%AB%A0_%E6%8E%92%E5%BA%8F%E4%B8%8E%E5%88%86%E9%A1%B5/><span class=title>« Prev Page</span><br><span></span></a>
<a class=next href=https://jiayi26.github.io/posts/%E7%AC%AC07%E7%AB%A0_%E5%8D%95%E8%A1%8C%E5%87%BD%E6%95%B0/><span class=title>Next Page »</span><br><span></span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share  on twitter" href="https://twitter.com/intent/tweet/?text=&url=https%3a%2f%2fjiayi26.github.io%2fposts%2f%25E7%25AC%25AC06%25E7%25AB%25A0_%25E5%25A4%259A%25E8%25A1%25A8%25E6%259F%25A5%25E8%25AF%25A2%2f&hashtags="><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share  on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fjiayi26.github.io%2fposts%2f%25E7%25AC%25AC06%25E7%25AB%25A0_%25E5%25A4%259A%25E8%25A1%25A8%25E6%259F%25A5%25E8%25AF%25A2%2f&title=&summary=&source=https%3a%2f%2fjiayi26.github.io%2fposts%2f%25E7%25AC%25AC06%25E7%25AB%25A0_%25E5%25A4%259A%25E8%25A1%25A8%25E6%259F%25A5%25E8%25AF%25A2%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share  on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fjiayi26.github.io%2fposts%2f%25E7%25AC%25AC06%25E7%25AB%25A0_%25E5%25A4%259A%25E8%25A1%25A8%25E6%259F%25A5%25E8%25AF%25A2%2f&title="><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share  on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fjiayi26.github.io%2fposts%2f%25E7%25AC%25AC06%25E7%25AB%25A0_%25E5%25A4%259A%25E8%25A1%25A8%25E6%259F%25A5%25E8%25AF%25A2%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share  on whatsapp" href="https://api.whatsapp.com/send?text=%20-%20https%3a%2f%2fjiayi26.github.io%2fposts%2f%25E7%25AC%25AC06%25E7%25AB%25A0_%25E5%25A4%259A%25E8%25A1%25A8%25E6%259F%25A5%25E8%25AF%25A2%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share  on telegram" href="https://telegram.me/share/url?text=&url=https%3a%2f%2fjiayi26.github.io%2fposts%2f%25E7%25AC%25AC06%25E7%25AB%25A0_%25E5%25A4%259A%25E8%25A1%25A8%25E6%259F%25A5%25E8%25AF%25A2%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://jiayi26.github.io/>JIAYI's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>